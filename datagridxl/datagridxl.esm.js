/**
 * DataGridXL
 * v1.20.07.10
 * (c) Vanilla Components
 * https://datagridxl.com/buy
 */

class e{constructor(e){this.events={},this._anyEvent="any",this._context=e}on(e,t){return"function"==typeof t&&("string"==typeof e&&(void 0===this.events[e]&&(this.events[e]={listeners:[]}),!(this.events[e].listeners.indexOf(t)>-1)&&void this.events[e].listeners.push(t)))}off(e,t){if(void 0===this.events[e])return!1;this.events[e].listeners=this.events[e].listeners.filter(e=>e!==t)}dispatch(e,t={},o=e){if(e!=this._anyEvent&&this.dispatch(this._anyEvent,t,e),void 0===this.events[e])return!0;var i=[];this.events[e].listeners.forEach(e=>{i.push(e.call(this._context,t,o))});for(var s=0;s<i.length;s++)if(!1===i[s])return!1;return!0}}function t(){return navigator.platform.indexOf("Mac")>-1}class o{constructor(e){this._actionKeys={backspace:8,tab:9,enter:13,break:19,pause:19,esc:27,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,ins:45,insert:45,del:46,delete:46,plus:61},this._alphanumericKeys=i(),this._modifierKeys={shift:"shiftKey",ctrl:t()?"metaKey":"ctrlKey",alt:"altKey"},this._nonInputKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,44,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,182,183],this._modifierKeyCodes=[16,17,18,91,93],this._metaKeyCodes=[91,93],this._context=e,this.trackedActionKeys=[],this.trackedAlphanumericKeys=[],this.trackedModifierKeys=[],this.pressedActionKeys={},this.pressedAlphanumericKeys={},this.pressedModifierKeys={},this.identifyKeyActionTimeout=null,this._keyRanges={"range:input":function(e){return-1==this._nonInputKeyCodes.indexOf(e.which||e.keyCode)&&!e.ctrlKey&&!e.altKey&&!e.metaKey},"range:ctrl":function(e){return e.ctrlKey||e.metaKey||17==(e.which||e.keyCode)}},this.keysToPrevent={},this.trackedKeyRanges=[],this.prevKeyAction=null,this.keyActions=[],this.keys={},this.keyHoldDelay=350,this.keyHoldInterval=60,this._isSuspended=!1,this._keyDownListener=s.bind(this),this._keyUpListener=l.bind(this),this._identifyKeyAction=r.bind(this),document.addEventListener("keydown",this._keyDownListener),document.addEventListener("keyup",this._keyUpListener)}on(e,t,o=!0){var i=!1,s=!1,l="";if(e.trim()in this._keyRanges)i=!0,s=!0,l=e.trim();else{for(var n=[],r=[],c=[],d=(e=e.split("+"),[]),a=0;a<e.length;a++){var u=e[a].trim();u in this._modifierKeys?n.push(u):u in this._actionKeys?r.push(u):u in this._alphanumericKeys&&c.push(u),d.push(u)}h({modifierKeys:n,actionKeys:r,alphanumericKeys:c})&&(i=!0,s=!1,l=d.join("+"))}if(i){if(void 0===this.keys[l]&&(this.keys[l]={actions:[]},!s)){this.keyActions.push({actionKeys:r,alphanumericKeys:c,modifierKeys:n,keyString:l});for(a=0;a<r.length;a++)this._actionKeys[r[a]]in this.keysToPrevent||(this.keysToPrevent[this._actionKeys[r[a]]]=[]),this.keysToPrevent[this._actionKeys[r[a]]].push(l)}for(a=0;a<this.keys[l].actions.length;a++)if(this.keys[l].actions[a].callback==t&&this.keys[l].actions[a].repeatable==o)return;if(this.keys[l].actions.push({callback:t,repeatable:o}),!s){var _=null;for(a=0;a<d.length;a++)d[a]in this._modifierKeys?-1==this.trackedModifierKeys.indexOf(this._modifierKeys[d[a]])&&this.trackedModifierKeys.push(this._modifierKeys[d[a]]):d[a]in this._actionKeys?(_=this._actionKeys[d[a]],-1==this.trackedActionKeys.indexOf(_)&&this.trackedActionKeys.push(_)):d[a]in this._alphanumericKeys&&(_=this._alphanumericKeys[d[a]],-1==this.trackedAlphanumericKeys.indexOf(_)&&this.trackedAlphanumericKeys.push(_))}}}off(e,t){for(var o=[],i=[],s=[],l=(e=e.split("+"),[]),n=0;n<e.length;n++){var r=e[n].trim();r in this._modifierKeys?s.push(r):r in this._actionKeys?o.push(r):r in this._alphanumericKeys&&i.push(r),l.push(r)}if(h({modifierKeys:s,actionKeys:o,alphanumericKeys:i})){var c=l.join("+");if(void 0!==this.keys[c]&&(this.keys[c].actions=this.keys[c].actions.filter(e=>e.callback!==t),!this.keys[c].actions.length)){delete this.keys[c];for(n=0;n<this.keyActions.length;n++)if(this.keyActions[n].keyString==c){for(var d=0;d<this.keyActions[n].actionKeys.length;d++)if(this._actionKeys[this.keyActions[n].actionKeys[d]]in this.keysToPrevent){var a=this.keysToPrevent[this._actionKeys[this.keyActions[n].actionKeys[d]]].indexOf(c);a>-1&&this.keysToPrevent[this._actionKeys[this.keyActions[n].actionKeys[d]]].splice(a,1),this.keysToPrevent[this._actionKeys[this.keyActions[n].actionKeys[d]]].length||delete this.keysToPrevent[this._actionKeys[this.keyActions[n].actionKeys[d]]]}this.keyActions.splice(n,1);break}}}}suspend(){document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener)}resume(){document.addEventListener("keydown",this._keyDownListener),document.addEventListener("keyup",this._keyUpListener)}}const i=function(){for(var e={},t=[{startIndex:65,series:"abcdefghijklmnopqrstuvwxyz"},{startIndex:48,series:"0123456789"}],o=0;o<t.length;o++)for(var i=0;i<t[o].series.length;i++)e[t[o].series[i]]=t[o].startIndex+i;return e},s=function(e){var t=e.which||e.keyCode;if("input"!=e.target.tagName.toLowerCase()&&(t in this.keysToPrevent&&e.preventDefault(),!(this._modifierKeyCodes.indexOf(t)>-1&&null===this.identifyKeyActionTimeout))){for(var o in this._keyRanges)o in this.keys&&this._keyRanges[o].call(this,e)&&this.keys[o].actions.forEach(e=>{e.callback.call(this._context)});for(var i=0;i<this.trackedModifierKeys.length;i++){var s=this.trackedModifierKeys[i];s in e&&1==e[s]?this.pressedModifierKeys[s]=!0:s in this.pressedModifierKeys&&delete this.pressedModifierKeys[s]}this.trackedActionKeys.indexOf(t)>-1&&!this.pressedActionKeys[t]&&(this.pressedActionKeys[t]=!0),this.trackedAlphanumericKeys.indexOf(t)>-1&&!this.pressedAlphanumericKeys[t]&&(this.pressedAlphanumericKeys[t]=!0),null===this.identifyKeyActionTimeout&&r.call(this,e)}},l=function(e){var t=e.which||e.keyCode;this.pressedActionKeys[t]&&delete this.pressedActionKeys[t],this.pressedAlphanumericKeys[t]&&delete this.pressedAlphanumericKeys[t],this._metaKeyCodes.indexOf(t)>-1&&(this.pressedAlphanumericKeys={},this.pressedActionKeys={}),0==Object.keys(this.pressedActionKeys).length&&0==Object.keys(this.pressedAlphanumericKeys).length&&n.call(this)},n=function(){clearTimeout(this.identifyKeyActionTimeout),this.identifyKeyActionTimeout=null,this.pressedActionKeys={},this.pressedAlphanumericKeys={},this.pressedModifierKeys={},this.prevKeyAction=null},r=function(e=null){if(document.hasFocus()){for(var o=[],i=0;i<this.keyActions.length;i++){for(var s=0,l=0;l<this.keyActions[i].modifierKeys.length;l++)this.pressedModifierKeys[this._modifierKeys[this.keyActions[i].modifierKeys[l]]]&&s++;for(l=0;l<this.keyActions[i].actionKeys.length;l++)this.pressedActionKeys[this._actionKeys[this.keyActions[i].actionKeys[l]]]&&s++;for(l=0;l<this.keyActions[i].alphanumericKeys.length;l++)this.pressedAlphanumericKeys[this._alphanumericKeys[this.keyActions[i].alphanumericKeys[l]]]&&s++;s>0&&s==this.keyActions[i].actionKeys.length+this.keyActions[i].alphanumericKeys.length+this.keyActions[i].modifierKeys.length&&o.push(this.keyActions[i])}if(o.length>1&&o.sort((function(e,t){return t.actionKeys.length+t.modifierKeys.length-(e.actionKeys.length+e.modifierKeys.length)})),o.length?(o[0]==this.prevKeyAction?this.keyActionRepeatCounter++:this.keyActionRepeatCounter=0,this.keys[o[0].keyString].actions.forEach(e=>{1!=e.repeatable&&0!=this.keyActionRepeatCounter||e.callback.call(this._context)}),t()&&o[0].modifierKeys.indexOf("ctrl")>-1&&(this.pressedAlphanumericKeys={},this.pressedActionKeys={}),this.prevKeyAction=o[0]):(this.keyActionRepeatCounter=0,this.prevKeyAction=null),0==this.keyActionRepeatCounter)var n=this.keyHoldDelay;else n=this.keyHoldInterval;this.identifyKeyActionTimeout=setTimeout(this._identifyKeyAction,n)}},h=function(e){var t=!0;return"keyRange"in e||(e.modifierKeys.length&&!e.actionKeys.length&&!e.alphanumericKeys.length||!e.modifierKeys.length&&!e.actionKeys.length&&e.alphanumericKeys.length||e.actionKeys.length&&e.alphanumericKeys.length)&&(t=!1),t};class c{constructor(e){this.commands=[],this.index=-1,this.limit=0,this.isExecuting=!1,this.callback,this._context=e}add(e){return this.isExecuting?this:(this.commands.splice(this.index+1,this.commands.length-this.index),this.commands.push(e),this.limit&&this.commands.length>this.limit&&a(this.commands,0,-(this.limit+1)),this.index=this.commands.length-1,this.callback&&this.callback(),this)}setCallback(e){this.callback=e}undo(){var e=this.commands[this.index];return e&&this._context.events.dispatch("beforeundo",{command:e})?(d.call(this,e,"undo"),this.index-=1,this._context.events.dispatch("undo",{command:e}),this.callback&&this.callback(),this):this}redo(){var e=this.commands[this.index+1];return e&&this._context.events.dispatch("beforeredo",{command:e})?(d.call(this,e,"redo"),this.index+=1,this._context.events.dispatch("redo",{command:e}),this.callback&&this.callback(),this):this}clear(){var e=this.commands.length;this.commands=[],this.index=-1,this.callback&&e>0&&this.callback()}hasUndo(){return-1!==this.index}hasRedo(){return this.index<this.commands.length-1}getCommands(){return this.commands}getIndex(){return this.index}setLimit(e){this.limit=e}}const d=function(e,t){return e&&"function"==typeof e[t]?(this.isExecuting=!0,e[t].call(this._context),this.isExecuting=!1,this):this},a=function(e,t,o){return e.splice(t,!o||1+o-t+(!(o<0^t>=0)&&(o<0||-1)*e.length)),e.length};function u(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}return!1}var _={copy:{label:"Copy",method:function(){this.copy()},shortcut:"Ctrl+C",shortcutMac:"⌘C",include:function(){return this.allowCopy}},cut:{label:"Cut",method:function(){this.cut()},shortcut:"Ctrl+X",shortcutMac:"⌘X",include:function(){return this.allowCut}},paste:{label:"Paste",method:function(){this.paste()},shortcut:"Ctrl+V",shortcutMac:"⌘V",include:function(){return this.allowPaste}},delete_rows:{label:"Delete Row(s)",method:function(){this.deleteRows(this.getRowSelection())},disabled:function(){return null==this.getRowSelection()},include:function(){return this.allowRowDelete}},insert_rows_up:{label:"Insert Row(s) (up)",method:function(){this.insertRows(1,this.getNormalizedRowSelection()[0])},disabled:function(){return null==this.getRowSelection()},include:function(){return this.allowRowInsert}},insert_rows_down:{label:"Insert Row(s) (down)",method:function(){this.insertRows(1,this.getNormalizedRowSelection()[1]+1)},disabled:function(){return null==this.getRowSelection()},include:function(){return this.allowRowInsert}},delete_cols:{label:"Delete Column(s)",method:function(){this.deleteCols(this.getColSelection())},disabled:function(){return null==this.getColSelection()},include:function(){return this.allowColDelete}},insert_cols_up:{label:"Insert Column(s) (left)",method:function(){this.insertCols(1,this.getNormalizedColSelection()[0])},disabled:function(){return null==this.getColSelection()},include:function(){return this.allowColInsert}},insert_cols_down:{label:"Insert Column(s) (right)",method:function(){this.insertCols(1,this.getNormalizedColSelection()[1]+1)},disabled:function(){return null==this.getColSelection()},include:function(){return this.allowColInsert}}},p={copy:{label:"Copy",method:function(){this.copy()}},cut:{label:"Cut",method:function(){this.cut()}},deselect:{label:"Deselect",method:function(){this.deselectAll()},include:function(){return!this.constructor.areCoordsEqual(this.getCellSelection()[0],this.getCellSelection()[1])}}},m=["copy","cut","paste","delete_rows","insert_rows_up","insert_rows_down","delete_cols","insert_cols_up","insert_cols_down"],g=["copy","deselect"],f={tab_navigateNext:{keys:"tab",action:function(){this.moveCellCursorInside({x:1,y:0})},repeat:!0},shiftTab_navigatePrev:{keys:"shift+tab",action:function(){this.moveCellCursorInside({x:-1,y:0})},repeat:!0},enter_navigateNext:{keys:"enter",action:function(){this.moveCellCursorInside({x:0,y:1})},repeat:!0},shiftEnter_navigatePrev:{keys:"shift+enter",action:function(){this.moveCellCursorInside({x:0,y:-1})},repeat:!0},ctrlEnter_saveEditor:{keys:"ctrl+enter",action:function(){this.closeEditorAndSave()},repeat:!1,active:function(){return this.allowCellEdit}},enter_openEditor:{keys:"enter",action:function(){this.openEditor("opened")},repeat:!1,active:function(){return this.allowCellEdit}},pageDown_moveCellCursorOneViewportDown:{keys:"pagedown",action:function(){this.moveCellCursorOneViewportDown()},repeat:!0},pageUp_moveCellCursorOneViewportUp:{keys:"pageup",action:function(){this.moveCellCursorOneViewportUp()},repeat:!0},home_moveCellCursorToRowStart:{keys:"home",action:function(){this.moveCellCursorToRowStart()},repeat:!1},end_moveCellCursorToRowEnd:{keys:"end",action:function(){this.moveCellCursorToRowEnd()},repeat:!1},ctrlLeftArrow_moveCellCursorToRowStart:{keys:"ctrl+left",action:function(){this.moveCellCursorToRowStart()},repeat:!1},ctrlRightArrow_moveCellCursorToRowEnd:{keys:"ctrl+right",action:function(){this.moveCellCursorToRowEnd()},repeat:!1},ctrlUpArrow_moveCellCursorToColStart:{keys:"ctrl+up",action:function(){this.moveCellCursorToColStart()},repeat:!1},ctrlDownArrow_moveCellCursorToColEnd:{keys:"ctrl+down",action:function(){this.moveCellCursorToColEnd()},repeat:!1},ctrlHome_moveCellCursorToDocumentStart:{keys:"ctrl+home",action:function(){this.moveCellCursorToDocumentStart()},repeat:!1},ctrlEnd_moveCellCursorToDocumentEnd:{keys:"ctrl+end",action:function(){this.moveCellCursorToDocumentEnd()},repeat:!1},rightArrow_moveCellCursorRight:{keys:"right",action:function(){this.moveCellCursor({x:1,y:0})},repeat:!0},downArrow_moveCellCursorDown:{keys:"down",action:function(){this.moveCellCursor({x:0,y:1})},repeat:!0},leftArrow_moveCellCursorLeft:{keys:"left",action:function(){this.moveCellCursor({x:-1,y:0})},repeat:!0},upArrow_moveCellCursorUp:{keys:"up",action:function(){this.moveCellCursor({x:0,y:-1})},repeat:!0},shiftRightArrow_modifySelectionRightwards:{keys:"shift+right",action:function(){this.modifySelection("right")},repeat:!0},shiftDownArrow_modifySelectionDownwards:{keys:"shift+down",action:function(){this.modifySelection("down")},repeat:!0},shiftLeftArrow_modifySelectionLeftwards:{keys:"shift+left",action:function(){this.modifySelection("left")},repeat:!0},shiftUpArrow_modifySelectionUpwards:{keys:"shift+up",action:function(){this.modifySelection("up")},repeat:!0},ctrlZ_undo:{keys:"ctrl+z",action:function(){this.undo()},repeat:!1},ctrlY_redo:{keys:"ctrl+y",action:function(){this.redo()},repeat:!1},ctrlShiftZ_redo:{keys:"ctrl+shift+z",action:function(){this.redo()},repeat:!1},backspace_clearCellValues:{keys:"backspace",action:function(){this.clearCellValues(this.getCellSelection())},repeat:!1,active:function(){return this.allowCellEdit}},delete_clearCellValues:{keys:"delete",action:function(){this.clearCellValues(this.getCellSelection())},repeat:!1,active:function(){return this.allowCellEdit}},inputRange_openInlineEditor:{keys:"range:input",action:function(){this.openEditor("inline")},repeat:!1,active:function(){return this.allowCellEdit}},ctrlRange_enableClipboardNode:{keys:"range:ctrl",action:function(){this.enableClipboardInteraction()},repeat:!1},esc_closeEditor:{keys:"esc",action:function(){this.closeEditor()},repeat:!1},esc_closeContextMenu:{keys:"esc",action:function(){this.constructor.contextMenu.close()},repeat:!1},downArrow_moveContextMenuCursorDown:{keys:"down",action:function(){this.constructor.contextMenu.moveCursorDown()},repeat:!0},upArrow_moveContextMenuCursorUp:{keys:"up",action:function(){this.constructor.contextMenu.moveCursorUp()},repeat:!0},enter_hitContextMenuItem:{keys:"enter",action:function(){this.constructor.contextMenu.triggerHit()},repeat:!1}},v={traverseSingleCell:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_openEditor","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToDocumentStart","ctrlEnd_moveCellCursorToDocumentEnd","shiftRightArrow_modifySelectionRightwards","shiftDownArrow_modifySelectionDownwards","shiftLeftArrow_modifySelectionLeftwards","shiftUpArrow_modifySelectionUpwards","inputRange_openInlineEditor","backspace_clearCellValues","delete_clearCellValues","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlRange_enableClipboardNode"],traverseMultiCell:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToDocumentStart","ctrlEnd_moveCellCursorToDocumentEnd","shiftRightArrow_modifySelectionRightwards","shiftDownArrow_modifySelectionDownwards","shiftLeftArrow_modifySelectionLeftwards","shiftUpArrow_modifySelectionUpwards","inputRange_openInlineEditor","backspace_clearCellValues","delete_clearCellValues","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlRange_enableClipboardNode"],editInline:["rightArrow_moveCellCursorRight","downArrow_moveCellCursorDown","leftArrow_moveCellCursorLeft","upArrow_moveCellCursorUp","tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","ctrlEnter_saveEditor","pageDown_moveCellCursorOneViewportDown","pageUp_moveCellCursorOneViewportUp","home_moveCellCursorToRowStart","end_moveCellCursorToRowEnd","ctrlLeftArrow_moveCellCursorToRowStart","ctrlRightArrow_moveCellCursorToRowEnd","ctrlUpArrow_moveCellCursorToColStart","ctrlDownArrow_moveCellCursorToColEnd","ctrlHome_moveCellCursorToDocumentStart","ctrlEnd_moveCellCursorToDocumentEnd","esc_closeEditor"],editOpened:["tab_navigateNext","shiftTab_navigatePrev","enter_navigateNext","shiftEnter_navigatePrev","ctrlEnter_saveEditor","esc_closeEditor"],contextMenuOpen:["esc_closeContextMenu","downArrow_moveContextMenuCursorDown","upArrow_moveContextMenuCursorUp","enter_hitContextMenuItem","ctrlZ_undo","ctrlY_redo","ctrlShiftZ_redo","ctrlRange_enableClipboardNode"]},x={numbers:{headerTextFunction:function(e,t){return String(1+e)}},letters:{range:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",headerTextFunction:function(e,t){return function(e){var o="";do{e-=1,o=t.range.charAt(e%t.range.length)+o,e=e/t.range.length>>0}while(e>0);return o}(1+e)}}},y=["numbers","letters"];function N(e,t,o,i,s){return i?i||"":this.colHeaderLabelType in s?(this.colHeaderLabelPrefix||"")+s[this.colHeaderLabelType]+(this.colHeaderLabelSuffix||""):"id"==this.colHeaderLabelType?(this.colHeaderLabelPrefix||"")+t+(this.colHeaderLabelSuffix||""):"index"==this.colHeaderLabelType?(this.colHeaderLabelPrefix||"")+e+(this.colHeaderLabelSuffix||""):(this.colHeaderLabelPrefix||"")+(this.colHeaderLabelSuffix||"")}function w(e,t,o,i,s){return i?i||"":this.rowHeaderLabelType in s?(this.rowHeaderLabelPrefix||"")+s[this.rowHeaderLabelType]+(this.rowHeaderLabelSuffix||""):"id"==this.rowHeaderLabelType?(this.rowHeaderLabelPrefix||"")+t+(this.rowHeaderLabelSuffix||""):"index"==this.rowHeaderLabelType?(this.rowHeaderLabelPrefix||"")+e+(this.rowHeaderLabelSuffix||""):(this.rowHeaderLabelPrefix||"")+(this.rowHeaderLabelSuffix||"")}var C={outerBorderColor:"#8d9295",textColor:"#000000",documentColor:"#ffffff",sheetColor:"#f4f4f4",colHeaderBackgroundColor:"#eaecee",colHeaderHighlightBackgroundColor:"#cad1d6",colHeaderSelectedBackgroundColor:"#8d9295",colHeaderTextColor:"#000000",colHeaderSelectedTextColor:"#ffffff",rowHeaderBackgroundColor:"#eaecee",rowHeaderHighlightBackgroundColor:"#cad1d6",rowHeaderSelectedBackgroundColor:"#8d9295",rowHeaderTextColor:"#000000",rowHeaderSelectedTextColor:"#ffffff",gridLineOpacity:.15,gridLineColor:"#555555",gridLineHeaderColor:"#000000",cellSelectionBackgroundColor:"#0078ff",cellSelectionBorderColor:"#0078ff",cellCursorColor:"#0078ff",fillHandleColor:"#0078ff",copyRangeBorderColor:"#0078ff",cutRangeBorderColor:"#0078ff",fillRangeBorderColor:"#555555",scrollbarBorderColor:"#dddddd",scrollbarBackgroundColor:"#ffffff",scrollbarThumbColor:"transparent",scrollbarThumbHighlightColor:"transparent",colResizeGuideLineColor:"#0078ff",colResizeGuideHandleColor:"#0078ff",colMoveGuideColor:"#000000",colMoveGhostColor:"#000000",colMoveGhostOpacity:.1,rowMoveGuideColor:"#000000",rowMoveGhostColor:"#000000",rowMoveGhostOpacity:.1,inlineEditorBorderColor:"#0078ff",openedEditorBorderColor:"#0078ff",rowZebraStripeColors:[null,"rgba(0,0,0,.05)"],contextMenuTextColor:"#000000",contextMenuBackgroundColor:"#ffffff",contextMenuItemHighlightBackgroundColor:"#eeeeee",contextMenuItemShortCutLabelTextColor:"#aaaaaa",colResizeHandleBackgroundColor:"#8d9295"},b={Copy:null,Cut:null,Paste:null,"Delete Row(s)":null,"Insert Row(s) (up)":null,"Insert Row(s) (down)":null,"Delete Column(s)":null,"Insert Column(s) (left)":null,"Insert Column(s) (right)":null,Deselect:null};const S=["laicrem.com","esnec.li","jo.it","rever.in","spl.se"],H={left:{},center:{"margin-left":"-100%","margin-right":"-100%","text-align":"center"},right:{float:"right","text-align":"right"}},T={cell:"default",colHeader:"default",rowHeader:"default",headerJoint:"default",horizontalScrollbar:"default",verticalScrollbar:"default",selectedRowHeader:"grab",selectedColHeader:"grab",fillHandle:"crosshair",colHeaderEdge:"ew-resize"},L={cellSelect:"default",colSelect:"default",rowSelect:"default",colMove:"grabbing",rowMove:"grabbing",cellFill:"crosshair",colResize:"ew-resize"};function P(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)}function k(e){var t="";for(var o=0;o<2;o++)t+=(i=e[o],s=o,l=void 0,n=void 0,r=void 0,l=e[4].substr(0,3)+e[2].substr(-2),n=e[3].substr(0,5)+e[4].substr(-2),r=e[2].substr(0,2)+e[3].substr(-2),(s?P:function(e){return e})(i[l](".")[1]+i[l](".")[0][l]("")[n]()[r]("")));var i,s,l,n,r;return t}function R(e){return Array.isArray(e)}function M(e){return R(e)&&R(e[0])}function A(e){return e instanceof Object&&e.constructor===Object}function I(e){return R(e)&&A(e[0])}function z(e){return null!==e&&""!==e&&!isNaN(e)}function E(e,t,o){null==this._cellStore[e-1]&&(this._cellStore[e-1]=[]),null==this._cellStore[e-1][t-1]?this._cellStore[e-1][t-1]={value:o}:this._cellStore[e-1][t-1].value=o}function V(e,t=null){this._dataFormat=M(e)?"arrayCollection":"objectCollection",this._rowStore=[];for(var o=0;o<e.length;o++){var i=1+o;this._rowStore.push({id:i,title:void 0}),this._rowList.push(i)}if(this._rowStore._lastId=i,this._colStore=[],null!=t&&I(t)){for(var s=0;s<t.length;s++){r=1+s;var l=void 0,n=void 0;I(e)&&("source"in t[s]?t[s].source in e[0]&&(l=t[s].source,n=t[s].source):(l=Object.keys(e[0])[s]||void 0,n=Object.keys(e[0])[s]||void 0)),this._colStore.push({id:r,node:void 0,field:t[s].field||l,title:t[s].title||n,width:t[s].width||this.defaultColWidth,align:t[s].align||this.defaultColAlign}),this._colList.push(r)}this._colStore._lastId=r}else if(M(e)){for(s=0;s<e[0].length;s++)r=1+s,this._colStore.push({id:r,node:void 0,field:void 0,title:void 0,width:this.defaultColWidth,align:this.defaultColAlign}),this._colList.push(r);this._colStore._lastId=r}else if(I(e)){var r,h=0;for(var c in e[0])r=1+h,this._colStore.push({id:r,node:void 0,field:c,title:c,width:this.defaultColWidth,align:this.defaultColAlign}),this._colList.push(r),h++;this._colStore._lastId=r}if(this._cellStore=[],null!=t&&I(t)){if(M(e))for(o=0;o<this._rowStore.length;o++)for(s=0;s<this._colStore.length;s++){if("source"in t[s]&&z(t[s].source))var d=Number(t[s].source);else d=s;E.call(this,this._rowStore[o].id,this._colStore[s].id,e[o][d]||null)}else if(I(e))for(o=0;o<this._rowStore.length;o++)for(s=0;s<this._colStore.length;s++){if("source"in t[s])var a=t[s].source;else a=Object.keys(e[0])[s];E.call(this,this._rowStore[o].id,this._colStore[s].id,e[o][a]||null)}}else if(M(e))for(o=0;o<this._rowStore.length;o++)for(s=0;s<this._colStore.length;s++)E.call(this,this._rowStore[o].id,this._colStore[s].id,e[o][s]);else if(I(e))for(o=0;o<this._rowStore.length;o++)for(s=0;s<this._colStore.length;s++)E.call(this,this._rowStore[o].id,this._colStore[s].id,e[o][this._colStore[s].field])}function O(e){for(var t in e)(t in this||t==k(S))&&(this[t]=e[t]);var o=e.data||this.constructor.createEmptyData(3,3),i=e.columns||null;V.call(this,o,i)}function D(e){O.call(this,e)}function F(e=null,t={},o=!1){var i=["user-select","user-drag","touch-callout"],s=["-ktml","-moz-","-ms-","-webkit-","-o-"];o&&(e.style.margin="0",e.style.padding="0",e.style.border="0",e.style["font-weight"]="normal",e.style["font-size"]="100%",e.style.font="inherit",e.style["vertical-align"]="baseline",e.style.display="block",e.style["list-style"]="none");for(let o in t){if(i.indexOf(o)>-1)for(var l=0;l<s.length;l++)s[l]+o in t||(e.style[s[l]+o]=t[o]);e.style[o]=t[o]}}function K(e,t={}){var o=document.createElement(e);for(let e in t)if("string"==typeof t[e]||z(t[e]))o.setAttribute(e,t[e]);else if("style"==e)F(o,t.style,!0);else if("styleText"==e){var i="";for(let e in t.styleText)if(R(t.styleText[e]))for(var s=0;s<t.styleText[e].length;s++)i+=e+":"+t.styleText[e][s]+";";else i+=e+":"+t.styleText[e]+";";o.style.cssText=i}return o}function B(){return document.createDocumentFragment()}function W(e=null,t=[]){for(var o=B(),i=0;i<t.length;i++)null!=t[i]&&o.appendChild(t[i]);return e.appendChild(o),e}function G(e){if(null==e)return null;var t={};for(var o in e)t[o]=e[o];return t}function X(e,t){var o=G(e);for(var i in t)o[i]=t[i];return o}function Y(e,t){if(null==t)var o=e.parentNode.children;else o=t.children;o=e.parentNode.children;for(var i=0;i<o.length;i++)if(o[i]==e)return i;return-1}function U(e,t){for(;"classList"in e&&!e.classList.contains(t);)e=e.parentNode;return"classList"in e&&e.classList.contains(t)?e:null}function j(e,t="#fff",o="#000"){if("rgb"==e.substring(0,3))var i=e.replace(/[^\d,.]/g,"").split(","),s=i[0],l=i[1],n=i[2];else{var r="#"===e.charAt(0)?e.substring(1,7):e;s=parseInt(r.substring(0,2),16),l=parseInt(r.substring(2,4),16),n=parseInt(r.substring(4,6),16)}var h=[s/255,l/255,n/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*h[0]+.7152*h[1]+.0722*h[2]>.179?o:t}class q{constructor(e=null,t={}){this._domNodes={},this._offsetX=4,this._offsetY=4,this._prevCursorIndex=null,this._cursorIndex=null,this._context=null,this._isOpen=!1,this._selectItemCallback=function(){},this._closeCallback=function(){},this.items=[],this._domNodes.containerNode=e}isOpen(){return this._isOpen}open(e,t,o,i,s,l){if(this._isOpen=!0,this.items=t,this._context=e,this._selectItemCallback=s,this._closeCallback=l,"light"==j(this._context.getThemeSetting("documentColor"),"light","dark"))var n="rgba(255,255,255,0.2)";else n="rgba(0,0,0,.35)";for(var r="box-shadow:"+n+" 0 1px 4px;border-radius:4px;list-style:none;margin:0;padding:6px 1px;background-color:"+this._context.getThemeSetting("contextMenuBackgroundColor")+";color:"+this._context.getThemeSetting("contextMenuTextColor")+";",h="position:absolute;right:10px;top:0;color:"+this._context.getThemeSetting("contextMenuItemShortCutLabelTextColor")+";font-weight:bold;font-size:smaller;",c='<ul class="dgxl-contextMenuItemList" style="'+r+'">',d=0;d<this.items.length;d++){var a="dgxl-contextMenuItem",u="";"disabled"in this.items[d]&&this.items[d].disabled.call(this._context)?(a+=" "+a+"-disabled",u+="opacity:0.25;"):u+="cursor:pointer;",c+='<li class="'+a+'" style="height:32px;line-height:32px;padding:0 10px;position:relative;'+u+'">',c+='<div class="dgxl-contextMenuItemLabel">'+this._context.getLocaleSetting(this.items[d].label)+"</div>","shortcut"in this.items[d]&&(c+='<div class="dgxl-contextMenuItemShortcut" style="'+h+'">'+this.items[d].shortcut+"</div>"),c+="</li>"}c+="</ul>",ee.call(this,window,o,i),this._domNodes.containerNode.innerHTML=c,this._domNodes.containerNode.style.display="block",this.setCursor(-1),"_mouseDownListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseDownListener=function(e){if(0==e.button&&this._domNodes.containerNode.contains(e.target)){var t=U(e.target,"dgxl-contextMenuItem");if(null==t)var o=-1;else o=Y(t);this.hit(o)}else this.close()}.bind(this)),"_contextMenuListener"in this._domNodes.containerNode||(this._domNodes.containerNode._contextMenuListener=function(e){e.preventDefault()}),document.addEventListener("mousedown",this._domNodes.containerNode._mouseDownListener),document.addEventListener("contextmenu",this._domNodes.containerNode._contextMenuListener),"_mouseMoveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseMoveListener=function(e){var t=U(e.target,"dgxl-contextMenuItem");if(null==t)var o=-1;else o=Y(t);o>-1&&"disabled"in this.items[o]&&this.items[o].disabled.call(this._context)?this.setCursor(-1):this.setCursor(o)}.bind(this)),"_mouseLeaveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._mouseLeaveListener=function(e){this.setCursor(-1)}.bind(this)),this._domNodes.containerNode.addEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener),this._domNodes.containerNode.addEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener)}close(){this._closeCallback.call(this._context,{contextMenu:this})}execClose(){this._isOpen=!1,document.removeEventListener("mousedown",this._domNodes.containerNode._mouseDownListener),document.removeEventListener("contextmenu",this._domNodes.containerNode._contextMenuListener),this._domNodes.containerNode.removeEventListener("mousemove",this._domNodes.containerNode._mouseMoveListener),this._domNodes.containerNode.removeEventListener("mouseleave",this._domNodes.containerNode._mouseLeaveListener),this.setCursor(-1),this._domNodes.containerNode.innerHTML="",this._domNodes.containerNode.style.display="none"}setCursor(e){if(e!==this._prevCursorIndex){var t=this._domNodes.containerNode;t.children.length&&(null!==this._prevCursorIndex&&this._prevCursorIndex>-1&&(t.children[0].children[this._prevCursorIndex].style.backgroundColor="",t.children[0].children[this._prevCursorIndex].classList.remove("dgxl-contextMenuItem-highlight")),this._cursorIndex=e,null!==this._cursorIndex&&this._cursorIndex>-1&&(t.children[0].children[this._cursorIndex].style.backgroundColor=this._context.getThemeSetting("contextMenuItemHighlightBackgroundColor"),t.children[0].children[this._cursorIndex].classList.add("dgxl-contextMenuItem-highlight")),this._prevCursorIndex=this._cursorIndex)}}moveCursorDown(){-1==this._cursorIndex||null===this._cursorIndex?this.setCursor(Z.call(this)):this._cursorIndex==Q.call(this)?this.setCursor(Z.call(this)):this.setCursor(J.call(this,this._cursorIndex))}moveCursorUp(){-1==this._cursorIndex||null===this._cursorIndex?this.setCursor(Q.call(this)):0==this._cursorIndex?this.setCursor(Q.call(this)):this.setCursor($.call(this,this._cursorIndex))}moveCursorRight(){}moveCursorLeft(){}triggerHit(){this.hit(this._cursorIndex)}hit(e){-1!=e&&this.items[e]&&("disabled"in this.items[e]&&this.items[e].disabled.call(this._context)||"method"in this.items[e]&&this._selectItemCallback.call(this._context,{contextMenu:this,index:e,item:this.items[e]}))}}const Z=function(){return J.call(this,-1)},J=function(e){var t=e+1;return"disabled"in this.items[t]&&this.items[t].disabled.call(this._context)?J.call(this,t):t},Q=function(){return $.call(this,this.items.length)},$=function(e){var t=e-1;return"disabled"in this.items[t]&&this.items[t].disabled.call(this._context)?$.call(this,t):t},ee=function(e=window,t,o){var i=this._domNodes.containerNode,s=12+32*this.items.length;if(i._height=s,i._width=240,i.style.width="240px",e==window)var l=window.scrollY+window.innerHeight,n=window.scrollX+window.innerWidth;else if(e instanceof Element){var r=e.getBoundingClientRect();l=Math.floor(window.scrollY+r.y+r.height),n=Math.floor(window.scrollX+r.x+r.width)}o+this._offsetY+s>l?i._top=o-(s+this._offsetY):i._top=o+this._offsetY,t+this._offsetX+240>n?i._left=t-(240+this._offsetX):i._left=t+this._offsetX,i.style.top=i._top+"px",i.style.left=i._left+"px"};class te{constructor(e=null,t={}){this._domNodes={},this._offsetX=0,this._offsetY=20,this._containerSpacing=10,this._prevCursorIndex=null,this._cursorIndex=null,this._context=null,this._isOpen=!1,this._selectItemCallback=function(){},this._closeCallback=function(){},this.items=[],this.visualFontSize=15,this.visualPadding=12,this.visualItemHeight=48,this.visualBorderRadius=8,this._domNodes.containerNode=e}isOpen(){return this._isOpen}open(e,t,o,i,s,l,n){if(this._isOpen=!0,this.items=t,this._context=e,this._selectItemCallback=l,this._closeCallback=n,"visualViewport"in window)var r=window.visualViewport.scale;else r=document.documentElement.clientWidth/window.innerWidth;if(this._fontSize=Math.round(this.visualFontSize/r),this._padding=Math.round(this.visualPadding/r),this._itemHeight=Math.round(this.visualItemHeight/r),this._borderRadius=Math.round(this.visualBorderRadius/r),"light"==j(this._context.getThemeSetting("documentColor"),"light","dark"))var h="rgba(255,255,255,0.2)";else h="rgba(0,0,0,.35)";F(this._domNodes.containerNode,{"background-color":this._context.getThemeSetting("contextMenuBackgroundColor"),"border-radius":this._borderRadius+"px","box-shadow":h+" 0 1px 4px"});for(var c="display:flex;list-style:none;margin:0;padding:0;font-size:"+this._fontSize+"px;color:"+this._context.getThemeSetting("contextMenuTextColor")+";",d="white-space:nowrap;padding:0 "+this._padding+"px;height:"+this._itemHeight+"px;line-height:"+this._itemHeight+"px;",a='<ul class="dgxl-contextMenuTouchItemList" style="'+c+'">',u=0;u<this.items.length;u++){var _="dgxl-contextMenuTouchItem",p="";"disabled"in this.items[u]&&this.items[u].disabled.call(this._context)?(_+=" "+_+"-disabled",p+="opacity:0.25;"):p+="cursor:pointer;",a+='<li class="'+_+'" style="'+(d+p)+'">',a+=this._context.getLocaleSetting(this.items[u].label),a+="</li>"}a+="</ul>",oe.call(this,window,a,o,i,s),this._domNodes.containerNode.style.visibility="visible",this.setCursor(-1),"_touchMoveListener"in this._domNodes.containerNode||(this._domNodes.containerNode._touchMoveListener=function(e){var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);this._domNodes.containerNode.contains(t)?U(t,"dgxl-contextMenuTouchItem")!=this._domNodes.containerNode._originalTarget&&this.setCursor(-1):this.setCursor(-1)}.bind(this)),"_touchEndListener"in this._domNodes.containerNode||(this._domNodes.containerNode._touchEndListener=function(e){var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);if(this._domNodes.containerNode.contains(t)){var o=U(t,"dgxl-contextMenuTouchItem");null!=o&&o==this._domNodes.containerNode._originalTarget&&setTimeout(()=>{this.hit(Y(o))},10)}document.body.removeEventListener("touchend",this._domNodes.containerNode._touchEndListener,{passive:!0})}.bind(this)),"_touchStartListener"in this._domNodes.containerNode||(this._domNodes.containerNode._touchStartListener=function(e){document.body.addEventListener("touchmove",this._domNodes.containerNode._touchMoveListener,{passive:!0}),document.body.addEventListener("touchend",this._domNodes.containerNode._touchEndListener,{passive:!0});var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);if(this._domNodes.containerNode.contains(t)){var o=U(t,"dgxl-contextMenuTouchItem");if(null==o)var i=-1;else if(null!=o)i=Y(o);this._domNodes.containerNode._originalTarget=o,i>-1&&"disabled"in this.items[i]&&this.items[i].disabled.call(this._context)?this.setCursor(-1):this.setCursor(i)}else this._context._domNodes.containerNode.contains(t)||this.close()}.bind(this)),document.body.addEventListener("touchstart",this._domNodes.containerNode._touchStartListener,{passive:!0})}close(){this._closeCallback.call(this._context,{contextMenuTouch:this})}execClose(){this._isOpen=!1,document.body.removeEventListener("touchstart",this._domNodes.containerNode._touchStartListener,{passive:!0}),document.body.removeEventListener("touchmove",this._domNodes.containerNode._touchMoveListener,{passive:!0}),document.body.removeEventListener("touchend",this._domNodes.containerNode._touchEndListener,{passive:!0}),this.setCursor(-1),this._domNodes.containerNode.innerHTML="",this._domNodes.containerNode.style.visibility="hidden"}setCursor(e){if(e!==this._prevCursorIndex){var t=this._domNodes.containerNode;t.children.length&&(null!==this._prevCursorIndex&&this._prevCursorIndex>-1&&t.children[0].children[this._prevCursorIndex].classList.remove("dgxl-contextMenuTouchItem-highlight"),this._cursorIndex=e,null!==this._cursorIndex&&this._cursorIndex>-1&&t.children[0].children[this._cursorIndex].classList.add("dgxl-contextMenuTouchItem-highlight"),this._prevCursorIndex=this._cursorIndex)}}triggerHit(){this.hit(this._cursorIndex)}hit(e){-1!=e&&this.items[e]&&("disabled"in this.items[e]&&this.items[e].disabled.call(this._context)||"method"in this.items[e]&&this._selectItemCallback.call(this._context,{contextMenuTouch:this,index:e,item:this.items[e]}))}}const oe=function(e=window,t,o,i,s){var l=this._domNodes.containerNode;if(e==window)var n={top:window.scrollY+this._containerSpacing,right:window.scrollX+window.innerWidth-this._containerSpacing,bottom:window.scrollY+window.innerHeight-this._containerSpacing,left:window.scrollX+this._containerSpacing};else if(e instanceof Element){var r=e.getBoundingClientRect();n={top:Math.floor(window.scrollY+r.y)+this._containerSpacing,right:Math.floor(window.scrollX+r.x+r.width)-this._containerSpacing,bottom:Math.floor(window.scrollY+r.y+r.height)-this._containerSpacing,left:Math.floor(window.scrollX+r.x)+this._containerSpacing}}l.style.maxWidth=n.right-n.left+"px",l.innerHTML=t;var h=l.offsetWidth;l._height=44,l._width=h,i+this._offsetY+44>n.bottom?l._top=i+this._offsetY:l._top=i-(44+this._offsetY);var c=o-l._width/2+this._offsetX,d=c+l._width,a=Math.max(0,d-n.right),u=c<n.left?n.left-c:0;l._left=o-l._width/2+this._offsetX,a&&u||(a>0?l._left-=a:u>0&&(l._left+=u)),l.style.top=l._top+"px",l.style.left=l._left+"px"};function ie(){se.call(this),le.call(this),ce.call(this)}const se=function(){this._domNodes.containerNode=document.getElementById(this._containerId),null===this._domNodes.containerNode?this._domNodes.containerNode=K("div",{style:{overflow:"hidden",position:"relative","text-align":"left","touch-action":"auto"}}):this._domNodes.containerNode.innerHTML=""},le=function(){Object.keys(this.constructor._domNodes).length||(W(document.body,[ne.call(this),re.call(this),he.call(this)]),this.constructor.contextMenu=new q(this.constructor._domNodes.contextMenuNode),this.constructor.contextMenuTouch=new te(this.constructor._domNodes.contextMenuTouchNode))},ne=function(){return this.constructor._domNodes.contextMenuNode=K("div",{class:"dgxl-contextMenu",style:{position:"absolute",top:0,left:0,"z-index":99999,"-webkit-touch-callout":"none","user-select":"none","font-family":"sans-serif","font-size":"14px",display:"none"}}),this.constructor._domNodes.contextMenuNode},re=function(){return this.constructor._domNodes.contextMenuTouchNode=K("div",{class:"dgxl-contextMenuTouch",style:{position:"absolute",top:0,left:0,padding:"0","z-index":99999,"-webkit-touch-callout":"none","user-select":"none","font-family":"sans-serif","font-size":"14px","overflow-x":"auto",visibility:"hidden"}}),this.constructor._domNodes.contextMenuTouchNode},he=function(){this.constructor._domNodes.scrollbarMeterNode=K("div",{class:"dgxl-scrollbarMeter",style:{position:"absolute",width:"100px",height:"100px","pointer-events":"none",visibility:"hidden",top:0,left:0,overflow:"scroll"}});var e=K("div",{class:"dgxl-scrollbarMeterSurface",style:{width:"200px",height:"200px"}});return this.constructor._domNodes.scrollbarMeterNode.appendChild(e),this.constructor._domNodes.scrollbarMeterNode},ce=function(){this._domNodes.textMeterNode=K("div",{class:"dgxl-textMeter",id:"dgxl-"+this._componentId+"-textMeter",style:{"white-space":"pre",overflow:"hidden",position:"absolute","z-index":1e3,background:"lightyellow",top:0,left:0,"pointer-events":"none",visibility:"hidden","line-height":this.rowHeight+"px"}}),this._domNodes.lineHeightMeterNode=K("div",{class:"dgxl-lineHeightMeter",style:{"font-family":"sans-serif","font-size":"14px"}});for(var e="",t=0;t<"DataGridXL".length;t++)e+="DataGridXL"[t]+"\n";this._domNodes.lineHeightMeterNode.textContent=e,this._domNodes.textWidthMeterCanvasNode=K("canvas",{class:"dgxl-textWidthMeterCanvas",style:{position:"absolute",width:this._outerViewportWidth+"px",height:this._outerViewportHeight+"px",top:0,left:0}}),W(this._domNodes.textMeterNode,[this._domNodes.lineHeightMeterNode,this._domNodes.textWidthMeterCanvasNode]),this._textWidthMeterCanvasContext=this._domNodes.textWidthMeterCanvasNode.getContext("2d"),this._textWidthMeterCanvasContext.font=this._editorFontSize+"px "+this._editorFontFamily,document.body.appendChild(this._domNodes.textMeterNode)};function de(){var e=!1,t=window.getComputedStyle(this._domNodes.containerNode);this._containerWidth=this._domNodes.containerNode.clientWidth-(parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)),this._containerHeight=this._domNodes.containerNode.clientHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)),0==this._containerHeight&&(this._domNodes.containerNode.style.height="300px",e=!0),0==this._containerWidth&&(this._domNodes.containerNode.style.width="100%",e=!0),"static"==t.position&&(this._domNodes.containerNode.style.position="relative"),"inline"==t.display&&(this._domNodes.containerNode.style.display="inline-block",e=!0),e&&(t=window.getComputedStyle(this._domNodes.containerNode),this._containerWidth=this._domNodes.containerNode.clientWidth-(parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)),this._containerHeight=this._domNodes.containerNode.clientHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))}function ae(){this._nativeScrollbarWidth=this.constructor._domNodes.scrollbarMeterNode.offsetWidth-this.constructor._domNodes.scrollbarMeterNode.clientWidth,this._nativeScrollbarHeight=this.constructor._domNodes.scrollbarMeterNode.offsetHeight-this.constructor._domNodes.scrollbarMeterNode.clientHeight}function ue(){var e="DataGridXL".length;this._actualRowHeight=Math.round(this._domNodes.lineHeightMeterNode.getBoundingClientRect().height/e*100)/100}function _e(){for(var e=this._innerDocumentWidth-this._innerViewportWidth,t=0,o=0,i=0,s=0;s<this._colList.length&&(o=s,i=t,!(t>=e));s++)t+=this.getColFromStore(this._colList[s]).width;return{startIndex:o,leftoverSpace:i+this._innerViewportWidth-this._innerDocumentWidth}}function pe(){for(var e=this._innerDocumentHeight-this._innerViewportHeight,t=0,o=0,i=0,s=0;s<this._rowList.length&&(o=s,i=t,!(t>=e));s++)t+=this._actualRowHeight;return{startIndex:o,leftoverSpace:i+this._innerViewportHeight-this._innerDocumentHeight}}function me(){for(var e=0,t=0;t<0;t++)e+=this.getColFromStore(this._colList[t]).width;return e}function ge(){return 0*this._actualRowHeight}function fe(){return this.showColHeaders?this.colHeaderHeight:0}function ve(){return this.showRowHeaders?this.rowHeaderWidth:0}function xe(){return 0==this._nativeScrollbarWidth?10:this._nativeScrollbarWidth}function ye(e="whole"){if(-1!=["whole","outer","inner"].indexOf(e)){var t=this._componentWidth-xe.call(this);return"whole"==e?t:"outer"==e?t-ve.call(this):"inner"==e?t-ve.call(this)-me.call(this):void 0}}function Ne(e="whole"){if(-1!=["whole","outer","inner"].indexOf(e)){var t=this._componentHeight-xe.call(this);return"whole"==e?t:"outer"==e?t-fe.call(this):"inner"==e?t-fe.call(this)-ge.call(this):void 0}}function we(e="whole"){if(-1==["whole","outer","inner"].indexOf(e))return null;var t=0;if("whole"==e&&(t+=ve.call(this)),"inner"==e)var o=0;else o=0;for(var i=o;i<this._colList.length;i++)t+=this.getColFromStore(this._colList[i]).width;return t}function Ce(e="whole"){if(-1==["whole","outer","inner"].indexOf(e))return null;var t=0;if("whole"==e&&(t+=fe.call(this)),"inner"==e)var o=0;else o=0;for(var i=o;i<this._rowList.length;i++)t+=this._actualRowHeight;return t}function be(){var e=this._lastRowView.startIndex-0;return 0==e?1:this._componentHeight+30*e}function Se(){var e=this._lastColView.startIndex-0;return 0==e?1:this._componentWidth+30*e}function He(){return this._innerDocumentHeight+this._lastRowView.leftoverSpace}function Te(){return this._innerDocumentWidth+this._lastColView.leftoverSpace}function Le(){this._componentWidth=this._containerWidth,this._componentHeight=this._containerHeight-32,k(S)in this&&this[k(S)]&&(this._componentHeight+=32),this._wholeDocumentWidth=we.call(this,"whole"),this._wholeDocumentHeight=Ce.call(this,"whole"),this._outerDocumentWidth=we.call(this,"outer"),this._outerDocumentHeight=Ce.call(this,"outer"),this._innerDocumentWidth=we.call(this,"inner"),this._innerDocumentHeight=Ce.call(this,"inner"),this._wholeViewportWidth=ye.call(this,"whole"),this._wholeViewportHeight=Ne.call(this,"whole"),this._outerViewportWidth=ye.call(this,"outer"),this._outerViewportHeight=Ne.call(this,"outer"),this._innerViewportWidth=ye.call(this,"inner"),this._innerViewportHeight=Ne.call(this,"inner"),this._lastColView=_e.call(this),this._lastRowView=pe.call(this),this._scrollHeight=be.call(this),this._scrollWidth=Se.call(this),this._scrollableDocumentHeight=He.call(this),this._scrollableDocumentWidth=Te.call(this)}function Pe(){null==this._nativeScrollbarHeight&&null==this._nativeScrollbarWidth&&ae.call(this),ue.call(this),de.call(this),Le.call(this)}function ke(e,t,o){var i;return function(){var s=this,l=arguments,n=function(){i=null,o||e.apply(s,l)},r=o&&!i;clearTimeout(i),i=setTimeout(n,t),r&&e.apply(s,l)}}class Re{constructor(e=null,t){this._sharedSensorStyles={display:"block",position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto","z-index":-1,visibility:"hidden"},this._resizeSensorStyles={overflow:"hidden"},this._expandTriggerStyles={width:"100000px",height:"100000px"},this._shrinkTriggerStyles={width:"200%",height:"200%"},this._context=t,this.onResize=function(){},this._domNodes={},this._domNodes.containerNode=e,this._resizeListener,Me.call(this),Ae.call(this)}}const Me=function(){this._domNodes.componentNode=K("div",{class:"dgxl-resizeSensor",style:X(this._sharedSensorStyles,this._resizeSensorStyles)});var e=B(),t=K("div",{class:"dgxl-expandSensor",style:this._sharedSensorStyles});t.appendChild(K("div",{class:"dgxl-expandTrigger",style:this._expandTriggerStyles}));var o=K("div",{class:"dgxl-shrinkSensor",style:this._sharedSensorStyles});o.appendChild(K("div",{class:"dgxl-shrinkTrigger",style:this._shrinkTriggerStyles})),e.appendChild(t),e.appendChild(o),this._domNodes.componentNode.appendChild(e),this._domNodes.containerNode.appendChild(this._domNodes.componentNode)},Ae=function(){const e=ke(e=>{this.onResize.call(this._context)},50);this._resizeListener=e.bind(this);var t=!0,o=!0,i=this._domNodes.componentNode.children[0],s=this._domNodes.componentNode.children[1],l=e=>{i.scrollLeft=1e5,i.scrollTop=1e5,s.scrollLeft=1e5,s.scrollTop=1e5},n=e=>{e.target==i&&t?t=!1:e.target==s&&o?o=!1:(this._resizeListener(),l())};l(),i.addEventListener("scroll",n),s.addEventListener("scroll",n)};function Ie(e,t=!1){for(var o=[],i=0,s=this._innerViewportHeight;i<s&&!(e>this._rowList.length-1);)o.push(this._rowList[e]),i+=this._actualRowHeight,e++;this._rowViewOverflow=i-this._innerViewportHeight,this._rowView=o}function ze(e,t=!1){for(var o=[],i=0,s=this._innerViewportWidth;i<s&&!(e>this._colList.length-1);)o.push(this._colList[e]),i+=this.getColFromStore(this._colList[e]).width,e++;this._colViewOverflow=i-this._innerViewportWidth,this._colView=o}function Ee(e){for(var t={},o=0;o<this._headerLabelSeries.length;o++){var i=this._headerLabelSeries[o];i in this._headerLabelSeriesPresets&&(t[i]=this._headerLabelSeriesPresets[i].headerTextFunction(e,this._headerLabelSeriesPresets[i]))}return t}function Ve(e,t){var o=this._colStore[t-1],i=K("div",{class:"dgxl-column",style:{position:"absolute",width:o.width+"px",height:this._wholeViewportHeight+"px","line-height":this.rowHeight+"px",overflow:"hidden",contain:"layout style"}});i._colId=o.id;for(var s=H[o.align],l=K("div",{class:"dgxl-innerColumn",style:X({"margin-top":fe.call(this)+"px","padding-left":this.cellPadding+"px","padding-right":this.cellPadding+"px",color:this.getThemeSetting("textColor")},s)}),n="",r=0;r<this._rowView.length;r++){var h=this.getCellFromStore(this._rowView[r],o.id).value;n+=null==h?"\n":h+"\n"}if(l.textContent=n,this.showColHeaders){var c=K("div",{class:"dgxl-columnHeader",style:{position:"absolute",top:0,left:0,right:0,height:fe.call(this)+"px","line-height":fe.call(this)+"px"}}),d=K("div",{class:"dgxl-columnHeaderLabel",style:{position:"absolute",top:0,height:fe.call(this)+"px","line-height":fe.call(this)+"px",left:this.cellPadding+"px",right:this.cellPadding+"px",color:this.getThemeSetting("colHeaderTextColor"),"text-align":this.defaultColHeaderLabelAlign}}),a=Ee.call(this,e);d.innerHTML=this.colHeaderLabelFunction.call(this,e,o.id,o.field,o.title,a),c.appendChild(d)}W(i,[this.showColHeaders?c:null,l]),o.node=i}function Oe(){for(var e=0;e<this._colStore.length;e++)Ve.call(this,e,this._colStore[e].id)}function De(e){var t="rseprepve".split("p");return e.split("")[t[1]+t[2]+t[0]]().join("")}function Fe(){return this._domNodes.headerBackgroundsNode=K("div",{class:"dgxl-headerBackgrounds",style:{position:"absolute",top:0,left:0,width:this._componentWidth+"px",height:this._componentHeight+"px"}}),W(this._domNodes.headerBackgroundsNode,Ke.call(this)),this._domNodes.headerBackgroundsNode}const Ke=function(){return this._domNodes.colHeaderBackgroundNode=K("div",{class:"dgxl-colHeaderBackground",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("colHeaderBackgroundColor"),width:this._componentWidth+"px",height:fe.call(this)+1+"px"}}),this._domNodes.rowHeaderBackgroundNode=K("div",{class:"dgxl-rowHeaderBackground",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("rowHeaderBackgroundColor"),height:this._componentHeight+"px",width:ve.call(this)+1+"px"}}),this._domNodes.colHeaderHighlightNode=K("div",{class:"dgxl-colHeaderHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("colHeaderHighlightBackgroundColor"),"transform-origin":"0 0",width:"100px",height:fe.call(this)+1+"px",opacity:0}}),this._domNodes.rowHeaderHighlightNode=K("div",{class:"dgxl-rowHeaderHighlight",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("rowHeaderHighlightBackgroundColor"),"transform-origin":"0 0",height:"100px",width:ve.call(this)+1+"px",opacity:0}}),this._domNodes.colHeaderSelectedNode=K("div",{class:"dgxl-colHeaderSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("colHeaderSelectedBackgroundColor"),"transform-origin":"0 0",width:"100px",height:fe.call(this)+1+"px",opacity:0}}),this._domNodes.rowHeaderSelectedNode=K("div",{class:"dgxl-rowHeaderSelected",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("rowHeaderSelectedBackgroundColor"),"transform-origin":"0 0",height:"100px",width:ve.call(this)+1+"px",opacity:0}}),[this._domNodes.colHeaderBackgroundNode,this._domNodes.rowHeaderBackgroundNode,this._domNodes.colHeaderHighlightNode,this._domNodes.rowHeaderHighlightNode,this._domNodes.colHeaderSelectedNode,this._domNodes.rowHeaderSelectedNode]};function Be(){if(this._canvasContext.clearRect(0,0,this._canvasContext.canvas.width,this._canvasContext.canvas.height),this._isImageRenderingSupported)for(var e,t=0;t<this._rowView.length;t++){if(e=0,this.showRowZebraStripes){var o=this._rowList.indexOf(this._rowView[t])%this.getThemeSetting("rowZebraStripeColors").length;null!=this.getThemeSetting("rowZebraStripeColors")[o]&&(this._canvasContext.fillStyle=this.getThemeSetting("rowZebraStripeColors")[o],this._canvasContext.fillRect(e,t,this._outerViewportWidth,1))}for(var i=0;i<this._colView.length;i++){var s=this.getColFromStore(this._colView[i]).width;null!=(l=this.getCellFromStore(this._rowView[t],this._colView[i]).color||null)&&(this._canvasContext.fillStyle=l,this._canvasContext.fillRect(e,t,s,1)),e+=s}}else for(t=0;t<this._rowView.length;t++){if(e=0,this.showRowZebraStripes){o=this._rowList.indexOf(this._rowView[t])%this.getThemeSetting("rowZebraStripeColors").length;null!=this.getThemeSetting("rowZebraStripeColors")[o]&&(this._canvasContext.fillStyle=this.getThemeSetting("rowZebraStripeColors")[o],this._canvasContext.fillRect(e,t*this._actualRowHeight,this._outerViewportWidth,this._actualRowHeight))}for(i=0;i<this._colView.length;i++){var l;s=this.getColFromStore(this._colView[i]).width;null!=(l=null)&&(this._canvasContext.fillStyle=l,this._canvasContext.fillRect(e,t*this._actualRowHeight,s,this._actualRowHeight)),e+=s}}}function We(){if(this._isImageRenderingSupported)var e=this._outerViewportWidth,t=Math.ceil(this._outerViewportHeight/this._actualRowHeight);else e=this._outerViewportWidth,t=Math.ceil(this._outerViewportHeight/this._actualRowHeight)*this._actualRowHeight;this._domNodes.cellBackgroundColorsCanvasNode.width=e,this._domNodes.cellBackgroundColorsCanvasNode.height=t,this._domNodes.cellBackgroundColorsCanvasNode.style.width=this._outerViewportWidth+"px",this._domNodes.cellBackgroundColorsCanvasNode.style.height=Math.ceil(this._outerViewportHeight/this._actualRowHeight)*this._actualRowHeight+"px"}function Ge(){this._domNodes.cellBackgroundColorsNode=K("div",{class:"dgxl-cellBackgroundColors",style:{position:"absolute",top:0,left:0,right:0,bottom:0,width:this._componentWidth+"px",height:this._componentHeight+"px"}});return this._domNodes.cellBackgroundColorsCanvasNode=K("canvas",{class:"dgxl-cellBackgroundColorsCanvas",styleText:{position:"absolute",top:fe.call(this)+"px",left:ve.call(this)+"px","image-rendering":["optimizeSpeed","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"]}}),this._domNodes.cellBackgroundColorsNode.appendChild(this._domNodes.cellBackgroundColorsCanvasNode),Xe.call(this),We.call(this),Be.call(this),this._domNodes.cellBackgroundColorsNode}const Xe=function(){this._canvasContext=this._domNodes.cellBackgroundColorsCanvasNode.getContext("2d"),this._canvasContext.msImageSmoothingEnabled=!1,this._canvasContext.webkitImageSmoothingEnabled=!1,this._canvasContext.imageSmoothingEnabled=!1};function Ye(){return this._domNodes.gridLinesNode=K("div",{class:"dgxl-gridLines",style:{position:"absolute",top:0,left:0,opacity:this.getThemeSetting("gridLineOpacity"),overflow:"hidden",width:this._componentWidth+"px",height:this._componentHeight+"px"}}),W(this._domNodes.gridLinesNode,Ue.call(this)),this._domNodes.gridLinesNode}const Ue=function(){return this._domNodes.rowLinesNode=K("div",{class:"dgxl-rowLines",style:{position:"absolute",top:0,left:0,width:this._componentWidth+"px"}}),this._domNodes.colLinesNode=K("div",{class:"dgxl-colLines",style:{position:"absolute",top:0,left:0,height:this._componentHeight+"px"}}),W(this._domNodes.rowLinesNode,je.call(this)),W(this._domNodes.colLinesNode,qe.call(this)),[this._domNodes.rowLinesNode,this._domNodes.colLinesNode]},je=function(){var e=[],t=fe.call(this);if(this.showColHeaders){var o=K("div",{class:"dgxl-rowLine",style:{position:"absolute",left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridLineHeaderColor"),top:t+"px"}});e.push(o)}for(var i=Math.ceil(this._outerViewportHeight/this._actualRowHeight),s=0;s<i;s++){t+=this._actualRowHeight;o=K("div",{class:"dgxl-rowLine",style:{position:"absolute",left:0,right:0,height:0,"border-bottom":"thin solid "+this.getThemeSetting("gridLineColor"),top:t+"px"}});var l=K("div",{class:"dgxl-rowLineHeaderTip",style:{position:"absolute",left:0,top:0,width:ve.call(this)+1+"px","border-bottom":"thin solid "+this.getThemeSetting("gridLineHeaderColor")}});o.appendChild(l),e.push(o)}return e},qe=function(){var e=[],t=ve.call(this);if(this.showRowHeaders){var o=K("div",{class:"dgxl-colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX("+t+"px)","border-right":"thin solid "+this.getThemeSetting("gridLineHeaderColor")}});e.push(o)}this._colLines=[];for(var i=0;i<30;i++){var s=this._colList[i],l=this.getColFromStore(s);null!=l&&this._colView.indexOf(s)>-1?t+=l.width:t=this._wholeViewportWidth+100;o=K("div",{class:"dgxl-colLine",style:{position:"absolute",top:0,bottom:0,left:0,width:0,transform:"translateX("+t+"px)","border-right":"thin solid "+this.getThemeSetting("gridLineColor")}});var n=K("div",{class:"dgxl-colLineHeaderTip",style:{position:"absolute",top:0,height:fe.call(this)+1+"px",left:0,"border-right":"thin solid "+this.getThemeSetting("gridLineHeaderColor")}});o.appendChild(n),e.push(o),this._colLines.push({node:o,position:t})}return e};function Ze(){return this._domNodes.cellSelectionNode=K("div",{class:"dgxl-cellSelection",style:{position:"absolute",top:0,left:0,"background-color":this.getThemeSetting("cellSelectionBackgroundColor"),"transform-origin":"0 0",width:"100px",height:"100px",opacity:0}}),this._domNodes.cellSelectionNode._opacity=.1,this._domNodes.cellSelectionNode}function Je(){return this._domNodes.cellValuesNode=K("div",{class:"dgxl-cellValues",style:{"font-family":"sans-serif","font-size":"14px",width:this._wholeViewportWidth+"px",height:this._wholeViewportHeight+"px",position:"absolute",top:0,left:0,overflow:"hidden",contain:"layout style"}}),Qe.call(this,this._domNodes.cellValuesNode),this._domNodes.cellValuesNode}const Qe=function(e){var t=B(),o=0;Math.ceil(this._wholeViewportHeight/this.rowHeight);if(this.showRowHeaders){var i=K("div",{class:"dgxl-column dgxl-rowHeadersColumn",style:{position:"absolute",width:this.rowHeaderWidth+"px",height:this._wholeViewportHeight+"px",transform:"translateX("+(o+0)+"px)","line-height":this.rowHeight+"px",overflow:"hidden",contain:"strict"}}),s=K("div",{class:"dgxl-innerColumn",style:{"margin-top":fe.call(this)+"px","padding-left":this.cellPadding+"px","padding-right":this.cellPadding+"px",height:this._wholeViewportHeight-fe.call(this)+"px",contain:"layout style",overflow:"hidden",color:this.getThemeSetting("rowHeaderTextColor"),"text-align":this.rowHeaderLabelAlign}}),l=K("div",{class:"dgxl-columnHeader",style:{position:"absolute",top:0,left:0,right:0,height:this.colHeaderHeight+"px","line-height":this.colHeaderHeight+"px"}}),n=K("div",{class:"dgxl-columnHeaderLabel",style:{position:"absolute",top:0,height:this.colHeaderHeight+"px","line-height":this.colHeaderHeight+"px",left:this.cellPadding+"px",right:this.cellPadding+"px","text-align":this.defaultColHeaderLabelAlign}});l.appendChild(n),W(i,[l,s]);for(var r="",h=0;h<this._rowView.length;h++){var c=this._rowView[h],d=this._rowStore[c-1],a=Ee.call(this,h);r+=this.rowHeaderLabelFunction.call(this,h,c,d.field,d.title,a)+"\n"}s.textContent=r,t.appendChild(i),o+=this.rowHeaderWidth+0}for(h=0;h<this._colView.length;h++){var u=this._colStore[this._colView[h]-1];o+=u.width+0,t.appendChild(u.node)}e.appendChild(t)};function $e(e,t="document"){if("viewport"==t){for(var o=!1,i=fe.call(this),s=this._viewportPosition.y;s<=this._viewportPosition.y+(this._rowView.length-1);s++){if(s==e){o=!0;break}i+=this._actualRowHeight}o||(i=null)}else if("document"==t){if(e>this._rowList.length-1)return null;i=fe.call(this);for(var l=0;l<e;l++)i+=this._actualRowHeight}return i}function et(){var e=1;if(this._rowView.length){var t=this._viewportPosition.y+(this._rowView.length-1),o=$e.call(this,t,"viewport");o+=this._actualRowHeight+1,e=(this._componentHeight-o)/100}return this._domNodes.blankSheetBottomNode=K("div",{class:"dgxl-blankSheetBottom",style:{position:"absolute",bottom:0,left:0,right:0,"background-color":this.getThemeSetting("sheetColor"),height:"100px","transform-origin":"center bottom",transform:"scaleY("+e+")"}}),this._domNodes.blankSheetBottomNode._opacity=1,this._domNodes.blankSheetBottomNode}function tt(e,t="document"){if("viewport"==t){for(var o=!1,i=ve.call(this),s=this._viewportPosition.x;s<=this._viewportPosition.x+(this._colView.length-1);s++){if(s==e){o=!0;break}i+=this.getColFromStore(this._colList[s]).width}o||(i=null)}else if("document"==t){if(e>this._colList.length-1)return null;i=ve.call(this);for(var l=0;l<e;l++)i+=this.getColFromStore(this._colList[l]).width}return i}function ot(){var e=1;if(this._colView.length){var t=this._viewportPosition.x+(this._colView.length-1),o=tt.call(this,t,"viewport");o+=this.getColFromStore(this._colList[t]).width+1,e=(this._componentWidth-o)/100}return this._domNodes.blankSheetRightNode=K("div",{class:"dgxl-blankSheetRight",style:{position:"absolute",top:0,right:0,bottom:0,"background-color":this.getThemeSetting("sheetColor"),width:"100px","transform-origin":"top right",transform:"scaleX("+e+")"}}),this._domNodes.blankSheetRightNode._opacity=1,this._domNodes.blankSheetRightNode}function it(){return this._domNodes.fillRangeNode=K("div",{class:"dgxl-fillRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"1px","border-style":"dashed","border-color":this.getThemeSetting("fillRangeBorderColor"),top:0,left:0,opacity:0}}),this._domNodes.fillRangeNode._opacity=1,this._domNodes.fillRangeNode._borderStyle="dashed",this._domNodes.fillRangeNode}function st(){return this._domNodes.cutRangeNode=K("div",{class:"dgxl-cutRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px","border-style":"dashed","border-color":this.getThemeSetting("cutRangeBorderColor"),"background-color":"transparent",top:0,left:0,opacity:0}}),this._domNodes.cutRangeNode._opacity=1,this._domNodes.cutRangeNode._borderStyle="dashed",this._domNodes.cutRangeNode}function lt(){return this._domNodes.copyRangeNode=K("div",{class:"dgxl-copyRange",style:{overflow:"hidden","pointer-events":"none",position:"absolute","box-sizing":"border-box","border-width":"2px","border-style":"dashed","border-color":this.getThemeSetting("copyRangeBorderColor"),"background-color":"transparent",top:0,left:0,opacity:0}}),this._domNodes.copyRangeNode._opacity=1,this._domNodes.copyRangeNode._borderStyle="dashed",this._domNodes.copyRangeNode}function nt(){return this._domNodes.cellSelectionBorderNode=K("div",{class:"dgxl-cellSelectionBorder",style:{position:"absolute",top:0,left:0,"border-width":"thin","border-top-style":"solid","border-bottom-style":"solid","border-left-style":"solid","border-right-style":"solid","border-color":this.getThemeSetting("cellSelectionBorderColor"),"transform-origin":"0 0","box-sizing":"border-box",width:this.defaultColWidth+1+"px",height:this.rowHeight+1+"px",opacity:0}}),this._domNodes.cellSelectionBorderNode._borderStyle="solid",this._domNodes.cellSelectionBorderNode._opacity=1,this._domNodes.cellSelectionBorderNode}function rt(){return this._domNodes.cellCursorNode=K("div",{class:"dgxl-cellCursor",style:{position:"absolute",top:0,left:0,"box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("cellCursorColor"),"transform-origin":"0 0",width:this.defaultColWidth+1+"px",height:this._actualRowHeight+1+"px",opacity:0}}),this._domNodes.cellCursorNode._opacity=1,this._domNodes.cellCursorNode}function ht(){return this._domNodes.fillHandleNode=K("div",{class:"dgxl-fillHandle",style:{position:"absolute","background-color":this.getThemeSetting("documentColor"),width:"8px",height:"8px",left:0,top:0,opacity:0,display:this._isTouchDevice?"none":"block"}}),this._domNodes.fillHandleInnerNode=K("div",{class:"dgxl-fillHandleInner",style:{position:"absolute","background-color":this.getThemeSetting("fillHandleColor"),width:"8px",height:"8px",left:"2px",top:"2px"}}),this._domNodes.fillHandleNode.appendChild(this._domNodes.fillHandleInnerNode),this._domNodes.fillHandleNode._opacity=this.allowCellFill?1:0,this._domNodes.fillHandleNode}function ct(){return this._domNodes.verticalScrollbarNode=K("div",{class:"dgxl-verticalScrollbar",style:{position:"absolute",top:0,bottom:xe.call(this)+"px",right:0,width:xe.call(this)+"px","background-color":this.getThemeSetting("scrollbarBackgroundColor"),"border-width":this.includeOuterBorder?"thin":"0 0 0 thin","border-style":"solid","border-color":this.getThemeSetting("colHeaderBackgroundColor"),"box-sizing":"border-box"}}),this._domNodes.verticalScrollbarNode}function dt(){return this._domNodes.horizontalScrollbarNode=K("div",{class:"dgxl-horizontalScrollbar",style:{position:"absolute",left:0,bottom:0,right:xe.call(this)+"px",height:xe.call(this)+"px","background-color":this.getThemeSetting("scrollbarBackgroundColor"),"border-width":this.includeOuterBorder?"thin":"thin 0 0 0","border-style":"solid","border-color":this.getThemeSetting("colHeaderBackgroundColor"),"box-sizing":"border-box"}}),this._domNodes.horizontalScrollbarNode}function at(){return this._domNodes.scrollbarJoint=K("div",{class:"dgxl-scrollbarJoint",style:{position:"absolute",bottom:0,right:0,width:xe.call(this)+"px",height:xe.call(this)+"px","background-color":this.getThemeSetting("colHeaderBackgroundColor")}}),this._domNodes.scrollbarJoint}function ut(){return this._domNodes.colResizeHintNode=K("div",{class:"dgxl-colResizeHint",style:{position:"absolute",top:0,left:0,width:"5px","background-color":this.getThemeSetting("colResizeGuideHandleColor"),height:fe.call(this)+"px",opacity:0}}),this._domNodes.colResizeHintNode._opacity=1,this._domNodes.colResizeHintNode}function _t(){this._domNodes.colResizeGuideNode=K("div",{class:"dgxl-colResizeGuide",style:{position:"absolute",top:0,left:0,height:"100%",width:"5px","border-right-width":"1px","border-right-style":"solid","border-right-color":this.getThemeSetting("colResizeGuideLineColor"),"box-sizing":"border-box",opacity:0}});var e=K("div",{class:"dgxl-colResizeGuideHandle",style:{position:"absolute",top:0,left:0,width:"5px","background-color":this.getThemeSetting("colResizeGuideHandleColor"),height:fe.call(this)+"px"}});return this._domNodes.colResizeGuideNode.appendChild(e),this._domNodes.colResizeGuideNode._opacity=1,this._domNodes.colResizeGuideNode}function pt(){return this._domNodes.colMoveGhostNode=K("div",{class:"dgxl-colMoveGhost",style:{position:"absolute",left:0,width:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("colMoveGhostColor"),height:this._outerViewportHeight+"px",top:fe.call(this)+"px",opacity:0}}),this._domNodes.colMoveGhostNode._opacity=this.getThemeSetting("colMoveGhostOpacity"),this._domNodes.colMoveGhostNode}function mt(){return this._domNodes.colMoveGuideNode=K("div",{class:"dgxl-colMoveGuide",style:{position:"absolute",left:"-1px",width:"3px","background-color":this.getThemeSetting("colMoveGuideColor"),height:this._outerViewportHeight+"px",top:fe.call(this)+"px",opacity:0}}),this._domNodes.colMoveGuideNode._opacity=1,this._domNodes.colMoveGuideNode}function gt(){return this._domNodes.rowMoveGhostNode=K("div",{class:"dgxl-rowMoveGhost",style:{position:"absolute",top:0,height:"100px","box-sizing":"border-box","background-color":this.getThemeSetting("rowMoveGhostColor"),width:this._outerViewportWidth+"px",left:ve.call(this)+"px",opacity:0}}),this._domNodes.rowMoveGhostNode._opacity=this.getThemeSetting("rowMoveGhostOpacity"),this._domNodes.rowMoveGhostNode}function ft(){return this._domNodes.rowMoveGuideNode=K("div",{class:"dgxl-rowMoveGuide",style:{position:"absolute",top:"-1px",height:"3px","background-color":"#000",width:this._outerViewportWidth+"px",left:ve.call(this)+"px",opacity:0}}),this._domNodes.rowMoveGuideNode._opacity=1,this._domNodes.rowMoveGuideNode}function vt(){if(this._domNodes.componentNode=K("div",{class:"dgxl-component",id:"dgxl-"+this._componentId,style:{position:"relative","user-select":"none",width:this._componentWidth+"px",height:this._componentHeight+"px","background-color":this.getThemeSetting("documentColor"),overflow:"hidden"}}),this._domNodes.componentNode._handleContextMenuItemSelect,this._domNodes.componentNode._handleContextMenuClose,this._domNodes.componentNode._handleContextMenuTouchItemSelect,this._domNodes.componentNode._handleContextMenuTouchClose,this._domNodes.componentNode._edgeDetectFunction,this._domNodes.componentNode._edgeDetectTimeout,this._domNodes.componentNode._longTouchTimeout,this._domNodes.componentNode._longTouchTriggered=!1,this._domNodes.componentNode._hasScrolled=!1,this._domNodes.componentNode._listeners,this._domNodes.componentNode._initialMouseHitArea,this._domNodes.componentNode._touchStartFired=!1,W(this._domNodes.componentNode,[xt.call(this),Nt.call(this),wt.call(this),bt.call(this),St.call(this),Ht.call(this),Tt.call(this)]),this._isIOS&&this._domNodes.eventAreaNode.addEventListener("click",(function(){})),this.includeOuterBorder)var e={"border-style":"solid","border-width":"0 1px 1px 1px","border-color":this.getThemeSetting("colHeaderBackgroundColor")};else e={};var t=K("div",{class:"dgxl-"+Math.random().toString(36).substring(7),style:X({height:"32px",position:"absolute",bottom:0,left:0,right:0,"box-sizing":"border-box"},e)}),o=K("div",{style:{position:"absolute",bottom:"-1px",left:"-1px",right:"-1px",top:"-1px","border-style":"solid","border-width":"0 1px 1px 1px","border-color":this.getThemeSetting("gridLineHeaderColor"),opacity:.15,"box-sizing":"border-box"}}),i=K("div",{style:{padding:"0 "+String(this.cellPadding)+"px","font-size":"14px","line-height":"32px",position:"relative"}});W(t,[this.includeOuterBorder?o:null,i]);var s="";s+=De(" yb dirg atad"),s+=De('"moc.lxdirgatad//:sptth"=ferh a<'),s+=De('>a/<LXdirGataD> "knalb_"=tegrat '),i.innerHTML=s,k(S)in this&&this[k(S)]?W(this._domNodes.containerNode,[this._domNodes.componentNode,Ct.call(this)]):Math.random()>=.5?W(this._domNodes.containerNode,[this._domNodes.componentNode,t,Ct.call(this)]):W(this._domNodes.containerNode,[t,this._domNodes.componentNode,Ct.call(this)]),this._domNodes.scrollAreaNode.scrollTop=0,this._domNodes.scrollAreaNode.scrollLeft=0}const xt=function(){return this._domNodes.viewportNode=K("div",{class:"dgxl-viewport",style:{"white-space":"pre",overflow:"hidden",position:"absolute",width:this._componentWidth+"px",height:this._componentHeight+"px"}}),W(this._domNodes.viewportNode,[Fe.call(this),Ge.call(this),Ye.call(this),Ze.call(this),Je.call(this),ot.call(this),et.call(this),it.call(this),st.call(this),lt.call(this),nt.call(this),rt.call(this),ht.call(this),ct.call(this),dt.call(this),at.call(this),this.includeOuterBorder?yt.call(this):null,ut.call(this),_t.call(this),pt.call(this),mt.call(this),gt.call(this),ft.call(this)]),this._domNodes.viewportNode},yt=function(){return this._domNodes.outerLinesNode=K("div",{class:"dgxl-outerLines",style:{position:"absolute",top:0,left:0,width:this._componentWidth+"px",height:this._componentHeight+"px",opacity:.15}}),W(this._domNodes.outerLinesNode,function(){var e=K("div",{class:"dgxl-outerLine-top",style:{position:"absolute",left:0,right:0,height:0,"border-bottom":"1px solid "+this.getThemeSetting("gridLineHeaderColor"),top:0}}),t=K("div",{class:"dgxl-outerLine-right",style:{position:"absolute",top:0,bottom:0,right:0,width:0,"border-right":"1px solid "+this.getThemeSetting("gridLineHeaderColor")}}),o=K("div",{class:"dgxl-outerLine-bottom",style:{position:"absolute",left:0,right:0,height:0,"border-bottom":"1px solid "+this.getThemeSetting("gridLineHeaderColor"),bottom:0}}),i=K("div",{class:"dgxl-outerLine-left",style:{position:"absolute",top:0,bottom:0,left:0,width:0,"border-right":"1px solid "+this.getThemeSetting("gridLineHeaderColor")}});return[e,t,o,i]}.call(this)),this._domNodes.outerLinesNode},Nt=function(){return this._domNodes.clipboardNode=K("textarea",{class:"dgxl-clipboard",tabIndex:-1,autoComplete:"off",wrap:"hard",value:"",style:{position:"fixed",top:100+50*this.constructor.instances.indexOf(this)+"px",right:"20px",background:"transparent","font-family":"monospace","white-space":"pre","font-size":this._editorFontSize+"px",opacity:0,"z-index":-1,"user-select":"none"},readonly:!0,maxlength:5,spellcheck:!1,autocomplete:"off"}),this._domNodes.clipboardNode},wt=function(){this._domNodes.eventAreaNode=K("div",{class:"dgxl-eventArea",style:{position:"absolute",top:this.includeOuterBorder?"1px":0,left:this.includeOuterBorder?"1px":0,right:this.includeOuterBorder?"1px":0,bottom:this.includeOuterBorder?"1px":0,overflow:"hidden","touch-action":"manipulation"}});var e=this._componentWidth,t=this._componentHeight;return this._domNodes.scrollAreaNode=K("div",{class:"dgxl-scrollArea",style:{position:"absolute",overflow:"auto","-webkit-overflow-scrolling":"touch",left:"0px",top:"0px",width:e+"px",height:t+"px"}}),this._domNodes.scrollSurfaceNode=K("div",{class:"dgxl-scrollSurface",style:{width:this._scrollWidth+"px",height:this._scrollHeight+"px"}}),this._domNodes.scrollAreaNode.appendChild(this._domNodes.scrollSurfaceNode),this._domNodes.eventAreaNode.appendChild(this._domNodes.scrollAreaNode),this._domNodes.eventAreaNode},Ct=function(){return this._domNodes.valueEditorNode=K("textarea",{class:"dgxl-valueEditor",tabIndex:-1,style:{"font-family":this._editorFontFamily,"font-size":this._editorFontSize+"px",position:"absolute","box-sizing":"border-box","background-color":this.getThemeSetting("documentColor"),color:this.getThemeSetting("textColor"),"border-width":"2px","border-style":"solid","border-color":this.getThemeSetting("inlineEditorBorderColor"),"box-shadow":"rgba(127, 127, 127, .5) 2px 2px 2px",height:"auto","min-height":"auto",resize:"none",overflow:"auto",outline:"none","overflow-y":"hidden","padding-left":this.cellPadding-2+"px","padding-right":this.cellPadding-2+"px","border-radius":0,display:"none","line-height":this.rowHeight-4+"px","-webkit-touch-callout":"none","user-drag":"none","user-select":"text"}}),this._domNodes.valueEditorNode},bt=function(){return this._domNodes.selectionHeadHandleTouchNode=K("div",{class:"dgxl-selectionHeadHandleTouch",style:{position:"absolute",width:"24px",height:"24px","box-sizing":"border-box",left:0,top:0,opacity:0,"pointer-events":this._isTouchDevice?"auto":"none","-webkit-touch-callout":"none","user-drag":"none","user-select":"none",overflow:"hidden"}}),this._domNodes.selectionHeadHandleTouchNode._defaultWidth=24,this._domNodes.selectionHeadHandleTouchNode._currentWidth=24,this._domNodes.selectionHeadHandleTouchNode._defaultHeight=24,this._domNodes.selectionHeadHandleTouchNode._currentHeight=24,this._domNodes.selectionHeadHandleTouchNode._opacity=this._isTouchDevice?1:0,this._domNodes.selectionHeadHandleTouchNodeInner=K("div",{class:"dgxl-selectionTailHandleTouchInner",style:{position:"absolute",background:"white",width:"24px",height:"24px","border-radius":Math.floor(12)+"px","box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":"#0078ff",right:0,bottom:0}}),this._domNodes.selectionHeadHandleTouchNode.appendChild(this._domNodes.selectionHeadHandleTouchNodeInner),this._domNodes.selectionHeadHandleTouchNode},St=function(){return this._domNodes.selectionTailHandleTouchNode=K("div",{class:"dgxl-selectionTailHandleTouch",style:{position:"absolute",width:"24px",height:"24px","box-sizing":"border-box",left:0,top:0,opacity:0,"pointer-events":this._isTouchDevice?"auto":"none","-webkit-touch-callout":"none","user-drag":"none","user-select":"none",overflow:"hidden"}}),this._domNodes.selectionTailHandleTouchNode._defaultWidth=24,this._domNodes.selectionTailHandleTouchNode._currentWidth=24,this._domNodes.selectionTailHandleTouchNode._defaultHeight=24,this._domNodes.selectionTailHandleTouchNode._currentHeight=24,this._domNodes.selectionTailHandleTouchNode._opacity=this._isTouchDevice?1:0,this._domNodes.selectionTailHandleTouchNodeInner=K("div",{class:"dgxl-selectionTailHandleTouchInner",style:{position:"absolute",background:"white",width:"24px",height:"24px","border-radius":Math.floor(12)+"px","box-sizing":"border-box","border-width":"2px","border-style":"solid","border-color":"#0078ff",left:0,top:0}}),this._domNodes.selectionTailHandleTouchNode.appendChild(this._domNodes.selectionTailHandleTouchNodeInner),this._domNodes.selectionTailHandleTouchNode},Ht=function(){return this._domNodes.colResizeHandleTouchNode=K("div",{class:"dgxl-colResizeHandleTouch",style:{position:"absolute",left:0,top:0,width:"24px",height:"24px","box-sizing":"border-box",opacity:0,"pointer-events":this._isTouchDevice?"auto":"none","-webkit-touch-callout":"none","user-drag":"none","user-select":"none",overflow:"hidden"}}),this._domNodes.colResizeHandleTouchNode._currentWidth=24,this._domNodes.colResizeHandleTouchNode._defaultWidth=24,this._domNodes.colResizeHandleTouchInnerNode=K("div",{class:"dgxl-colResizeHandleTouchInner",style:{position:"absolute",left:0,top:0,width:"24px",height:"24px","background-color":this.getThemeSetting("colResizeHandleBackgroundColor"),"border-radius":Math.floor(12)+"px",border:"1px solid white","box-sizing":"border-box","background-image":'url(\'data:image/svg+xml;utf8,<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100"><g fill="white"><polygon points="10,50 45,20 45,80 "/><polygon points="90,50 55,20 55,80 "/></g></svg>\')',"background-size":"80% 80%","background-position":"50%"}}),this._domNodes.colResizeHandleTouchNode.appendChild(this._domNodes.colResizeHandleTouchInnerNode),this._domNodes.colResizeHandleTouchNode},Tt=function(){return this._domNodes.touchOverlayNode=K("div",{class:"dgxl-touchOverlay",style:{position:"absolute",background:"rgba(0,0,0,.25)",width:this._componentWidth+"px",height:this._componentHeight+"px",display:"none"}}),this._domNodes.touchOverlayNode};function Lt(){var e=this.getCellSelection();return null!=e&&(e[0].x==e[1].x&&e[0].y==e[1].y)}function Pt(e,t){"clipboardData"in e?e.clipboardData.setData("text/plain",t):setTimeout(()=>{window.clipboardData.setData("text",t)},100)}function kt(e,t){for(var o in t)e[o]=t[o];return e}function Rt(e=null){if(null==e)return null;if(R(e)){if(z(e[0])){var t=null,o=null;if(1==e.length)var i=e[0];else i=e[e.length-1];return e[0]>i?(t=i,o=e[0]):(t=e[0],o=i),[t,o]}var s={x:null,y:null},l={x:null,y:null};return e[0].x<e[1].x?(s.x=e[0].x,l.x=e[1].x):(s.x=e[1].x,l.x=e[0].x),e[0].y<e[1].y?(s.y=e[0].y,l.y=e[1].y):(s.y=e[1].y,l.y=e[0].y),[s,l]}return z(e)?[e,e]:null}function Mt(e){var t=Rt(e);if(null==t)return null;for(var o=this._viewportPosition.x,i=this._viewportPosition.x+(this._colView.length-1),s=[],l=t[0].x;l<=t[1].x;l++)l<o||l>i||s.push(l);var n=s.length?s[0]:0,r=s.length?ve.call(this):0;for(l=this._viewportPosition.x;l<n;l++)r+=this.getColFromStore(this._colList[l]).width;for(var h=0,c=0;c<s.length;c++)h+=this.getColFromStore(this._colList[s[c]]).width;h-=Math.max(0,r+h-this._wholeViewportWidth);var d={left:!0,right:!0};return(t[0].x<o||t[0].x>i)&&(d.left=!1),(t[1].x>i||t[1].x<o)&&(d.right=!1),h>0&&(h+=1),{offset:r,size:h,bordersInViewport:d}}function At(e){var t=Rt(e);if(null==t)return null;for(var o=this._viewportPosition.y,i=this._viewportPosition.y+(this._rowView.length-1),s=[],l=t[0].y;l<=t[1].y;l++)l<o||l>i||s.push(l);var n=s.length?s[0]:0,r=s.length?fe.call(this):0;for(l=this._viewportPosition.y;l<n;l++)r+=this._actualRowHeight;for(var h=0,c=0;c<s.length;c++)h+=this._actualRowHeight;h-=Math.max(0,r+h-this._wholeViewportHeight);var d={top:!0,bottom:!0};return(t[0].y<o||t[0].y>i)&&(d.top=!1),(t[1].y>i||t[1].y<o)&&(d.bottom=!1),h>0&&(h+=1),{offset:r,size:h,bordersInViewport:d}}function It(e,t){var o=e._borderStyle||"solid",i=Rt.call(this,t);if(null!=i){"_hidden"in e&&e._hidden?e.style.opacity=0:e.style.opacity=e._opacity||"";var s=Mt.call(this,i),l=At.call(this,i);l.bordersInViewport.top&&0!=s.size?e.style["border-top-style"]=o:e.style["border-top-style"]="none",l.bordersInViewport.bottom&&0!=s.size?e.style["border-bottom-style"]=o:e.style["border-bottom-style"]="none",s.bordersInViewport.left&&0!=l.size?e.style["border-left-style"]=o:e.style["border-left-style"]="none",s.bordersInViewport.right&&0!=l.size?e.style["border-right-style"]=o:e.style["border-right-style"]="none",e!=this._domNodes.copyRangeNode&&e!=this._domNodes.cutRangeNode||(s.size+=2,l.size+=2,s.offset-=1,l.offset-=1);var n="translate("+s.offset+"px,"+l.offset+"px)";e.style.transform=n,e.style.width=s.size+"px",e.style.height=l.size+"px"}else e.style.opacity=0}function zt(e,t){"cut"==e?(this._cutRange=t,this._copyRange=null):"copy"==e?(this._copyRange=t,this._cutRange=null):"fill"==e&&(this._fillRange=t),requestAnimationFrame(()=>{It.call(this,this._domNodes.copyRangeNode,Rt(this._copyRange)),It.call(this,this._domNodes.cutRangeNode,Rt(this._cutRange)),It.call(this,this._domNodes.fillRangeNode,Rt(this._fillRange))})}function Et(e={},t=null){if(kt(e,{text:this.getCellRangeText(this.getCellSelection()),cellRange:this.getCellSelection()}),this.events.dispatch("beforecopy",e)){if(null!=this.constructor._clipboardObject&&zt.call(this.constructor._clipboardObject.instance,this.constructor._clipboardObject.type,null),zt.call(this,"copy",e.cellRange),Lt.call(this)&&"\n"==e.text)var o=!0;else o=!1;this.constructor._clipboardObject={type:"copy",text:e.text,cellRange:e.cellRange,isSingleEmptyCell:o,instance:this},Pt.call(this,t,e.text),this.events.dispatch("copy",e)}}function Vt(e={},t=null){if(kt(e,{text:this.getCellRangeText(this.getCellSelection()),cellRange:this.getCellSelection()}),this.events.dispatch("beforecut",e)){if(null!=this.constructor._clipboardObject&&zt.call(this.constructor._clipboardObject.instance,this.constructor._clipboardObject.type,null),this.delayedCut){if(zt.call(this,"cut",e.cellRange),Lt.call(this)&&"\n"==e.text)var o=!0;else o=!1;this.constructor._clipboardObject={type:"cut",text:e.text,cellRange:e.cellRange,isSingleEmptyCell:o,instance:this}}else this.clearCellValues(e.cellRange);Pt.call(this,t,e.text),this.events.dispatch("cut",e)}}function Ot(e){e.preventDefault(),"cut"==this._domNodes.clipboardNode._actualCommand?Vt.call(this,{},e):"copy"==this._domNodes.clipboardNode._actualCommand?Et.call(this,{},e):null==this._domNodes.clipboardNode._actualCommand&&this.allowCopy&&Et.call(this,{},e),this._domNodes.clipboardNode._actualCommand=void 0,this.disableClipboardInteraction()}function Dt(e){e.preventDefault(),this.allowCut&&Vt.call(this,{},e),this.disableClipboardInteraction()}function Ft(e){this._domNodes.clipboardNode.blur()}function Kt(e){var t=[this.keys._actionKeys.left,this.keys._actionKeys.right,this.keys._actionKeys.up,this.keys._actionKeys.down],o=e.keyCode||e.which;t.indexOf(o)>-1&&e.preventDefault()}function Bt(e){var t=null;return e.y>=this._componentHeight-xe.call(this)&&(t={}),t}function Wt(e){var t=null;return e.x>=this._componentWidth-xe.call(this)&&(t={}),t}function Gt(e,t){for(var o={x:this._viewportPosition.x,y:this._viewportPosition.y},i=0,s=0,l=o.x;s<e&&!(l>this._colList.length-1);)s+=this.getColFromStore(this._colList[l]).width,l++;for(var n=i,r=o.y;n<t&&!(r>this._rowList.length-1);)n+=this._actualRowHeight,r++;return{x:l-1,y:r-1}}function Xt(e){var t=null;return e.y>fe.call(this)&&e.x>ve.call(this)&&(t={cellCoords:Gt.call(this,e.x-ve.call(this),e.y-fe.call(this))}),t}function Yt(e){var t=null;return e.x<ve.call(this)||e.y>fe.call(this)?t:t={coord:Gt.call(this,e.x-ve.call(this),e.y-fe.call(this)).x}}function Ut(e){var t=null;if(e.y<0||e.y>fe.call(this))return t;for(var o=ve.call(this),i=this._viewportPosition.x;i<=this._viewportPosition.x+(this._colView.length-1);i++)if(o+=this.getColFromStore(this._colList[i]).width,e.x<=o){e.x>=o-5&&(t={coord:i,positionX:o-4});break}return t}function jt(e,t){var o=Rt(t);return null!=e&&null!=o&&(A(e)&&I(o)?e.x>=o[0].x&&e.x<=o[1].x&&e.y>=o[0].y&&e.y<=o[1].y:z(e)&&R(o)?e>=o[0]&&e<=o[1]:void 0)}function qt(e){var t=null;if(e.x<ve.call(this)||e.y>fe.call(this))return t;var o=Gt.call(this,e.x-ve.call(this),e.y-fe.call(this));return jt(o.x,this.getColSelection())&&(t={coord:o.x}),t}function Zt(e){var t=null;return e.y<fe.call(this)||e.x>ve.call(this)?t:t={coord:Gt.call(this,e.x-ve.call(this),e.y-fe.call(this)).y}}function Jt(e){var t=null;if(e.y<fe.call(this)||e.x>ve.call(this))return t;var o=Gt.call(this,e.x-ve.call(this),e.y-fe.call(this));return jt(o.y,this.getRowSelection())&&(t={coord:o.y}),t}function Qt(e){var t=null;return e.x<ve.call(this)&&e.y<fe.call(this)&&(t={}),t}function $t(e=null,t="document"){return null==e?null:{x:tt.call(this,e.x,t),y:$e.call(this,e.y,t)}}function eo(e){var t=null,o=this.getNormalizedCellSelection();if(null==o||this._domNodes.fillHandleNode._hidden)return t;var i=$t.call(this,o[1],"viewport"),s=this.getColFromStore(this._colList[o[1].x]).width,l=this._actualRowHeight;return e.x>i.x+s-6&&e.x<i.x+s+6&&e.y>i.y+l-6&&e.y<i.y+l+6&&(t={cellCoords:{x:o[1].x,y:o[1].y}}),t}function to(e=null,t="mouse"){if(null==e)return null;var o,i,s,l,n,r,h,c,d,a,u=null;return(o=Bt.call(this,e))?u={name:"horizontalScrollbar",properties:o}:(i=Wt.call(this,e))?u={name:"verticalScrollbar",properties:i}:(s=Qt.call(this,e))?u={name:"headerJoint",properties:s}:"touch"!=t&&this.allowColResize&&(l=Ut.call(this,e))?u={name:"colHeaderEdge",properties:l}:this.allowColMove&&(n=qt.call(this,e))?u={name:"selectedColHeader",properties:n}:(r=Yt.call(this,e))?u={name:"colHeader",properties:r}:this.allowRowMove&&(h=Jt.call(this,e))?u={name:"selectedRowHeader",properties:h}:(c=Zt.call(this,e))?u={name:"rowHeader",properties:c}:this.allowCellFill&&(d=eo.call(this,e))?u={name:"fillHandle",properties:d}:(a=Xt.call(this,e))&&(u={name:"cell",properties:a}),null!=u&&(u.properties.pointerPositionPx=e,u.properties.pointerPosition=Gt.call(this,e.x-ve.call(this),e.y-fe.call(this))),u}function oo(e=null){if(null==e)return this._domNodes.eventAreaNode.style.cursor="",void(this._domNodes.eventAreaNode._cursorState=null);e in T&&this._domNodes.eventAreaNode._cursorState!=T[e]&&(this._domNodes.eventAreaNode.style.cursor=T[e],this._domNodes.eventAreaNode._cursorState=T[e])}function io(e){F(this._domNodes.colResizeHintNode,{transform:"translateX("+e+"px)",opacity:this._domNodes.colResizeHintNode._opacity}),this._domNodes.colResizeHintNode._isHidden=!1}function so(){this._domNodes.colResizeHintNode.style.opacity=0,this._domNodes.colResizeHintNode._isHidden=!0}function lo(e=null){null==e&&(e=this._pointerPositionPx);var t,o=to.call(this,e);null==o?(oo.call(this,null),t=null):(oo.call(this,o.name),t=o.name),t!=this._hoverArea&&(null!=this._hoverArea&&this._domNodes.componentNode.classList.remove("dgxl-hover-"+this._hoverArea),null!=t&&this._domNodes.componentNode.classList.add("dgxl-hover-"+t),"colHeaderEdge"==this._hoverArea&&requestAnimationFrame(()=>{so.call(this)}),"colHeaderEdge"==t&&requestAnimationFrame(()=>{io.call(this,o.properties.positionX)}),this._hoverArea=t)}function no(e,t,o="xy"){var i=Rt.call(this,t);if(null!=i){var s;"_hidden"in e&&e._hidden||e==this._domNodes.cellSelectionNode&&(null!=(s=t)&&s[0].x==s[1].x&&s[0].y==s[1].y)?e.style.opacity=0:e.style.opacity=e._opacity||"",I(i)||(i=[{x:i[0],y:i[0]},{x:i[1],y:i[1]}]);var l=Mt.call(this,i),n=At.call(this,i),r="",h="";"xy"==o?(r="translate("+l.offset+"px,"+n.offset+"px)",h="scale("+l.size/100+", "+n.size/100+")"):"x"==o?(r="translateX("+l.offset+"px)",h="scaleX("+l.size/100+")"):"y"==o&&(r="translateY("+n.offset+"px)",h="scaleY("+n.size/100+")"),e.style.transform=r+" "+h}else e.style.opacity=0}function ro(e){null!=e&&(e=[e,e]),this._domNodes.cellCursorNode._hidden?this._domNodes.cellCursorNode.style.opacity=0:this._domNodes.cellCursorNode.style.opacity=this._domNodes.cellCursorNode._opacity,It.call(this,this._domNodes.cellCursorNode,e)}function ho(e){var t=!1;return e>=this._viewportPosition.x&&e<=this._viewportPosition.x+(this._colView.length-1)&&(t=!0),t}function co(e){var t=!1;return e>=this._viewportPosition.y&&e<=this._viewportPosition.y+(this._rowView.length-1)&&(t=!0),t}function ao(e){var t=ho.call(this,e.x),o=co.call(this,e.y);return!(!t||!o)}function uo(e){if(this.allowCellFill)if(null!=e){var t=$t.call(this,e[1],"viewport"),o=this.getColFromStore(this._colList[e[1].x]).width,i=this._actualRowHeight,s=t.x+o-7;this._domNodes.fillHandleNode.style.transform="translate("+s+"px, "+(t.y+i-7)+"px)",!ao.call(this,e[1])||this._domNodes.fillHandleNode._hidden?this._domNodes.fillHandleNode.style.opacity=0:this._domNodes.fillHandleNode.style.opacity=this._domNodes.fillHandleNode._opacity}else this._domNodes.fillHandleNode.style.opacity=0}function _o(){var e=this._domNodes.selectionHeadHandleTouchNode,t=this._domNodes.selectionTailHandleTouchNode,o=this.getNormalizedColSelection();if(null==o){var i=this.getNormalizedRowSelection();if(null==i){var s=this.getNormalizedCellSelection();null==s?(this._domNodes.selectionHeadHandleTouchNode.style.opacity=0,this._domNodes.selectionTailHandleTouchNode.style.opacity=0):go.call(this,e,t,s)}else mo.call(this,e,t,i)}else po.call(this,e,t,o)}const po=function(e,t,o){var i=tt.call(this,o[0],"viewport"),s=tt.call(this,o[1],"viewport")+this.getColFromStore(this._colList[o[1]]).width,l=fe.call(this)+Math.min(this._outerDocumentHeight,this._outerViewportHeight)/2-Math.floor(12),n=i-Math.floor(12),r=l,h=s-Math.floor(12),c=l;e._hidden=n<=-24,h>=this._wholeViewportWidth?t._hidden=!0:t._hidden=!1,e.style.transform="translate("+n+"px, "+r+"px)",t.style.transform="translate("+h+"px, "+c+"px)",ho.call(this,o[0])&&!e._hidden?e.style.opacity=e._opacity:e.style.opacity=0,ho.call(this,o[1])&&!t._hidden?t.style.opacity=this._domNodes.selectionTailHandleTouchNode._opacity:t.style.opacity=0},mo=function(e,t,o){var i=$e.call(this,o[0],"viewport"),s=$e.call(this,o[1],"viewport")+this.rowHeight,l=ve.call(this)+Math.min(this._outerDocumentWidth,this._outerViewportWidth)/2-Math.floor(12),n=l,r=i-Math.floor(12),h=l,c=s-Math.floor(12);e._hidden=r<=-24,c>=this._wholeViewportHeight?t._hidden=!0:t._hidden=!1,e.style.transform="translate("+n+"px, "+r+"px)",t.style.transform="translate("+h+"px, "+c+"px)",co.call(this,o[0])&&!e._hidden?e.style.opacity=e._opacity:e.style.opacity=0,co.call(this,o[1])&&!t._hidden?t.style.opacity=t._opacity:t.style.opacity=0},go=function(e,t,o){var i=$t.call(this,o[0],"viewport"),s=$t.call(this,o[1],"viewport"),l=this.getColFromStore(this._colList[o[1].x]).width,n=this.rowHeight,r=i.x-Math.floor(12),h=i.y-Math.floor(12),c=s.x+l-Math.floor(12),d=s.y+n-Math.floor(12);if(e.style.transform="translate("+r+"px, "+h+"px)",t.style.transform="translate("+c+"px, "+d+"px)",c>this._wholeViewportWidth||d>this._wholeViewportHeight)return t.style.transform="translate(0px, 0px)",void(t.style.opacity=0);ao.call(this,o[0])?e.style.opacity=this._domNodes.selectionHeadHandleTouchNode._opacity:e.style.opacity=0,ao.call(this,o[1])?t.style.opacity=this._domNodes.selectionTailHandleTouchNode._opacity:t.style.opacity=0};function fo(){if(this.allowColResize){var e=this._isTouchDevice?1:0,t=this.getNormalizedColSelection();if(null!=t){var o=tt.call(this,t[1],"viewport")+this.getColFromStore(this._colList[t[1]]).width-Math.floor(12),i=fe.call(this)-Math.floor(12);o>=this._wholeViewportWidth?this._domNodes.colResizeHandleTouchNode._hidden=!0:this._domNodes.colResizeHandleTouchNode._hidden=!1,this._domNodes.colResizeHandleTouchNode.style.transform="translate("+o+"px, "+i+"px)",ho.call(this,t[1])&&!this._domNodes.colResizeHandleTouchNode._hidden?this._domNodes.colResizeHandleTouchNode.style.opacity=e:this._domNodes.colResizeHandleTouchNode.style.opacity=0}else this._domNodes.colResizeHandleTouchNode.style.opacity=0}}function vo(e,t,o){for(var i=0;i<e.length;i++)if(e[i][t]==o)return i;return-1}function xo(){for(var e=[],t=0;t<this._colLines.length;t++)e.push(t);var o=ve.call(this),i=[];for(t=0;t<this._colView.length;t++){o+=this.getColFromStore(this._colView[t]).width;var s=vo(this._colLines,"position",o);s>-1?e.splice(e.indexOf(s),1):i.push(o)}for(t=0;t<i.length&&e.length;t++){var l=e.shift();this._colLines[l].node.style.transform="translateX("+i[t]+"px)",this._colLines[l].position=i[t]}for(t=0;t<e.length;t++)this._colLines[e[t]].position>this._wholeViewportWidth||(this._colLines[e[t]].node.style.transform="translateX("+(this._wholeViewportWidth+100)+"px)",this._colLines[e[t]].position=this._wholeViewportWidth+100)}function yo(){if(this._lastColView.startIndex>this._viewportPosition.x)this._domNodes.blankSheetRightNode.style.opacity=0;else{var e=this._viewportPosition.x+(this._colView.length-1),t=tt.call(this,e,"viewport");t+=this.getColFromStore(this._colList[e]).width,t+=1,this._domNodes.blankSheetRightNode.style.transform="scaleX("+(this._componentWidth-t)/100+")",this._domNodes.blankSheetRightNode.style.opacity=this._domNodes.blankSheetRightNode._opacity}if(this._lastRowView.startIndex>this._viewportPosition.y)this._domNodes.blankSheetBottomNode.style.opacity=0;else{var o=this._viewportPosition.y+(this._rowView.length-1),i=$e.call(this,o,"viewport");i+=this._actualRowHeight,i+=1,this._domNodes.blankSheetBottomNode.style.transform="scaleY("+(this._componentHeight-i)/100+")",this._domNodes.blankSheetBottomNode.style.opacity=this._domNodes.blankSheetBottomNode._opacity}}function No(){var e=this.getColFromStore(this._colList[this._cellCursorPosition.x]).width,t=this._textWidthMeterCanvasContext.measureText(this._domNodes.valueEditorNode.value).width+2*this.cellPadding;this._domNodes.valueEditorNode.style.width=Math.max(t,e)+1+"px"}function wo(){if(null!=this.getCellCursorPosition()){var e=$t.call(this,this._cellCursorPosition,"viewport");this._domNodes.valueEditorNode.style.left=e.x+"px",this._domNodes.valueEditorNode.style.top=e.y+"px",No.call(this)}}function Co(){if(this.showRowHeaders){for(var e="",t=!1,o=this.getNormalizedRowSelection(),i=0;i<this._rowView.length;i++){var s=this._viewportPosition.y+i,l=this._rowView[i],n=this._rowStore[l-1];if(null!=o&&s>=o[0]&&s<=o[1]&&!t){var r='<span class="dgxl-selectedRowRange" style="color:'+(this.getThemeSetting("rowHeaderSelectedTextColor")||this.getThemeSetting("rowHeaderTextColor"))+";font-weight:"+(this.boldSelectedHeaders?"bolder":"normal")+';">';t=!0}else r="";var h=Ee.call(this,s);r+=this.rowHeaderLabelFunction.call(this,s,l,n.field,n.title,h),null!=this._rowSelection&&s==o[1]&&t&&(r+="</span>"),e+=r+"\n"}this._domNodes.cellValuesNode.children[0].lastChild.innerHTML=e}}function bo(){for(var e=B(),t=ve.call(this),o=0;o<this._colView.length;o++){var i=this._colStore[this._colView[o]-1].node;if(null!=i){for(var s="",l=0;l<this._rowView.length;l++){var n=this.getCellFromStore(this._rowView[l],this._colView[o]).value;s+=null==n?"\n":n+"\n"}null!=i.lastChild.firstChild&&(i.lastChild.firstChild.data=s),i.style.transform="translateX("+t+"px)",i.style.opacity=1,e.appendChild(i),t+=this._colStore[this._colView[o]-1].width}}this._domNodes.cellValuesNode.insertBefore(e,this._domNodes.cellValuesNode.children[+this.showRowHeaders]);for(var r=+this.showRowHeaders;r<this._domNodes.cellValuesNode.children.length;r++){var h=this._domNodes.cellValuesNode.children[r]._colId;this._colView.indexOf(h)>-1||(this._domNodes.cellValuesNode.children[r].style.opacity=0)}}function So(){Le.call(this),this._currentDragAction||this._isTouchDevice||lo.call(this),Be.call(this),no.call(this,this._domNodes.colHeaderHighlightNode,this.getCellSelection(),"x"),no.call(this,this._domNodes.colHeaderSelectedNode,this.getColSelection(),"x"),no.call(this,this._domNodes.rowHeaderHighlightNode,this.getCellSelection(),"y"),no.call(this,this._domNodes.rowHeaderSelectedNode,this.getRowSelection(),"y"),no.call(this,this._domNodes.cellSelectionNode,this.getCellSelection()),It.call(this,this._domNodes.cellSelectionBorderNode,this.getCellSelection()),ro.call(this,this.getCellCursorPosition()),uo.call(this,this.getNormalizedCellSelection()),_o.call(this),fo.call(this),It.call(this,this._domNodes.copyRangeNode,this._copyRange),It.call(this,this._domNodes.cutRangeNode,this._cutRange),It.call(this,this._domNodes.fillRangeNode,this._fillRange),xo.call(this),yo.call(this),this._isEditorOpen&&wo.call(this),Co.call(this),bo.call(this)}function Ho(){var e=So.bind(this);requestAnimationFrame(e)}function To(e,t){R(t)&&!M(t)&&(t=t[0]);for(var o=Rt(e),i=[],s=0;s<=o[1].y-o[0].y;s++){i.push([]);for(var l=0;l<=o[1].x-o[0].x;l++)i[s].push(t)}return i}function Lo(e){var t=!1;return(null==e||A(e)&&"x"in e&&"y"in e)&&(t=!0),t}function Po(e){const t=function(e){var t=!1;return(null==e||A(e)&&"x"in e&&"y"in e)&&(t=!0),t};var o=!1;return(null==e||R(e)&&2==e.length&&t(e[0])&&t(e[1]))&&(o=!0),o}function ko(e,t="document"){if(null==e)return null;var o={x:e.x,y:e.y};if("document"==t)var i=Mo.call(this);else if("viewport"==t)i=Ro.call(this);else if("cellSelection"==t){var s=this.getNormalizedCellSelection();if(null!=s)i=Ao.call(this,s);else i=Mo.call(this,s)}var l=o.y<i.top,n=o.x>i.right,r=o.y>i.bottom,h=o.x<i.left;return l&&(o.y=i.top),h&&(o.x=i.left),n&&(o.x=i.right),r&&(o.y=i.bottom),o}const Ro=function(){return{top:this._viewportPosition.y,right:this._viewportPosition.x+(this._colView.length-1),bottom:this._viewportPosition.y+(this._rowView.length-1),left:this._viewportPosition.x}},Mo=function(){return{top:0,right:this._colList.length-1,bottom:this._rowList.length-1,left:0}},Ao=function(e){var t=Rt(e);return{top:t[0].y,right:t[1].x,bottom:t[1].y,left:t[0].x}};function Io(e,t="document"){return null==e?null:[ko.call(this,{x:e[0].x,y:e[0].y},t),ko.call(this,{x:e[1].x,y:e[1].y},t)]}function zo(e,t=null,o=!1,i=null){var s=[],l=[],n=[],r=Rt(e),h=[],c=[],d=Math.min(r[0].y+(t.length-1),this._rowList.length-1),a=Math.min(r[0].x+(t[0].length-1),this._colList.length-1);if(!o&&d>r[1].y)d=r[1].y;if(!o&&a>r[1].x)a=r[1].x;for(var u=r[0].y;u<=d;u++)c.push(this._rowList[u]);for(var _=r[0].x;_<=a;_++)h.push(this._colList[_]);if(null==i)l=c,s=h,n=t;else{var p=Rt(i),m=[],g=[];for(_=p[0].x;_<=p[1].x;_++)m.push(this._colList[_]);for(u=p[0].y;u<=p[1].y;u++)g.push(this._rowList[u]);if(r[0].y<p[0].y)var f=c,v=g;else f=g,v=c;for(var x,y=0;y<f.length;y++)l.push(f[y]);for(y=0;y<v.length;y++)l.indexOf(v[y])>-1?null==x&&(x=l.indexOf(v[y])):(l.push(v[y]),null==x&&(x=l.length-1));if(r[0].x<p[0].x)var N=h,w=m;else N=m,w=h;var C;for(y=0;y<N.length;y++)s.push(N[y]);for(y=0;y<w.length;y++)s.indexOf(w[y])>-1?null==C&&(C=s.indexOf(w[y])):(s.push(w[y]),null==C&&(C=s.length-1));var b=[{x:N==h?0:C,y:f==c?0:x}];b.push({x:b[0].x+(h.length-1),y:b[0].y+(c.length-1)});var S=[{x:N==m?0:C,y:f==g?0:x}];S.push({x:S[0].x+(m.length-1),y:S[0].y+(g.length-1)}),n=[];for(y=0;y<l.length;y++){n.push([]);for(var H=0;H<s.length;H++){if(y>=b[0].y&&y<=b[1].y&&H>=b[0].x&&H<=b[1].x)var T=t[y-b[0].y][H-b[0].x];else if(y>=S[0].y&&y<=S[1].y&&H>=S[0].x&&H<=S[1].x)T=null;else T=void 0;n[y].push(T)}}}return{rowIds:l,colIds:s,values:n,rowIdsToSelect:c,colIdsToSelect:h}}function Eo(e,t,o,i="do"){for(var s=0;s<e.length;s++)for(var l=0;l<t.length;l++)void 0!==o[s][l]&&(this._cellStore[e[s]-1][t[l]-1].value=o[s][l]);Ho.call(this)}function Vo(e){if(null==e)return[];for(var t=Rt(e),o=[],i=t[0];i<=t[1];i++)o.push(this._colList[i]);return o}function Oo(e){if(null==e)return[];for(var t=Rt(e),o=[],i=t[0];i<=t[1];i++)o.push(this._rowList[i]);return o}function Do(){if(null!=this.getColSelection())var e={type:"col",range:this.getColSelection(),cellRange:this.getCellSelection(),cellCursorPosition:this.getCellCursorPosition(),colIds:Vo.call(this,this.getColSelection()),rowIds:null};else if(null!=this.getRowSelection())e={type:"row",range:this.getRowSelection(),cellRange:this.getCellSelection(),cellCursorPosition:this.getCellCursorPosition(),colIds:null,rowIds:Oo.call(this,this.getRowSelection())};else{var t=this.getCellSelection();if(null==t)var o=[],i=[];else o=Vo.call(this,[this.getCellSelection()[0].x,this.getCellSelection()[1].x]),i=Oo.call(this,[this.getCellSelection()[0].y,this.getCellSelection()[1].y]);e={type:"cell",range:t,cellRange:t,cellCursorPosition:this.getCellCursorPosition(),colIds:o,rowIds:i}}return e}function Fo(e,t){return null==e&&null==t||null!=e&&null!=t&&(A(e)&&A(t)?e.x==t.x&&e.y==t.y:!(!z(e)||!z(t))&&e==t)}function Ko(e,t){return null==e&&null==t||null!=e&&null!=t&&!(!Fo(e[0],t[0])||!Fo(e[1],t[1]))}function Bo(e=null){if(this.showColHeaders){if(void 0!==this._prevSelection&&"col"==this._prevSelection.type)for(var t=0;t<this._prevSelection.colIds.length;t++){(i=this.getColFromStore(this._prevSelection.colIds[t]).node).firstChild.firstChild.style.color=this.getThemeSetting("colHeaderTextColor"),i.firstChild.firstChild.style.fontWeight="normal",i.classList.remove("dgxl-selectedColumn")}if(e&&"col"==e){var o=this.getNormalizedColSelection();for(t=o[0];t<=o[1];t++){var i;(i=this.getColFromStore(this._colList[t]).node).firstChild.firstChild.style.color=this.getThemeSetting("colHeaderSelectedTextColor"),i.firstChild.firstChild.style.fontWeight=this.boldSelectedHeaders?"bolder":"normal",i.classList.add("dgxl-selectedColumn")}}}}function Wo(e){if(e in this._keyActionSets&&e!=this._activeKeyActionSet){if(this._activeKeyActionSet)for(var t=0;t<this._keyActionSets[this._activeKeyActionSet].length;t++){var o=this._keyActionSets[this._activeKeyActionSet][t],i=this._keyActionPresets[o];this._keyActionSets[e].indexOf(o)>-1||this.keys.off(i.keys,i.action,i.repeat)}for(t=0;t<this._keyActionSets[e].length;t++){o=this._keyActionSets[e][t],i=this._keyActionPresets[o];null!=this._activeKeyActionSet&&this._keyActionSets[this._activeKeyActionSet].indexOf(o)>-1||("active"in i&&!i.active.call(this)||this.keys.on(i.keys,i.action,i.repeat))}"traverseSingleCell"==e||"traverseMultiCell"==e?"cellSelect"!=this._currentDragAction&&(this._domNodes.fillHandleNode._hidden=!1):this._domNodes.fillHandleNode._hidden=!0,requestAnimationFrame(()=>{uo.call(this,this.getNormalizedCellSelection())}),this._activeKeyActionSet=e}}function Go(e=!1){this._isIOS||(e?Xo.call(this,this._domNodes.clipboardNode):setTimeout(()=>{Xo.call(this,this._domNodes.clipboardNode)},0))}const Xo=function(e){e.value="  all",e.focus(),e.setSelectionRange(0," ".length)};function Yo(e,t="xy"){if(null==e)return{x:0,y:0};var o=this._viewportPosition.x+(this._colView.length-1);this._colViewOverflow>0&&(o-=1);var i=this._viewportPosition.y+(this._rowView.length-1);if(this._rowViewOverflow>0&&(i-=1),e.x<this._viewportPosition.x)var s=e.x-this._viewportPosition.x;else if(e.x>o)s=e.x-o;if(e.y<this._viewportPosition.y)var l=e.y-this._viewportPosition.y;else if(e.y>i)l=e.y-i;return{x:("xy"==t||"x"==t)&&s||0,y:("xy"==t||"y"==t)&&l||0}}function Uo(e=null,t=null,o=!0,i="cell"){if(Po.call(this,e)&&Lo.call(this,t)){this._isEditorOpen&&this.closeEditorAndSave(),this.constructor.contextMenuTouch.isOpen()&&this.constructor.contextMenuTouch.close();var s=!0;if(null!=e){s=!1;var l=ko.call(this,e[0],"document"),n=ko.call(this,e[1],"document");"col"==i?(this._colSelection=[l.x,n.x],this._rowSelection=null):"row"==i?(this._colSelection=null,this._rowSelection=[l.y,n.y]):(this._colSelection=null,this._rowSelection=null),e=[l,n],this._cellSelection=e,null==t&&null==this._cellCursorPosition?this._cellCursorPosition={x:l.x,y:l.y}:this._cellCursorPosition=ko.call(this,t||this._cellCursorPosition,"cellSelection")}else null!=t&&jt(t,this._cellSelection)&&(this._cellCursorPosition={x:t.x,y:t.y});this.activate();var r=Yo.call(this,this._cellCursorPosition);!o||0==r.x&&0==r.y?requestAnimationFrame(()=>{So.call(this)}):this.moveViewportPosition(r),this.showColHeaders&&!s&&Bo.call(this,i),Lt.call(this)?Wo.call(this,"traverseSingleCell"):Wo.call(this,"traverseMultiCell"),this._domNodes.componentNode._touchStartFired||Go.call(this);var h=this.getCellCursorPosition(),c=this.getCellSelection();this._prevSelection&&Ko(this._prevSelection.cellRange,c)||this.events.dispatch("cellselectionchange",{cellSelection:c}),this._prevSelection&&Fo(this._prevSelection.cellCursorPosition,h)||this.events.dispatch("cellcursorpositionchange",{cellCursorPosition:h}),this._prevSelection=Do.call(this)}}function jo(e){if(null!=e){if("row"==e.type)var t=[{x:0,y:e.range[0]},{x:this._colList.length-1,y:e.range[1]}];else if("col"==e.type)t=[{x:e.range[0],y:0},{x:e.range[1],y:this._rowList.length-1}];else t=e.range;Uo.call(this,t,e.cellCursorPosition,!0,e.type)}}function qo(){null!=this.constructor._clipboardObject&&zt.call(this.constructor._clipboardObject.instance,this.constructor._clipboardObject.type,null)}function Zo(e,t,o,i=!0,s=null){var l,n=Do.call(this),r=[];const h=function(e,t,o,i=null,s=null){if(!this.events.dispatch("beforecellvaluechange",{rowIds:e,colIds:t,changes:o}))return;qo.call(this),null!=i&&i.call(this),null!=s&&(l=Do.call(this));var n=0;var h=function(){var i=performance.now(),l=[],c=t,d=[];if(null!=s)do{l.push(e[n]),d.push(o[n]);for(var a=[],u=0;u<c.length;u++)a.push(this._cellStore[e[n]-1][c[u]-1].value||null);r.push(a),n++}while(n<=e.length-1&&performance.now()-i<25);else do{l.push(e[n]),d.push(o[n]),n++}while(n<=e.length-1&&performance.now()-i<25);Eo.call(this,l,c,d),n<e.length-1?setTimeout(h,75):(this.events.dispatch("cellvaluechange",{rowIds:e,colIds:t,changes:o}),null!=s&&s.call(this))}.bind(this);h()};if(i)var c=function(){this.undoManager.add({desc:"setCellValues",undo:function(){h.call(this,e,t,r,(function(){jo.call(this,n)}))},redo:function(){h.call(this,e,t,o,(function(){jo.call(this,l)}))}})};else c=null;h.call(this,e,t,o,s,c)}function Jo(e=null,t=null,o=!1,i=!1,s=!1){if(null!=e&&(Lo(e)&&(e=[{x:e.x,y:e.y},{x:e.x,y:e.y}]),Po(e)))if(e=Io.call(this,e),M(t)||(t=To(e,t)),s&&null!=this._cutRange){l=zo.call(this,e,t,o,this._cutRange),n=i?function(){var e=[{x:this._colList.indexOf(l.colIdsToSelect[0]),y:this._rowList.indexOf(l.rowIdsToSelect[0])},{x:this._colList.indexOf(l.colIdsToSelect[l.colIdsToSelect.length-1]),y:this._rowList.indexOf(l.rowIdsToSelect[l.rowIdsToSelect.length-1])}];this.selectCells(e)}:null;Zo.call(this,l.rowIds,l.colIds,l.values,!0,n)}else{var l=zo.call(this,e,t,o),n=i?function(){var e=[{x:this._colList.indexOf(l.colIds[0]),y:this._rowList.indexOf(l.rowIds[0])},{x:this._colList.indexOf(l.colIds[l.colIds.length-1]),y:this._rowList.indexOf(l.rowIds[l.rowIds.length-1])}];this.selectCells(e)}:null;Zo.call(this,l.rowIds,l.colIds,l.values,!0,n)}}function Qo(e={},t=null){if(""!=e.text&&this.events.dispatch("beforepaste",e)){var o=e.text;null!=this.constructor._clipboardObject&&"\n"==e.text&&this.constructor._clipboardObject.isSingleEmptyCell&&(o="");var i=function(e){for(var t=0,o=[],i=e.split("\n"),s=0;s<i.length;s++){o.push([]);var l=i[s].split("\t");l.length>t&&(t=l.length);for(var n=0;n<l.length;n++){var r=l[n];r=""==r?null:String(r).replace(/[\n\r\t]/g," "),o[s].push(r)}}for(s=0;s<o.length;s++)if(o[s].length<t)for(;o[s].length<t;)o[s].push(null);return o}(o);if(null!=this.constructor._clipboardObject&&this.constructor._clipboardObject.instance==this&&"cut"==this.constructor._clipboardObject.type&&o==this.constructor._clipboardObject.text)var s=!0;else s=!1;Jo.call(this,this.getCellSelection(),i,!0,!0,s),this.events.dispatch("paste",e)}}function $o(e){e.preventDefault(),this.allowPaste&&ei.call(this,e),this.disableClipboardInteraction()}const ei=function(e){if(this._isIE)var t=window.clipboardData.getData("text");else t=e.clipboardData.getData("text");Qo.call(this,{text:t},e)};function ti(e){e.target.selectionEnd==e.target.value.length&&this.selectAll(!1),this.disableClipboardInteraction()}function oi(e,t){if(e in this._domNodes.componentNode._listeners&&t in this._domNodes.componentNode._listeners[e].events){var o=t.split("_");2==o.length&&"passive"==o[1]?this._domNodes.componentNode._listeners[e].node.removeEventListener(o[0],this._domNodes.componentNode._listeners[e].events[t],{passive:!0}):2==o.length&&"debounced"==o[1]?this._domNodes.componentNode._listeners[e].node.removeEventListener(o[0],this._domNodes.componentNode._listeners[e].events[t]):this._domNodes.componentNode._listeners[e].node.removeEventListener(t,this._domNodes.componentNode._listeners[e].events[t])}}function ii(e){oi.call(this,"document","mousedown"),this.deactivate()}function si(e){if(!(this._domNodes.containerNode.contains(e.target)||this.constructor._domNodes.contextMenuNode.contains(e.target)||this.constructor._domNodes.contextMenuTouchNode.contains(e.target))){for(var t=document.getElementsByClassName("dgxl-app"),o=0;o<t.length;o++)if(t[o].contains(e.target))return;ii.call(this,{originalEvent:e})}}function li(e){var t=[{x:this._cellCursorPosition.x||0,y:this._cellCursorPosition.y||0},{x:e.x,y:e.y}];this.selectCells(t,!1,!1)}var ni={start:function(e,t){},move:function(e,t){null!=this.getCellCursorPosition()&&(Fo(this.getCellSelection()[1],t.pointerPosition)||li.call(this,t.pointerPosition))},end:function(e,t){},prepare:function(e,t){},release:function(e,t){}};function ri(e){if(null==this._cellCursorPosition)var t=[0,e];else t=[this._cellCursorPosition.x,e];this.selectCols(t,!1,!1)}var hi={start:function(e,t){},move:function(e,t){null!=this.getColSelection()&&(Fo(this.getColSelection()[1],t.pointerPosition.x)||ri.call(this,t.pointerPosition.x))},end:function(e,t){},prepare:function(e,t){},release:function(e,t){}};function ci(e){if(null==this._cellCursorPosition)var t=[0,e];else t=[this._cellCursorPosition.y,e];this.selectRows(t,!1,!1)}var di={start:function(e,t){},move:function(e,t){null!=this.getRowSelection()&&(Fo(this.getRowSelection()[1],t.pointerPosition.y)||ci.call(this,t.pointerPosition.y))},end:function(e,t){},prepare:function(e,t){},release:function(e,t){}};function ai(e){var t=this.getNormalizedCellSelection(),o=0,i=0,s="",l="";if(e.y<t[0].y){var n=t[0].y-1;o=t[0].y-e.y,l="up"}else if(e.y>t[1].y){n=t[1].y+1;o=e.y-t[1].y,l="down"}if(e.x<t[0].x){var r=t[0].x-1;i=t[0].x-e.x,s="left"}else if(e.x>t[1].x){r=t[1].x+1;i=e.x-t[1].x,s="right"}if("xy"==this.cellFillDirection){if(0==i&&0==o)return zt.call(this,"fill",null),{dragDirection:void 0,dragAmount:void 0};if(o>=i)var h={x:t[0].x,y:n},c={x:t[1].x,y:e.y},d=l,a=o;else h={x:r,y:t[0].y},c={x:e.x,y:t[1].y},d=s,a=i}else if("y"==this.cellFillDirection){if(0==o)return zt.call(this,"fill",null),{dragDirection:void 0,dragAmount:void 0};h={x:t[0].x,y:n},c={x:t[1].x,y:e.y},d=l,a=o}else if("x"==this.cellFillDirection){if(0==i)return zt.call(this,"fill",null),{dragDirection:void 0,dragAmount:void 0};h={x:r,y:t[0].y},c={x:e.x,y:t[1].y},d=s,a=i}var u=[h,ko.call(this,c,"document")];return zt.call(this,"fill",u),{dragDirection:d,dragAmount:a}}var ui={start:function(e,t){},move:function(e,t){var o=ai.call(this,t.pointerPosition);t.dragDirection=o.dragDirection,t.dragAmount=o.dragAmount},end:function(e,t){null!=t.dragDirection&&null!=t.dragAmount&&this.fillCells(this.getCellSelection(),t.dragDirection,t.dragAmount)},prepare:function(e,t){},release:function(e,t){}};function _i(e){for(var t=Rt(e),o=0,i=t[0];i<=t[1];i++)o+=this._actualRowHeight;return o}function pi(e){this._domNodes.rowMoveGhostNode.style.transform="translateY("+e+"px)"}function mi(e){F(this._domNodes.rowMoveGhostNode,{width:Math.min(this._outerDocumentWidth,this._outerViewportWidth)+"px",height:_i.call(this,e)+"px",opacity:this._domNodes.rowMoveGhostNode._opacity}),pi.call(this,$e.call(this,e[0],"viewport"))}function gi(){this._domNodes.rowMoveGhostNode.style.opacity=0}function fi(e){if(e<this._rowList.length)var t=$e.call(this,e,"viewport");else{var o=this._rowList.length-1;t=$e.call(this,o,"viewport");t+=this._actualRowHeight}this._domNodes.rowMoveGuideNode.style.transform="translateY("+t+"px)"}function vi(e){F(this._domNodes.rowMoveGuideNode,{width:Math.min(this._outerDocumentWidth,this._outerViewportWidth)+"px",opacity:this._domNodes.rowMoveGuideNode._opacity}),fi.call(this,e[0])}function xi(){this._domNodes.rowMoveGuideNode.style.opacity=0}var yi={start:function(e,t){t.pointerOffset=this._pointerPositionPx.y-$e.call(this,this.getNormalizedRowSelection()[0],"viewport")},move:function(e,t){var o,i=t.pointerPositionPx.y-t.pointerOffset,s=$e.call(this,this._viewportPosition.y+this._rowView.length-1)+this._actualRowHeight,l=Math.min(this._componentHeight,s);i<fe.call(this)?i=fe.call(this):i+_i.call(this,this.getRowSelection())>l&&(i=l-_i.call(this,this.getRowSelection())),(o=jt(t.pointerPosition.y,this.getRowSelection())?this.getNormalizedRowSelection()[0]:t.pointerPosition.y<this.getNormalizedRowSelection()[0]?t.pointerPosition.y:t.pointerPosition.y+1)<0&&(o=0),t.endCoord=o||0,requestAnimationFrame(()=>{pi.call(this,i),fi.call(this,o)})},end:function(e,t){this.moveRows(this.getNormalizedRowSelection(),t.endCoord)},prepare:function(e,t){requestAnimationFrame(()=>{mi.call(this,this.getNormalizedRowSelection()),vi.call(this,this.getNormalizedRowSelection())})},release:function(e,t){requestAnimationFrame(()=>{xi.call(this),gi.call(this)})}};function Ni(e){for(var t=Rt(e),o=0,i=t[0];i<=t[1];i++)o+=this.getColFromStore(this._colList[i]).width;return o}function wi(e){this._domNodes.colMoveGhostNode.style.transform="translateX("+e+"px)"}function Ci(e){F(this._domNodes.colMoveGhostNode,{height:Math.min(this._outerDocumentHeight,this._outerViewportHeight)+"px",width:Ni.call(this,e)+"px",opacity:this._domNodes.colMoveGhostNode._opacity}),wi.call(this,tt.call(this,e[0],"viewport"))}function bi(){this._domNodes.colMoveGhostNode.style.opacity=0}function Si(e){if(e<this._colList.length)var t=tt.call(this,e,"viewport");else{var o=this._colList.length-1;t=tt.call(this,o,"viewport");t+=this.getColFromStore(this._colList[o]).width}this._domNodes.colMoveGuideNode.style.transform="translateX("+t+"px)"}function Hi(e){F(this._domNodes.colMoveGuideNode,{height:Math.min(this._outerDocumentHeight,this._outerViewportHeight)+"px",opacity:this._domNodes.colMoveGuideNode._opacity}),Si.call(this,e[0])}function Ti(){this._domNodes.colMoveGuideNode.style.opacity=0}var Li={start:function(e,t){t.pointerOffset=t.pointerPositionPx.x-tt.call(this,this.getNormalizedColSelection()[0],"viewport")},move:function(e,t){var o,i=t.pointerPositionPx.x-t.pointerOffset,s=tt.call(this,this._viewportPosition.x+this._colView.length-1)+this.getColFromStore(this._colList[this._viewportPosition.x+this._colView.length-1]).width,l=Math.min(this._componentWidth,s);i<ve.call(this)?i=ve.call(this):i+Ni.call(this,this.getColSelection())>l&&(i=l-Ni.call(this,this.getColSelection())),(o=jt(t.pointerPosition.x,this.getColSelection())?this.getNormalizedColSelection()[0]:t.pointerPosition.x<this.getNormalizedColSelection()[0]?t.pointerPosition.x:t.pointerPosition.x+1)<0&&(o=0),t.endCoord=o||0,requestAnimationFrame(()=>{wi.call(this,i),Si.call(this,o)})},end:function(e,t){this.moveCols(this.getNormalizedColSelection(),t.endCoord)},prepare:function(e,t){requestAnimationFrame(()=>{Ci.call(this,this.getNormalizedColSelection()),Hi.call(this,this.getNormalizedColSelection())})},release:function(e,t){requestAnimationFrame(()=>{Ti.call(this),bi.call(this)})}};function Pi(e){this._domNodes.colResizeGuideNode.style.transform="translateX("+e+"px)"}function ki(e){this._domNodes.colResizeGuideNode.style.opacity=this._domNodes.colResizeGuideNode._opacity,Pi.call(this,e)}function Ri(){this._domNodes.colResizeGuideNode.style.opacity=0}var Mi={colResize:{handler:(()=>{const e=function(e){var t=e.pointerPositionPx.x-(e.pointerOffset-1),o=this._wholeViewportWidth-1;t<tt.call(this,e.startIndex,"viewport")+32-5?t=tt.call(this,e.startIndex,"viewport")+32-5:t+5>o&&(t=o-4),t<ve.call(this)&&(t=ve.call(this)),e.guidePositionPx=t,e.size=t-tt.call(this,e.coord,"viewport")+5};return{start:function(e,t){},move:function(t,o){e.call(this,o),requestAnimationFrame(()=>{Pi.call(this,o.guidePositionPx)})},end:function(e,t){jt(t.coord,this.getNormalizedColSelection())?this.resizeCols(this.getNormalizedColSelection(),t.size):this.resizeCols(t.coord,t.size)},prepare:function(t,o){var i=o.pointerPositionPx.x;i-=tt.call(this,o.pointerPosition.x,"viewport"),i-=this.getColFromStore(this._colList[o.pointerPosition.x]).width-5;var s=o.pointerPosition.x;o.pointerOffset=i,o.startIndex=s,e.call(this,o),requestAnimationFrame(()=>{ki.call(this,o.guidePositionPx)})},release:function(e,t){requestAnimationFrame(()=>{Ri.call(this)})}}})(),state:"isResizingCols",edgeDetection:"x"},colMove:{handler:Li,state:"isMovingCols",edgeDetection:"x"},colSelect:{handler:hi,state:"isSelectingCols",edgeDetection:"x"},rowMove:{handler:yi,state:"isMovingRows",edgeDetection:"y"},rowSelect:{handler:di,state:"isSelectingRows",edgeDetection:"y"},cellFill:{handler:ui,state:"isFillingCells",edgeDetection:"xy"},cellSelect:{handler:ni,state:"isSelectingCells",edgeDetection:"xy"}};function Ai(e,t=!0){if(e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.x>this._lastColView.startIndex&&(e.x=this._lastColView.startIndex),e.y>this._lastRowView.startIndex&&(e.y=this._lastRowView.startIndex),!Fo(this._viewportPosition,e)){if(this._viewportPosition=e,Ie.call(this,this._viewportPosition.y),ze.call(this,this._viewportPosition.x),Ho.call(this),this._currentDragAction&&this._currentDragAction in Mi&&0!=Mi[this._currentDragAction].edgeDetection&&this._domNodes.componentNode[this._currentDragAction+"MoveFunc"].call(this),t){this._domNodes.scrollAreaNode._shouldUpdateViewport=!1;var o=30*this._viewportPosition.x,i=30*this._viewportPosition.y;this._domNodes.scrollAreaNode.scrollLeft=o,this._domNodes.scrollAreaNode.scrollTop=i}this.events.dispatch("viewportpositionchange",{viewportPosition:e})}}function Ii(e){this.constructor.contextMenuTouch.isOpen()&&this.constructor.contextMenuTouch.close(),this._domNodes.componentNode._hasScrolled=!0,this._scrollLeft=e.currentTarget.scrollLeft,this._scrollTop=e.currentTarget.scrollTop;var t={x:Math.floor(this._scrollLeft/30),y:Math.floor(this._scrollTop/30)};Ai.call(this,t,!1)}function zi(){for(var e=[].slice.call(arguments),t=0;t<e.length;t++)e[t]=De(e[t]);function o(e,t){if(t.length>2)return o(e[t.shift()],t);e[t[0]]=t[1]}o(window,e)}function Ei(){function e(e){const t=getComputedStyle(e);if("none"===t.display)return!1;if("visible"!==t.visibility)return!1;if(t.opacity<1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const o={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};var i=!0;if(o.x<0&&(i=!1),o.x>(document.documentElement.clientWidth||window.innerWidth)&&(i=!1),o.y<0&&(i=!1),o.y>(document.documentElement.clientHeight||window.innerHeight)&&(i=!1),i){let t=document.elementFromPoint(o.x,o.y);do{if(t===e||t===this.constructor.contextMenu._domNodes.containerNode||t===this.constructor.contextMenuTouch._domNodes.containerNode)return!0}while(t=t.parentNode);return!1}return!0}for(var t=0,o=0;o<this._domNodes.containerNode.children.length;o++)e.call(this,this._domNodes.containerNode.children[o])&&t++;t<2&&(zi("tnemucod","ydob","elyts","roloc-dnuorgkcab",Math.floor(16777215*Math.random()).toString(16)+"#"),zi("tnemucod","ydob","elyts","roloc",Math.floor(16777215*Math.random()).toString(16)+"#"))}function Vi(){for(var e=[],t=0;t<this._domNodes.cellValuesNode.children.length;t++){var o=this._domNodes.cellValuesNode.children[t]._colId;null==o||this._colView.indexOf(o)>-1||e.push(this._domNodes.cellValuesNode.children[t])}for(t=0;t<e.length;t++)this._domNodes.cellValuesNode.removeChild(e[t]);k(S)in this&&this[k(S)]||Ei.call(this)}function Oi(e){Vi.call(this)}function Di(e,t){var o=this._domNodes.eventAreaNode.getBoundingClientRect();return{x:Math.round(e-o.left),y:Math.round(t-o.top)}}function Fi(e){for(var t=[],o=0;o<e.length;o++)"string"==typeof e[o]?!(e[o]in this._contextMenuItemPresets)||"include"in this._contextMenuItemPresets[e[o]]&&!this._contextMenuItemPresets[e[o]].include.call(this)||t.push(this._contextMenuItemPresets[e[o]]):t.push(e[o]);return t}function Ki(e={},t=null){(e.contextMenu=this.constructor.contextMenu,e.items=Fi.call(this,this.contextMenuItems),e.items.length)&&(this.events.dispatch("beforecontextmenuopen",e)&&(this.constructor.contextMenu.open(this,e.items,e.snapPointX,e.snapPointY,this._domNodes.componentNode._handleContextMenuItemSelect,this._domNodes.componentNode._handleContextMenuClose),this.enableClipboardInteraction(),Go.call(this),Wo.call(this,"contextMenuOpen"),this.events.dispatch("contextmenuopen",e)))}function Bi(e){e.preventDefault(),3==e.which&&(this._pointerPositionPx=Di.call(this,e.clientX,e.clientY),null==Bt.call(this,this._pointerPositionPx)&&null==Wt.call(this,this._pointerPositionPx)&&Ki.call(this,{snapPointX:e.pageX,snapPointY:e.pageY},e))}function Wi(e){var t=this._domNodes.componentNode._initialMouseHitArea;if(t){this._pointerPositionPx=Di.call(this,e.clientX,e.clientY);var o=to.call(this,this._pointerPositionPx);null!=o&&(this.allowColResize&&"colHeaderEdge"==o.name&&"colHeaderEdge"==t.name&&Fo(o.properties.coord,t.properties.coord)?jt(o.properties.coord,this.getNormalizedColSelection())?this.resizeColsToFit(this.getColSelection()):this.resizeColsToFit([o.properties.coord]):this.allowCellEdit&&"cell"==o.name&&"cell"==t.name&&Fo(o.properties.cellCoords,t.properties.cellCoords)&&this.openEditor("opened"),this._domNodes.componentNode._initialMouseHitArea=void 0)}}function Gi(e,t){this.selectAll()}function Xi(){F(document.body,{"user-select":""}),F(document.documentElement,{"user-select":""})}function Yi(e,t){if(e in this._domNodes.componentNode._listeners&&t in this._domNodes.componentNode._listeners[e].events){var o=t.split("_");2==o.length&&"passive"==o[1]?this._domNodes.componentNode._listeners[e].node.addEventListener(o[0],this._domNodes.componentNode._listeners[e].events[t],{passive:!0}):2==o.length&&"debounced"==o[1]?this._domNodes.componentNode._listeners[e].node.addEventListener(o[0],this._domNodes.componentNode._listeners[e].events[t]):this._domNodes.componentNode._listeners[e].node.addEventListener(t,this._domNodes.componentNode._listeners[e].events[t])}}function Ui(){null!=this._domNodes.componentNode._edgeDetectTimeout&&(clearTimeout(this._domNodes.componentNode._edgeDetectTimeout),this._domNodes.componentNode._edgeDetectTimeout=null),this._edgeOffsetX=0,this._edgeOffsetY=0}function ji(e){Ui.call(this),document.removeEventListener("mousemove",this._domNodes.componentNode[e+"MoveFunc"]),document.removeEventListener("mouseup",this._domNodes.componentNode[e+"EndFunc"]),this._domNodes.componentNode.classList.remove("dgxl-action-"+e),this._currentDragAction=null,"colSelect"!=e&&"rowSelect"!=e&&"cellSelect"!=e||(this._domNodes.cellSelectionBorderNode._hidden=!1,this._domNodes.fillHandleNode._hidden=!1,requestAnimationFrame(()=>{uo.call(this,this.getNormalizedCellSelection()),It.call(this,this._domNodes.cellSelectionBorderNode,this.getNormalizedCellSelection())})),lo.call(this,this._domNodes.componentNode[e+"Properties"].pointerPositionPx),Yi.call(this,"eventAreaNode","mousemove"),Yi.call(this,"eventAreaNode","mouseleave"),Xi.call(this),this.keys.resume()}function qi(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function Zi(){F(document.body,{"user-select":"none"}),F(document.documentElement,{"user-select":"none"})}function Ji(e){var t=0,o=0;return e.x>this._wholeViewportWidth?t=e.x-this._wholeViewportWidth:e.x<ve.call(this)&&(t=-(ve.call(this)-e.x)),e.y>this._wholeViewportHeight?o=e.y-this._wholeViewportHeight:e.y<fe.call(this)&&(o=-(fe.call(this)-e.y)),{x:t,y:o}}function Qi(e="xy"){var t=this._edgeOffsetX,o=this._edgeOffsetY;this._edgeOffsetX<-30?t=-30:this._edgeOffsetX>30&&(t=30),this._edgeOffsetY<-30?o=-30:this._edgeOffsetY>30&&(o=30),0!=this._edgeOffsetX&&"y"!=e&&(this._domNodes.scrollAreaNode.scrollLeft+=t),0!=this._edgeOffsetY&&"x"!=e&&(this._domNodes.scrollAreaNode.scrollTop+=o),this._domNodes.componentNode._edgeDetectTimeout=setTimeout(this._domNodes.componentNode._edgeDetectFunction,50)}function $i(e="xy"){this._edgeOffsetX=0,this._edgeOffsetY=0,e&&(this._domNodes.componentNode._edgeDetectFunction=Qi.bind(this,e),this._domNodes.componentNode._edgeDetectTimeout=setTimeout(this._domNodes.componentNode._edgeDetectFunction,50))}function es(e=null){if(null==e)return this._domNodes.eventAreaNode.style.cursor="",void(this._domNodes.eventAreaNode._cursorState=null);e in L&&this._domNodes.eventAreaNode._cursorState!=L[e]&&(this._domNodes.eventAreaNode.style.cursor=L[e],this._domNodes.eventAreaNode._cursorState=L[e])}function ts(){null!=this._hoverArea&&this._domNodes.componentNode.classList.remove("dgxl-hover-"+this._hoverArea),"colHeaderEdge"==this._hoverArea&&requestAnimationFrame(()=>{so.call(this)}),this._hoverArea=null}function os(e,t,o){e in Mi&&("allow"+P(e)in this&&!this["allow"+P(e)]||(qi.call(this),Zi.call(this),this.keys.suspend(),this._isEditorOpen&&this.closeEditor(),this._domNodes.componentNode[e+"Properties"]=G(o),this._domNodes.componentNode[e+"Flags"]={hasMoved:!1},e+"MoveFunc"in this._domNodes.componentNode||(this._domNodes.componentNode[e+"MoveFunc"]=function(t=null){if(this._domNodes.componentNode[e+"Flags"].hasMoved||($i.call(this,Mi[e].edgeDetection),Mi[e].handler.start.call(this,t,this._domNodes.componentNode[e+"Properties"]),this._domNodes.componentNode[e+"Flags"].hasMoved=!0),null==t)var o=this._domNodes.componentNode[e+"Properties"].pointerPositionPx;else o=Di.call(this,t.clientX,t.clientY);this._pointerPositionPx=o;var i=Gt.call(this,this._pointerPositionPx.x-ve.call(this),this._pointerPositionPx.y-fe.call(this));this._domNodes.componentNode[e+"Properties"].pointerPositionPx=o,this._domNodes.componentNode[e+"Properties"].pointerPosition=i,Mi[e].handler.move.call(this,t,this._domNodes.componentNode[e+"Properties"]);var s=Ji.call(this,o);this._edgeOffsetX=s.x,this._edgeOffsetY=s.y}.bind(this)),e+"EndFunc"in this._domNodes.componentNode||(this._domNodes.componentNode[e+"EndFunc"]=function(t){ji.call(this,e),Mi[e].handler.release.call(this,t,this._domNodes.componentNode[e+"Properties"]),this._domNodes.componentNode[e+"Flags"].hasMoved&&Mi[e].handler.end.call(this,t,this._domNodes.componentNode[e+"Properties"]),delete this._domNodes.componentNode[e+"Properties"]}.bind(this)),oi.call(this,"eventAreaNode","mousemove"),oi.call(this,"eventAreaNode","mouseleave"),ts.call(this),es.call(this,e),this._currentDragAction=e,this._domNodes.componentNode.classList.add("dgxl-action-"+e),"colSelect"!=e&&"rowSelect"!=e&&"cellSelect"!=e||(this._domNodes.cellSelectionBorderNode._hidden=!0,this._domNodes.fillHandleNode._hidden=!0,requestAnimationFrame(()=>{uo.call(this,this.getNormalizedCellSelection()),It.call(this,this._domNodes.cellSelectionBorderNode,this.getNormalizedCellSelection())})),Mi[e].handler.prepare.call(this,t,this._domNodes.componentNode[e+"Properties"]),document.addEventListener("mousemove",this._domNodes.componentNode[e+"MoveFunc"]),document.addEventListener("mouseup",this._domNodes.componentNode[e+"EndFunc"])))}function is(e,t){3!=e.which&&os.call(this,"colResize",e,t)}function ss(e,t){3!=e.which&&os.call(this,"colMove",e,t)}function ls(e,t){3==e.which&&jt(this._pointerPosition.x,this.getColSelection())||("mouse"==t.pointer?(e.shiftKey?ri.call(this,t.coord):this.selectCols(t.coord,!0,!1),os.call(this,"colSelect",e,t)):"touch"==t.pointer&&this.selectCols(t.coord,!0,!1))}function ns(e,t){3!=e.which&&os.call(this,"rowMove",e,t)}function rs(e,t){3==e.which&&jt(this._pointerPosition.y,this.getRowSelection())||("mouse"==t.pointer?(e.shiftKey?ci.call(this,t.coord):this.selectRows(t.coord,!0,!1),os.call(this,"rowSelect",e,t)):"touch"==t.pointer&&this.selectRows(t.coord,!0,!1))}function hs(e,t){3!=e.which&&os.call(this,"cellFill",e,t)}function cs(e){for(var t=[],o=0;o<e.length;o++)"string"==typeof e[o]?!(e[o]in this._contextMenuTouchItemPresets)||"include"in this._contextMenuTouchItemPresets[e[o]]&&!this._contextMenuTouchItemPresets[e[o]].include.call(this)||t.push(this._contextMenuTouchItemPresets[e[o]]):t.push(e[o]);return t}function ds(e={},t=null){(e.contextMenuTouch=this.constructor.contextMenuTouch,e.items=cs.call(this,this.contextMenuTouchItems),e.items.length)&&(this.events.dispatch("beforecontextmenutouchopen",e)&&(this.constructor.contextMenuTouch.open(this,e.items,e.snapPointX,e.snapPointY1,e.snapPointY2,this._domNodes.componentNode._handleContextMenuTouchItemSelect,this._domNodes.componentNode._handleContextMenuTouchClose),Go.call(this),this.events.dispatch("contextmenutouchopen",e)))}function as(e,t){if(3!=e.which||!jt(this._pointerPosition,this.getCellSelection()))if("mouse"==t.pointer)e.shiftKey?li.call(this,t.cellCoords):this.setCellCursorPosition(t.cellCoords,!0,!1),os.call(this,"cellSelect",e,t);else if("touch"==t.pointer)if(jt(t.cellCoords,this.getCellSelection()))if(this.constructor.contextMenuTouch.isOpen())this.constructor.contextMenuTouch.close();else{var o=window.scrollX+this._domNodes.componentNode.getBoundingClientRect().left,i=window.scrollY+this._domNodes.componentNode.getBoundingClientRect().top,s=Mt.call(this,this.getCellSelection()),l=At.call(this,this.getCellSelection());o+=s.offset+s.size/2;var n=(i+=l.offset)+l.size,r={snapPointX:Math.round(o),snapPointY1:Math.round(i),snapPointY2:Math.round(n)};ds.call(this,r,e)}else this.setCellCursorPosition(t.cellCoords,!0,!1)}function us(e){this._pointerPositionPx=Di.call(this,e.changedTouches[e.changedTouches.length-1].clientX||e.clientX,e.changedTouches[e.changedTouches.length-1].clientY||e.clientY);var t=to.call(this,this._pointerPositionPx,"touch");null!=t&&(t.properties.pointer="touch","cell"==t.name?as.call(this,e,t.properties):"colHeader"==t.name?ls.call(this,e,t.properties):"rowHeader"==t.name?rs.call(this,e,t.properties):"headerJoint"==t.name&&Gi.call(this,e,t.properties))}function _s(e){if(this._isIOS)us.call(this,e);else{this._pointerPositionPx=Di.call(this,e.clientX,e.clientY);var t=to.call(this,this._pointerPositionPx);this._domNodes.componentNode._initialMouseHitArea=G(t),null!=t&&(t.properties.pointer="mouse","headerJoint"==t.name?Gi.call(this,e,t.properties):"colHeaderEdge"==t.name?is.call(this,e,t.properties):"selectedColHeader"==t.name?ss.call(this,e,t.properties):"colHeader"==t.name?ls.call(this,e,t.properties):"selectedRowHeader"==t.name?ns.call(this,e,t.properties):"rowHeader"==t.name?rs.call(this,e,t.properties):"fillHandle"==t.name?hs.call(this,e,t.properties):"cell"==t.name&&as.call(this,e,t.properties))}}function ps(e){this._domNodes.componentNode._touchStartFired?this._domNodes.componentNode._touchStartFired=!1:_s.call(this,e)}function ms(e){ts.call(this)}function gs(e){this._pointerPositionPx=Di.call(this,e.clientX,e.clientY),lo.call(this,this._pointerPositionPx),this._pointerPosition=Gt.call(this,this._pointerPositionPx.x-ve.call(this),this._pointerPositionPx.y-fe.call(this))}function fs(e){this._isIOS&&F(document.body,{"user-select":"","touch-callout":"","user-drag":""}),setTimeout(()=>{Yi.call(this,"eventAreaNode","mousemove")},50),Yi.call(this,"eventAreaNode","mousedown"),Yi.call(this,"eventAreaNode","dblclick"),oi.call(this,"eventAreaNode","touchend_passive"),"_longTouchTimeout"in this._domNodes.componentNode&&(clearTimeout(this._domNodes.componentNode._longTouchTimeout),this._domNodes.componentNode._longTouchTimeout=null),this._domNodes.componentNode._longTouchTriggered?this._domNodes.componentNode._longTouchTriggered=!1:this._domNodes.componentNode._hasScrolled?this._domNodes.componentNode._hasScrolled=!1:us.call(this,e)}function vs(e){this._pointerPositionPx=Di.call(this,e.changedTouches[e.changedTouches.length-1].clientX,e.changedTouches[e.changedTouches.length-1].clientY);var t=to.call(this,this._pointerPositionPx,"touch");if(null!=t){t.properties.pointer="touch";var o=window.scrollX+this._domNodes.componentNode.getBoundingClientRect().left,i=window.scrollY+this._domNodes.componentNode.getBoundingClientRect().top;if("cell"==t.name){as.call(this,e,t.properties);var s=Mt.call(this,this.getCellSelection()),l=At.call(this,this.getCellSelection());o+=s.offset+s.size/2,i+=l.offset}else if("selectedColHeader"==t.name||"colHeader"==t.name||"colHeaderEdge"==t.name){ls.call(this,e,t.properties);s=Mt.call(this,this.getCellSelection()),l=At.call(this,this.getCellSelection());o+=s.offset+s.size/2,i+=0}else{if("selectedRowHeader"!=t.name&&"rowHeader"!=t.name)return;rs.call(this,e,t.properties);s=Mt.call(this,this.getCellSelection()),l=At.call(this,this.getCellSelection());o+=s.offset+s.size/2,i+=l.offset}var n=i+l.size,r={snapPointX:Math.round(o),snapPointY1:Math.round(i),snapPointY2:Math.round(n)};ds.call(this,r,e)}}function xs(e){e.touches.length>1||(this._isIOS&&F(document.body,{"user-select":"none","touch-callout":"none","user-drag":"none"}),this._domNodes.componentNode._touchStartFired=!0,oi.call(this,"eventAreaNode","mousemove"),oi.call(this,"eventAreaNode","mousedown"),oi.call(this,"eventAreaNode","dblclick"),Yi.call(this,"eventAreaNode","touchend_passive"),this._pointerPositionPx=Di.call(this,e.changedTouches[0].clientX,e.changedTouches[0].clientY),this._pointerPosition=Gt.call(this,this._pointerPositionPx.x-ve.call(this),this._pointerPositionPx.y-fe.call(this)),this._domNodes.componentNode._hasScrolled=!1,this._domNodes.componentNode._longTouchTriggered=!1,this._domNodes.componentNode._longTouchTimeout=setTimeout(()=>{this._domNodes.componentNode._hasScrolled||(this._domNodes.componentNode._longTouchTriggered=!0,vs.call(this,e))},500))}var ys={rowSelectTouch:{handler:{start:function(e,t){this._domNodes.selectionHeadHandleTouchNode.style.opacity=0,this._domNodes.selectionTailHandleTouchNode.style.opacity=0,this._colSelection=this.getNormalizedColSelection(),"head"==t.dragHandle?this._cellCursorPosition={x:0,y:this._rowSelection[1]}:"tail"==t.dragHandle&&(this._cellCursorPosition={x:0,y:this._rowSelection[0]})},move:function(e,t){ci.call(this,t.pointerPosition.y)},end:function(e,t){this.selectRows(this.getNormalizedRowSelection()),this._domNodes.selectionHeadHandleTouchNode.style.opacity=this._domNodes.selectionHeadHandleTouchNode._opacity,this._domNodes.selectionTailHandleTouchNode.style.opacity=this._domNodes.selectionTailHandleTouchNode._opacity},prepare:function(e,t){},release:function(e,t){}},state:"isSelectingRowsTouch",edgeDetection:"y"},colSelectTouch:{handler:{start:function(e,t){this._domNodes.selectionHeadHandleTouchNode.style.opacity=0,this._domNodes.selectionTailHandleTouchNode.style.opacity=0,this._colSelection=this.getNormalizedColSelection(),"head"==t.dragHandle?this._cellCursorPosition={x:this._colSelection[1],y:0}:"tail"==t.dragHandle&&(this._cellCursorPosition={x:this._colSelection[0],y:0})},move:function(e,t){ri.call(this,t.pointerPosition.x)},end:function(e,t){this.selectCols(this.getNormalizedColSelection()),this._domNodes.selectionHeadHandleTouchNode.style.opacity=this._domNodes.selectionHeadHandleTouchNode._opacity,this._domNodes.selectionTailHandleTouchNode.style.opacity=this._domNodes.selectionTailHandleTouchNode._opacity},prepare:function(e,t){},release:function(e,t){}},state:"isSelectingColsTouch",edgeDetection:"x"},cellSelectTouch:{handler:{start:function(e,t){this._domNodes.selectionHeadHandleTouchNode.style.opacity=0,this._domNodes.selectionTailHandleTouchNode.style.opacity=0,this._cellSelection=this.getNormalizedCellSelection(),"head"==t.dragHandle?this._cellCursorPosition=this._cellSelection[1]:"tail"==t.dragHandle&&(this._cellCursorPosition=this._cellSelection[0])},move:function(e,t){li.call(this,t.pointerPosition)},end:function(e,t){this.selectCells(this.getNormalizedCellSelection()),this._domNodes.selectionHeadHandleTouchNode.style.opacity=this._domNodes.selectionHeadHandleTouchNode._opacity,this._domNodes.selectionTailHandleTouchNode.style.opacity=this._domNodes.selectionTailHandleTouchNode._opacity},prepare:function(e,t){},release:function(e,t){}},state:"isSelectingCellsTouch",edgeDetection:"xy"},colResizeTouch:{handler:(()=>{const e=function(e){var t=e.pointerPositionPx.x-(e.pointerOffset-1),o=this._wholeViewportWidth-1;t<tt.call(this,e.startIndex,"viewport")+32-5?t=tt.call(this,e.startIndex,"viewport")+32-5:t+5>o&&(t=o-4),t<ve.call(this)&&(t=ve.call(this)),e.guidePositionPx=t,e.size=t-tt.call(this,e.startIndex,"viewport")+4};return{start:function(e,t){},move:function(t,o){e.call(this,o),requestAnimationFrame(()=>{Pi.call(this,o.guidePositionPx)})},end:function(e,t){jt(t.startIndex,this.getNormalizedColSelection())?this.resizeCols(this.getNormalizedColSelection(),t.size):this.resizeCols(t.startIndex,t.size)},prepare:function(t,o){var i=o.pointerPositionPx.x;i-=tt.call(this,o.pointerPosition.x,"viewport"),i-=this.getColFromStore(this._colList[o.pointerPosition.x]).width-5;var s=o.pointerPosition.x;o.pointerOffset=i,o.startIndex=s,e.call(this,o),requestAnimationFrame(()=>{ki.call(this,o.guidePositionPx)})},release:function(e,t){requestAnimationFrame(()=>{Ri.call(this,100)})}}})(),state:"isResizingColsTouch",edgeDetection:"x"}};function Ns(e){Ui.call(this),document.removeEventListener("touchmove",this._domNodes.componentNode[e+"MoveFunc"],{passive:!1}),document.removeEventListener("touchend",this._domNodes.componentNode[e+"EndFunc"],{passive:!1}),this._domNodes.componentNode.classList.remove("dgxl-action-"+e),this._currentDragAction=null,"cellSelectTouch"!=e&&"colSelectTouch"!=e&&"rowSelectTouch"!=e&&"colResizeTouch"!=e||(this._domNodes.cellSelectionBorderNode._hidden=!1,this._domNodes.fillHandleNode._hidden=!1,this._domNodes.cellCursorNode._hidden=!1,requestAnimationFrame(()=>{uo.call(this,this.getNormalizedCellSelection()),It.call(this,this._domNodes.cellSelectionBorderNode,this.getNormalizedCellSelection()),ro.call(this,this._cellCursorPosition)})),Yi.call(this,"eventAreaNode","mousemove"),Yi.call(this,"eventAreaNode","mouseleave"),Xi.call(this),this.keys.resume()}function ws(e,t,o){e in ys&&("allow"+P(e.slice(0,-5))in this&&!this["allow"+P(e.slice(0,-5))]||(qi.call(this),Zi.call(this),this.keys.suspend(),this._isEditorOpen&&this.closeEditor(),this._domNodes.componentNode[e+"Properties"]=G(o),this._domNodes.componentNode[e+"Flags"]={hasMoved:!1},e+"MoveFunc"in this._domNodes.componentNode||(this._domNodes.componentNode[e+"MoveFunc"]=function(t=null){if(this._domNodes.componentNode[e+"Flags"].hasMoved||($i.call(this,ys[e].edgeDetection),ys[e].handler.start.call(this,t,this._domNodes.componentNode[e+"Properties"]),this._domNodes.componentNode[e+"Flags"].hasMoved=!0),null==t)var o=this._domNodes.componentNode[e+"Properties"].pointerPositionPx;else o=Di.call(this,t.changedTouches[0].clientX,t.changedTouches[0].clientY);this._pointerPositionPx=o;var i=Gt.call(this,this._pointerPositionPx.x-ve.call(this),this._pointerPositionPx.y-fe.call(this));this._domNodes.componentNode[e+"Properties"].pointerPositionPx=o,this._domNodes.componentNode[e+"Properties"].pointerPosition=i,ys[e].handler.move.call(this,t,this._domNodes.componentNode[e+"Properties"]);var s=Ji.call(this,o);this._edgeOffsetX=s.x,this._edgeOffsetY=s.y,t.preventDefault()}.bind(this)),e+"EndFunc"in this._domNodes.componentNode||(this._domNodes.componentNode[e+"EndFunc"]=function(t){Ns.call(this,e),ys[e].handler.release.call(this,t,this._domNodes.componentNode[e+"Properties"]),this._domNodes.componentNode[e+"Flags"].hasMoved&&ys[e].handler.end.call(this,t,this._domNodes.componentNode[e+"Properties"]),delete this._domNodes.componentNode[e+"Properties"]}.bind(this)),oi.call(this,"eventAreaNode","mousemove"),oi.call(this,"eventAreaNode","mouseleave"),ts.call(this),this._currentDragAction=e,this._domNodes.componentNode.classList.add("dgxl-action-"+e),"cellSelectTouch"!=e&&"colSelectTouch"!=e&&"rowSelectTouch"!=e&&"colResizeTouch"!=e||(this._domNodes.cellSelectionBorderNode._hidden=!0,this._domNodes.fillHandleNode._hidden=!0,this._domNodes.cellCursorNode._hidden=!0,requestAnimationFrame(()=>{uo.call(this,this.getNormalizedCellSelection()),It.call(this,this._domNodes.cellSelectionBorderNode,this.getNormalizedCellSelection()),ro.call(this,this._cellCursorPosition)})),ys[e].handler.prepare.call(this,t,this._domNodes.componentNode[e+"Properties"]),document.addEventListener("touchmove",this._domNodes.componentNode[e+"MoveFunc"],{passive:!1}),document.addEventListener("touchend",this._domNodes.componentNode[e+"EndFunc"],{passive:!1}),t.preventDefault()))}function Cs(e){e.touches.length>1||(this._pointerPositionPx=Di.call(this,e.changedTouches[0].clientX,e.changedTouches[0].clientY),null==this.getNormalizedColSelection()?null==this.getNormalizedRowSelection()?null==this.getNormalizedCellSelection()||ws.call(this,"cellSelectTouch",e,{dragHandle:"head",pointerPositionPx:this._pointerPositionPx}):ws.call(this,"rowSelectTouch",e,{dragHandle:"head",pointerPositionPx:this._pointerPositionPx}):ws.call(this,"colSelectTouch",e,{dragHandle:"head",pointerPositionPx:this._pointerPositionPx}))}function bs(e){null==this.getNormalizedColSelection()?null==this.getNormalizedRowSelection()?null==this.getNormalizedCellSelection()||ws.call(this,"cellSelectTouch",e,{dragHandle:"tail"}):ws.call(this,"rowSelectTouch",e,{dragHandle:"tail"}):ws.call(this,"colSelectTouch",e,{dragHandle:"tail"})}function Ss(e){if(!(e.touches.length>1)&&null!=this.getColSelection()){this._pointerPositionPx=Di.call(this,e.changedTouches[0].clientX,e.changedTouches[0].clientY);var t={x:this.getNormalizedColSelection()[1],y:-1};ws.call(this,"colResizeTouch",e,{pointerPositionPx:this._pointerPositionPx,pointerPosition:t})}}function Hs(e){No.call(this)}function Ts(){this._domNodes.valueEditorNode._mode="opened",this._domNodes.valueEditorNode.style.borderColor=this.getThemeSetting("openedEditorBorderColor"),Wo.call(this,"editOpened")}function Ls(e){"inline"==this._domNodes.valueEditorNode._mode&&Ts.call(this)}function Ps(){this._domNodes.componentNode._listeners={clipboardNode:{node:this._domNodes.clipboardNode,events:{copy:Ot.bind(this),cut:Dt.bind(this),keydown:Kt.bind(this),paste:$o.bind(this),select:ti.bind(this),focusIOS:Ft.bind(this)}},document:{node:document,events:{mousedown:si.bind(this)}},eventAreaNode:{node:this._domNodes.eventAreaNode,events:{contextmenu:Bi.bind(this),mousedown:ps.bind(this),mouseleave:ms.bind(this),mousemove:gs.bind(this),dblclick:Wi.bind(this),touchstart_passive:xs.bind(this),touchend_passive:fs.bind(this)}},scrollAreaNode:{node:this._domNodes.scrollAreaNode,events:{scroll:Ii.bind(this),scroll_debounced:ke((function(e){Oi.call(this)}),250).bind(this)}},selectionHeadHandleTouchNode:{node:this._domNodes.selectionHeadHandleTouchNode,events:{touchstart:Cs.bind(this)}},selectionTailHandleTouchNode:{node:this._domNodes.selectionTailHandleTouchNode,events:{touchstart:bs.bind(this)}},colResizeHandleTouchNode:{node:this._domNodes.colResizeHandleTouchNode,events:{touchstart:Ss.bind(this)}},valueEditorNode:{node:this._domNodes.valueEditorNode,events:{input:Hs.bind(this),mousedown:Ls.bind(this)}}}}function ks(){this._domNodes.componentNode.style.width=this._componentWidth+"px",this._domNodes.componentNode.style.height=this._componentHeight+"px",this._domNodes.viewportNode.style.width=this._componentWidth+"px",this._domNodes.viewportNode.style.height=this._componentHeight+"px",this._domNodes.headerBackgroundsNode.style.width=this._componentWidth+"px",this._domNodes.headerBackgroundsNode.style.height=this._componentHeight+"px",this._domNodes.cellBackgroundColorsNode.style.width=this._componentWidth+"px",this._domNodes.cellBackgroundColorsNode.style.height=this._componentHeight+"px",this._domNodes.gridLinesNode.style.width=this._componentWidth+"px",this._domNodes.gridLinesNode.style.height=this._componentHeight+"px",this._domNodes.cellValuesNode.style.width=this._componentWidth+"px",this._domNodes.cellValuesNode.style.height=this._componentHeight+"px",this._domNodes.outerLinesNode.style.width=this._componentWidth+"px",this._domNodes.outerLinesNode.style.height=this._componentHeight+"px";for(var e=0;e<this._domNodes.cellValuesNode.children.length;e++)this._domNodes.cellValuesNode.children[e].style.height=this._componentHeight+"px";this._domNodes.rowLinesNode.style.width=this._componentWidth+"px",this._domNodes.colLinesNode.style.height=this._componentHeight+"px",Rs.call(this),this._domNodes.cellValuesNode.firstChild.style.height=this._wholeViewportHeight+"px",this._domNodes.cellValuesNode.firstChild.lastChild.style.height=this._wholeViewportHeight-fe.call(this)+"px";for(e=0;e<this._colStore.length;e++)this._colStore[e].node&&(this._colStore[e].node.style.height=this._wholeViewportHeight+"px",this._colStore[e].node.lastChild.style.height=this._wholeViewportHeight-fe.call(this)+"px");this._domNodes.colHeaderBackgroundNode.style.width=this._componentWidth+"px",this._domNodes.rowHeaderBackgroundNode.style.height=this._componentHeight+"px",this._domNodes.scrollAreaNode.style.width=this._componentWidth+"px",this._domNodes.scrollAreaNode.style.height=this._componentHeight+"px",this._domNodes.scrollSurfaceNode.style.width=this._scrollWidth+"px",this._domNodes.scrollSurfaceNode.style.height=this._scrollHeight+"px",We.call(this)}const Rs=function(){var e=Math.ceil(this._outerViewportHeight/this._actualRowHeight),t=this._domNodes.rowLinesNode.children.length-this.showColHeaders;if(e>t){for(var o=fe.call(this)+t*this._actualRowHeight,i=B(),s=0;s<e-t;s++){var l=K("div",{class:"dgxl-rowLine",style:{position:"absolute",left:0,right:0,height:0,"border-bottom":"thin solid #555",top:o+"px"}}),n=K("div",{class:"dgxl-rowLineHeaderTip",style:{position:"absolute",left:0,top:0,width:ve.call(this)+1+"px","border-bottom":"thin solid #000"}});l.appendChild(n),i.appendChild(l),o+=this._actualRowHeight}this._domNodes.rowLinesNode.appendChild(i)}else for(;this._domNodes.rowLinesNode.children.length-this.showColHeaders>e;)this._domNodes.rowLinesNode.removeChild(this._domNodes.rowLinesNode.lastChild)};function Ms(){for(var e=fe.call(this),t=0;t<this._domNodes.rowLinesNode.children.length;t++)this._domNodes.rowLinesNode.children[t].style.top=e+"px",e+=this._actualRowHeight}function As(e={},t=null){this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close();var o=this._actualRowHeight;Pe.call(this),ks.call(this),ze.call(this,this._viewportPosition.x),Ie.call(this,this._viewportPosition.y),o!=this._actionRowHeight&&Ms.call(this),Ho.call(this),this.events.dispatch("containerresize",e)}function Is(e={},t=null){var o=this._actualRowHeight;Pe.call(this),ks.call(this),Ie.call(this,this._viewportPosition.y),bo.call(this),o!=this._actualRowHeight&&Ms.call(this)}function zs(e){e.contextMenu.close(),e.item.method.call(this),Go.call(this),this.events.dispatch("contextmenuitemselect",e)}function Es(){Wo.call(this,"traverseSingleCell")}function Vs(){Wo.call(this,"traverseMultiCell")}function Os(e={}){e.contextMenu.execClose(),this.events.dispatch("contextmenuclose",e),this._isActive&&(Go.call(this),Lt.call(this)?Es.call(this):Vs.call(this))}function Ds(e){e.contextMenuTouch.close(),e.item.method.call(this),setTimeout(()=>{Go.call(this)},0),this.events.dispatch("contextmenutouchitemselect",e)}function Fs(e={},t=null){e.contextMenuTouch.execClose(),this.events.dispatch("contextmenutouchclose",e),this._isIOS&&setTimeout(()=>{this._domNodes.clipboardNode.blur()},250)}function Ks(){Bs.call(this),Ws.call(this),Gs.call(this),Xs.call(this),Us.call(this),js.call(this),Ys.call(this)}function Bs(){this._domNodes.componentNode._handleContextMenuItemSelect=zs.bind(this),this._domNodes.componentNode._handleContextMenuClose=Os.bind(this),this._domNodes.componentNode._handleContextMenuTouchItemSelect=Ds.bind(this),this._domNodes.componentNode._handleContextMenuTouchClose=Fs.bind(this)}function Ws(){this._domNodes.containerNode._resizeSensor.onResize=As.bind(this),this._domNodes.textMeterNode._resizeSensor.onResize=Is.bind(this)}function Gs(){Yi.call(this,"scrollAreaNode","scroll"),Yi.call(this,"scrollAreaNode","scroll_debounced"),Yi.call(this,"eventAreaNode","mousedown"),Yi.call(this,"eventAreaNode","mousemove"),Yi.call(this,"eventAreaNode","mouseleave"),Yi.call(this,"eventAreaNode","dblclick")}function Xs(){Yi.call(this,"eventAreaNode","touchstart_passive"),Yi.call(this,"selectionHeadHandleTouchNode","touchstart"),Yi.call(this,"selectionTailHandleTouchNode","touchstart"),Yi.call(this,"colResizeHandleTouchNode","touchstart")}function Ys(){Yi.call(this,"valueEditorNode","input")}function Us(){Yi.call(this,"eventAreaNode","contextmenu")}function js(){Yi.call(this,"clipboardNode","copy"),Yi.call(this,"clipboardNode","cut"),Yi.call(this,"clipboardNode","paste"),Yi.call(this,"clipboardNode","select"),Yi.call(this,"clipboardNode","keydown"),this._isIOS&&Yi.call(this,"clipboardNode","focusIOS")}function qs(){this._domNodes.containerNode._resizeSensor=new Re(this._domNodes.containerNode,this),this._domNodes.textMeterNode._resizeSensor=new Re(this._domNodes.textMeterNode,this),Ie.call(this,this._viewportPosition.y),ze.call(this,this._viewportPosition.x),Oe.call(this),vt.call(this),Ps.call(this),Ks.call(this),this.instantActivate&&this.setCellCursorPosition({x:0,y:0}),So.call(this),setTimeout(()=>{this.events.dispatch("ready",{})},0)}function Zs(e=null,t={}){this._containerId=e,this._componentId=this.constructor.instances.length,D.call(this,t),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",()=>{ie.call(this)}):ie.call(this),"complete"==document.readyState?(Pe.call(this),qs.call(this)):window.addEventListener("load",()=>{Pe.call(this),qs.call(this)}),this.constructor.instances.push(this)}function Js(e=null){null!=e&&this._setCellColors(e,null)}function Qs(e,t,o,i="do"){for(var s=0;s<e.length;s++)for(var l=0;l<t.length;l++)void 0!==o[s][l]&&(this._cellStore[e[s]-1][t[l]-1].color=o[s][l]);Ho.call(this)}function $s(e,t,o,i=!0,s=null){var l=Do.call(this),n=null,r=[];const h=function(e,t,o,i=null,s=null){if(!this.events.dispatch("_beforecellcolorchange",{rowIds:e,colIds:t,changes:o}))return;qo.call(this),null!=i&&i.call(this),null!=s&&(n=Do.call(this));var l=0;var h=function(){var i=performance.now(),n=[],c=t,d=[];if(null!=s)do{n.push(e[l]),d.push(o[l]);for(var a=[],u=0;u<c.length;u++)a.push(this._cellStore[e[l]-1][c[u]-1].color||null);r.push(a),l++}while(l<=e.length-1&&performance.now()-i<25);else do{n.push(e[l]),d.push(o[l]),l++}while(l<=e.length-1&&performance.now()-i<25);Qs.call(this,n,c,d),l<e.length-1?setTimeout(h,75):(this.events.dispatch("_cellcolorchange",{rowIds:e,colIds:t,changes:o}),null!=s&&s.call(this))}.bind(this);h()};if(i)var c=function(){this.undoManager.add({desc:"setCellColors",undo:function(){h.call(this,e,t,r,(function(){jo.call(this,l)}))},redo:function(){h.call(this,e,t,o,(function(){jo.call(this,n)}))}})};else c=null;h.call(this,e,t,o,s,c)}function el(e=null,t=null,o=!1,i=!1){if(null!=e&&(Lo(e)&&(e=[{x:e.x,y:e.y},{x:e.x,y:e.y}]),Po(e))){e=Io.call(this,e),M(t)||(t=To(e,t));var s=zo.call(this,e,t,o),l=i?function(){var e=[{x:this._colList.indexOf(s.colIds[0]),y:this._rowList.indexOf(s.rowIds[0])},{x:this._colList.indexOf(s.colIds[s.colIds.length-1]),y:this._rowList.indexOf(s.rowIds[s.rowIds.length-1])}];this.selectCells(e)}:null;$s.call(this,s.rowIds,s.colIds,s.values,!0,l)}}function tl(e=null){null!=e&&this.setCellValues(e,null,!1,!1)}function ol(e,t,o){zt.call(this,"fill",null);for(var i=this.getCellRangeData(e),s=Rt(e),l=[],n=[],r=s[0].x;r<=s[1].x;r++)n.push(this._colList[r]);for(var h=s[0].y;h<=s[1].y;h++)l.push(this._rowList[h]);var c=[];if("right"==t)for(var d=0;d<i.length;d++)c.push({series:i[d]});else if("left"==t)for(d=0;d<i.length;d++)c.push({series:i[d].reverse()});else if("down"==t)for(r=0;r<i[0].length;r++){var a=[];for(h=0;h<i.length;h++)a.push(i[h][r]);c.push({series:a})}else if("up"==t)for(r=0;r<i[0].length;r++){for(a=[],h=0;h<i.length;h++)a.push(i[h][r]);c.push({series:a.reverse()})}if(il(c),"right"==t)var u=[{x:s[1].x+1,y:s[0].y},{x:Math.min(this._colList.length-1,s[1].x+o),y:s[1].y}];else if("left"==t)u=[{x:Math.max(0,s[0].x-o),y:s[0].y},{x:s[0].x-1,y:s[1].y}];else if("down"==t)u=[{x:s[0].x,y:s[1].y+1},{x:s[1].x,y:Math.min(this._rowList.length-1,s[1].y+o)}];else if("up"==t)u=[{x:s[0].x,y:Math.max(0,s[0].y-o)},{x:s[1].x,y:s[0].y-1}];var _=u[1].y-u[0].y+1,p=u[1].x-u[0].x+1,m=[];if("right"==t)for(h=0;h<_;h++){m.push([]);for(r=0;r<p;r++){var g=1+Math.floor(r/c[h].groups.length),f=r%c[h].groups.length;if(A(c[h].groups[f])){var v=f-c[h].groups[f].startIndex+c[h].groups[f].size*g,x=c[h].groups[f].base+v*c[h].groups[f].increment;x=Math.round(100*x)/100,m[h].push(x)}else m[h].push(c[h].groups[f])}}else if("left"==t)for(h=0;h<_;h++){m.push([]);for(r=0;r<p;r++){g=1+Math.floor(r/c[h].groups.length),f=r%c[h].groups.length;if(A(c[h].groups[f])){v=f-c[h].groups[f].startIndex+c[h].groups[f].size*g,x=c[h].groups[f].base+v*c[h].groups[f].increment;x=Math.round(100*x)/100,m[h].unshift(x)}else m[h].unshift(c[h].groups[f])}}else if("down"==t)for(h=0;h<_;h++){m.push([]);for(r=0;r<p;r++){g=1+Math.floor(h/c[r].groups.length),f=h%c[r].groups.length;if(A(c[r].groups[f])){v=f-c[r].groups[f].startIndex+c[r].groups[f].size*g,x=c[r].groups[f].base+v*c[r].groups[f].increment;x=Math.round(100*x)/100,m[h].push(x)}else m[h].push(c[r].groups[f])}}else if("up"==t)for(h=0;h<_;h++){m.unshift([]);for(r=0;r<p;r++){g=1+Math.floor(h/c[r].groups.length),f=h%c[r].groups.length;if(A(c[r].groups[f])){v=f-c[r].groups[f].startIndex+c[r].groups[f].size*g,x=c[r].groups[f].base+v*c[r].groups[f].increment;x=Math.round(100*x/100),m[0].push(x)}else m[0].push(c[r].groups[f])}}var y=zo.call(this,u,m,!1);if("right"==t)var N=y.rowIdsToSelect,w=n.concat(y.colIdsToSelect);else if("left"==t)N=y.rowIdsToSelect,w=y.colIdsToSelect.concat(n);else if("down"==t)N=l.concat(y.rowIdsToSelect),w=y.colIdsToSelect;else if("up"==t)N=y.rowIdsToSelect.concat(l),w=y.colIdsToSelect;Zo.call(this,y.rowIds,y.colIds,y.values,!0,(function(){var t=[{x:this._colList.indexOf(w[0]),y:this._rowList.indexOf(N[0])},{x:this._colList.indexOf(w[w.length-1]),y:this._rowList.indexOf(N[N.length-1])}];if(jt(this._cellCursorPosition,e))var o=null;else o={x:t[0].x,y:t[0].y};Uo.call(this,t,o)}))}const il=function(e){for(var t=0;t<e.length;t++)e[t].groups=o(e[t].series);function o(e){for(var t,o,s,l=[],n=null,r=0;r<e.length;r++)t=""!==(s=e[r])&&null!==s&&!isNaN(s)&&isFinite(s)&&Math.floor(s)===Number(s)?"number":"string",null==n?o=[e[r]]:t==n?o.push(e[r]):("number"==n&&o.length&&(o=i(o,r-o.length)),Array.prototype.push.apply(l,o),o=[e[r]]),n=t;return o.length&&("number"==n&&o.length&&(o=i(o,r-o.length)),Array.prototype.push.apply(l,o)),l}function i(e,t){for(var o=null,i=null,s=0;s<e.length-1;s++){if(o=e[s+1]-e[s],s>0&&o!=i){o=null;break}i=o}if(null!=o){var l={base:Number(e[0]),increment:o,startIndex:t,size:e.length},n=[];for(s=0;s<e.length;s++)n.push(l)}return n||e}};function sl(e,t="document"){var o=e;if("document"==t)var i={left:0,right:this._colList.length-1};else if("viewport"==t)i={left:this._viewportPosition.x,right:this._viewportPosition.x+(this._colView.length-1)};var s=o<i.left,l=o>i.right;return s&&(o=i.left),l&&(o=i.right),o}function ll(e,t="document"){return null==e?null:[sl.call(this,e[0],t),sl.call(this,e[1],t)]}function nl(e,t="do"){qo.call(this);for(var o=0;o<e.length;o++)this.getColFromStore(e[o]).deleted=!0,this._colList.splice(this._colList.indexOf(e[o]),1)}function rl(e,t=null){qo.call(this);for(var o=[],i=this._colStore._lastId,s=0;s<e;s++)i++,this._colStore.push({id:i,field:void 0,title:void 0,width:this.defaultColWidth,align:this.defaultColAlign,node:void 0}),o.push(i);this._colStore._lastId=i;for(var l=0;l<this._rowStore.length;l++)for(s=0;s<o.length;s++)E.call(this,this._rowStore[l].id,o[s],null);if(t)n=this._colList.indexOf(t)+1;else var n=0;this._colList.splice.apply(this._colList,[n,0].concat(o));for(s=0;s<o.length;s++)Ve.call(this,this._colList.indexOf(o[s]),o[s]);return o}function hl(e,t=null){qo.call(this);for(var o=0;o<e.length;o++)delete this.getColFromStore(e[o]).deleted;if(t)i=this._colList.indexOf(t)+1;else var i=0;this._colList.splice.apply(this._colList,[i,0].concat(e))}function cl(e=!1){if(e&&this.showColHeaders)for(var t=0;t<this._colList.length;t++){var o=this._colList[t],i=this._colStore[o-1].node.firstChild.firstChild,s=this._colStore[o-1],l=Ee.call(this,t);i.innerHTML=this.colHeaderLabelFunction.call(this,t,o,s.field,s.title,l)}ze.call(this,this._viewportPosition.x),Ie.call(this,this._viewportPosition.y),Le.call(this),ks.call(this),Ho.call(this),k(S)in this&&this[k(S)]||Ei.call(this),this.events.dispatch("documentchange",{})}function dl(e,t,o=!0,i=null){var s={colIds:e};if(this.events.dispatch("beforecoldelete",s)){var l,n=Do.call(this);if(nl.call(this,e),this._colList.length)r=null;else var r=rl.call(this,1);cl.call(this,!0),null!=i&&i.call(this),l=Do.call(this),o&&this.undoManager.add({desc:"deleteCols",undo:function(){hl.call(this,e,t),null!=r&&nl.call(this,r),cl.call(this,!0),jo.call(this,n)},redo:function(){nl.call(this,e),this._colList.length||hl.call(this,r),cl.call(this,!0),jo.call(this,l)}}),this.events.dispatch("coldelete",s)}}function al(e=null){if(null!=e){var t=Rt(e);if(0==(t=ll.call(this,t,"document"))[0])var o=0;else o=this._colList[t[0]-1];for(var i=[],s=t[0];s<=t[1];s++)i.push(this._colList[s]);dl.call(this,i,o,!0,(function(){jo.call(this,this._prevSelection)}))}}function ul(e,t,o=!0,i=null){var s={amount:e,targetId:t};if(this.events.dispatch("beforecolinsert",s)){var l,n=Do.call(this),r=rl.call(this,e,t);cl.call(this,!0),null!=i&&i.call(this,r),l=Do.call(this),o&&this.undoManager.add({desc:"insertCols",undo:function(){nl.call(this,r),cl.call(this,!0),jo.call(this,n)},redo:function(){hl.call(this,r,t),cl.call(this,!0),jo.call(this,l)}}),s.insertedIds=r,this.events.dispatch("colinsert",s)}}function _l(e){R(e)||(e=[e,e]);var t=e[0],o=e[e.length-1];return[this._colList.indexOf(t),this._colList.indexOf(o)]}function pl(e=1,t){if(void 0===t&&(t=this._colList.length),0==t)var o=0;else o=this._colList[Math.min(this._colList.length,t)-1];ul.call(this,e,o,!0,(function(e){this.selectCols(_l.call(this,e))}))}function ml(e,t=null){qo.call(this);for(var o=0;o<e.length;o++)this._colList.splice(this._colList.indexOf(e[o]),1);if(t)i=this._colList.indexOf(t)+1;else var i=0;this._colList.splice.apply(this._colList,[i,0].concat(e))}function gl(e,t,o,i=!0,s=null){var l={colIds:e,targetId:o};if(this.events.dispatch("beforecolmove",l)){var n,r=Do.call(this);ml.call(this,e,o),cl.call(this,!0),null!=s&&s.call(this),n=Do.call(this),i&&this.undoManager.add({desc:"moveCols",undo:function(){ml.call(this,e,t),cl.call(this,!0),jo.call(this,r)},redo:function(){ml.call(this,e,o),cl.call(this,!0),jo.call(this,n)}}),this.events.dispatch("colmove",l)}}function fl(e=null,t=null){if(null!=e&&null!=t){var o=Rt(e);if(o=ll.call(this,o,"document"),!(t<0||t>=o[0]&&t<=o[1]+1)){if(0==o[0])var i=0;else i=this._colList[o[0]-1];if(0==t)var s=0;else s=this._colList[Math.min(this._colList.length,t)-1];for(var l=[],n=o[0];n<=o[1];n++)l.push(this._colList[n]);gl.call(this,l,i,s,!0,(function(){this.selectCols(_l.call(this,l))}))}}}function vl(e,t){requestAnimationFrame(()=>{for(var o=0;o<e.length;o++)null!=this.getColFromStore(e[o]).node&&(this.getColFromStore(e[o]).node.style.width=t[o]+"px")})}function xl(e,t){qo.call(this);for(var o=0;o<e.length;o++)void 0!==t[o]&&(this._colStore[e[o]-1].width=Math.max(t[o],32));vl.call(this,e,t)}function yl(e,t,o=!0,i=null){var s={colIds:e,changeStore:t};if(this.events.dispatch("beforecolresize",s)){for(var l,n=Do.call(this),r=[],h=0;h<e.length;h++)r.push(this._colStore[e[h]-1].width);xl.call(this,e,t),cl.call(this),null!=i&&i.call(this),l=Do.call(this),o&&this.undoManager.add({desc:"resizeCols",undo:function(){xl.call(this,e,r),cl.call(this),jo.call(this,n)},redo:function(){xl.call(this,e,t),cl.call(this),jo.call(this,l)}}),this.events.dispatch("colresize",s)}}function Nl(e=null,t=null){if(null!=e&&null!=t){var o=Rt(e);o=ll.call(this,o,"document");for(var i=[],s=[],l=Math.max(Math.round(t),32),n=o[0];n<=o[1];n++)i.push(this._colList[n]),s.push(l);yl.call(this,i,s,this.undoableColResize)}}function wl(e=null){if(null!=e){for(var t=Rt(e),o=[],i=[],s=(t=ll.call(this,t,"document"))[0];s<=t[1];s++){o.push(this._colList[s]);for(var l=0,n=0;n<this._rowList.length;n++){var r=this.getCellFromStore(this._rowList[n],this._colList[s]);if(null!=r.value){var h=this._textWidthMeterCanvasContext.measureText(r.value).width;h>l&&(l=h)}}l+=2*this.cellPadding;var c=Math.max(Math.round(l),32);i.push(c)}yl.call(this,o,i,this.undoableColResize)}}function Cl(e){qo.call(this);for(var t=0;t<e.length;t++)this.getRowFromStore(e[t]).deleted=!0,this._rowList.splice(this._rowList.indexOf(e[t]),1)}function bl(e,t=null){qo.call(this);for(var o=[],i=this._rowStore._lastId,s=0;s<e;s++)i++,this._rowStore.push({id:i,title:void 0}),o.push(i);this._rowStore._lastId=i;for(var l=0;l<this._colStore.length;l++)for(s=0;s<o.length;s++)E.call(this,o[s],this._colStore[l].id,null);if(t)n=this._rowList.indexOf(t)+1;else var n=0;return this._rowList.splice.apply(this._rowList,[n,0].concat(o)),o}function Sl(e,t=null){qo.call(this);for(var o=0;o<e.length;o++)delete this.getRowFromStore(e[o]).deleted;if(t)i=this._rowList.indexOf(t)+1;else var i=0;this._rowList.splice.apply(this._rowList,[i,0].concat(e))}function Hl(e,t,o=!0,i=null){var s={rowIds:e};if(this.events.dispatch("beforerowdelete",s)){var l,n=Do.call(this);if(Cl.call(this,e),this._rowList.length)r=null;else var r=bl.call(this,1);cl.call(this),null!=i&&i.call(this),l=Do.call(this),o&&this.undoManager.add({desc:"deleteRows",undo:function(){Sl.call(this,e,t),null!=r&&Cl.call(this,r),cl.call(this),jo.call(this,n)},redo:function(){Cl.call(this,e),this._rowList.length||Sl.call(this,r),cl.call(this),jo.call(this,l)}}),this.events.dispatch("rowdelete",s)}}function Tl(e=null){if(null!=e){var t=Rt(e);if(0==(t=ll.call(this,t,"document"))[0])var o=0;else o=this._rowList[t[0]-1];for(var i=[],s=t[0];s<=t[1];s++)i.push(this._rowList[s]);Hl.call(this,i,o,!0,(function(){jo.call(this,this._prevSelection)}))}}function Ll(e,t,o=!0,i=null){var s={amount:e,targetId:t};if(this.events.dispatch("beforerowinsert",s)){var l,n=Do.call(this),r=bl.call(this,e,t);r&&(cl.call(this),null!=i&&i.call(this,r),l=Do.call(this),o&&this.undoManager.add({desc:"insertRows",undo:function(){Cl.call(this,r),cl.call(this),jo.call(this,n)},redo:function(){Sl.call(this,r,t),cl.call(this),jo.call(this,l)}}),s.insertedIds=r,this.events.dispatch("rowinsert",s))}}function Pl(e){var t=e[0],o=e[e.length-1];return[this._rowList.indexOf(t),this._rowList.indexOf(o)]}function kl(e=1,t){if(void 0===t&&(t=this._rowList.length),0==t)var o=0;else o=this._rowList[Math.min(this._rowList.length,t)-1];Ll.call(this,e,o,!0,(function(e){this.selectRows(Pl.call(this,e))}))}function Rl(e,t="document"){var o=e;if("document"==t)var i={top:0,bottom:this._rowList.length-1};else if("viewport"==t)i={top:this._viewportPosition.y,bottom:this._viewportPosition.y+(this._rowView.length-1)};var s=o<i.top,l=o>i.bottom;return s&&(o=i.top),l&&(o=i.bottom),o}function Ml(e,t="document"){return null==e?null:[Rl.call(this,e[0],t),Rl.call(this,e[1],t)]}function Al(e,t=null){qo.call(this);for(var o=0;o<e.length;o++)this._rowList.splice(this._rowList.indexOf(e[o]),1);if(t)i=this._rowList.indexOf(t)+1;else var i=0;this._rowList.splice.apply(this._rowList,[i,0].concat(e))}function Il(e,t,o,i=!0,s=null){var l={rowIds:e,targetId:o};if(this.events.dispatch("beforerowmove",l)){var n,r=Do.call(this);Al.call(this,e,o),cl.call(this),null!=s&&s.call(this),n=Do.call(this),i&&this.undoManager.add({desc:"moveRows",undo:function(){Al.call(this,e,t),cl.call(this),jo.call(this,r)},redo:function(){Al.call(this,e,o),cl.call(this),jo.call(this,n)}}),this.events.dispatch("rowmove",l)}}function zl(e=null,t=null){if(null!=e&&null!=t){var o=Rt(e);if(o=Ml.call(this,o,"document"),!(t<0||t>=o[0]&&t<=o[1]+1)){if(0==o[0])var i=0;else i=this._rowList[o[0]-1];if(0==t)var s=0;else s=this._rowList[Math.min(this._rowList.length,t)-1];for(var l=[],n=o[0];n<=o[1];n++)l.push(this._rowList[n]);Il.call(this,l,i,s,!0,(function(){this.selectRows(Pl.call(this,l))}))}}}function El(){if(!this._isActive){for(var e=0;e<this.constructor.instances.length;e++)this.constructor.instances[e]!=this&&this.constructor.instances[e].deactivate();this._isActive=!0,this._domNodes.componentNode.classList.add("dgxl-isActive"),this.deactivateOnClickOutside&&Yi.call(this,"document","mousedown"),null==this.getCellCursorPosition()&&this.setCellCursorPosition({x:0,y:0}),this.events.dispatch("activate",{})}}function Vl(){if(this._isActive){if(this._isActive=!1,this._domNodes.componentNode.classList.remove("dgxl-isActive"),this._activeKeyActionSet){for(var e=0;e<this._keyActionSets[this._activeKeyActionSet].length;e++){var t=this._keyActionSets[this._activeKeyActionSet][e],o=this._keyActionPresets[t];this.keys.off(o.keys,o.action,o.repeat)}this._activeKeyActionSet=void 0}this.deselectAll(),this.events.dispatch("deactivate",{})}}function Ol(){return this._cellCursorPosition}function Dl(e=null,t=!0,o=!0){if(Lo.call(this,e)&&null!=e){var i={cellCursorPosition:ko.call(this,e,"document")};t?Uo.call(this,[{x:i.cellCursorPosition.x,y:i.cellCursorPosition.y},{x:i.cellCursorPosition.x,y:i.cellCursorPosition.y}],i.cellCursorPosition,o):Uo.call(this,null,i.cellCursorPosition,o)}}function Fl(e=null){null!=e&&null!=this._cellCursorPosition&&this.setCellCursorPosition({x:this._cellCursorPosition.x+e.x,y:this._cellCursorPosition.y+e.y})}function Kl(e=null){if(null!=e&&null!=this._cellCursorPosition){var t=!1;if(Lt.call(this)){var o={x:this._cellCursorPosition.x+e.x,y:this._cellCursorPosition.y+e.y};t=!0}else{var i=this._cellCursorPosition.x+e.x,s=this._cellCursorPosition.y+e.y,l=this.getNormalizedCellSelection();i>l[1].x?(i=l[0].x,s<l[1].y?s++:s=l[0].y):i<l[0].x&&(i=l[1].x,s>l[0].y?s--:s=l[1].y),s>l[1].y?(s=l[0].y,i<l[1].x?i++:i=l[0].x):s<l[0].y&&(s=l[1].y,i>l[0].x?i--:i=l[1].x);o={x:i,y:s}}this.setCellCursorPosition(o,t)}}function Bl(){var e=this._cellCursorPosition.y-this._viewportPosition.y;e<0&&(e=0);var t=this._viewportPosition.y+(this._rowView.length-1);this.setViewportPosition({x:this._viewportPosition.x,y:t}),this.setCellCursorPosition({x:this._cellCursorPosition.x,y:t+e},!0,!1)}function Wl(){if(0!=this._viewportPosition.y){var e=this._cellCursorPosition.y-this._viewportPosition.y;e<0&&(e=0);for(var t=0,o=this._viewportPosition.y;t<this._innerViewportHeight&&-1!=o;)t+=this.rowHeight,o--;this.setViewportPosition({x:this._viewportPosition.x,y:o+1}),this.setCellCursorPosition({x:this._cellCursorPosition.x,y:o+1+e},!0,!1)}}function Gl(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:this.getCellCursorPosition().x,y:this._rowList.length-1})}function Xl(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:this.getCellCursorPosition().x,y:0})}function Yl(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:this._colList.length-1,y:this._rowList.length-1})}function Ul(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:0,y:0})}function jl(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:this._colList.length-1,y:this.getCellCursorPosition().y})}function ql(){null!=this.getCellCursorPosition()&&this.setCellCursorPosition({x:0,y:this.getCellCursorPosition().y})}function Zl(){var e=document.createElement("textArea");e.value=" all",e.setAttribute("readonly",!0),e.addEventListener("copy",this._domNodes.componentNode._listeners.clipboardNode.events.copy),document.body.appendChild(e);var t=document.createRange();t.selectNodeContents(e);var o=window.getSelection();o.removeAllRanges(),o.addRange(t),e.setSelectionRange(0,999999),document.execCommand("copy"),document.body.removeChild(e)}function Jl(){if(null!=this.getCellSelection())if(Go.call(this,!0),this._domNodes.clipboardNode._actualCommand="copy",this._isIOS)Zl.call(this);else document.execCommand("copy")}function Ql(){null!=this.getCellSelection()&&(Go.call(this,!0),this._domNodes.clipboardNode._actualCommand="cut",this._isIOS?Zl.call(this):document.execCommand("copy"))}function $l(){null!=this.getCellSelection()&&(this.enableClipboardInteraction(),"clipboard"in navigator&&"function"==typeof navigator.clipboard.readText?navigator.clipboard.readText().then(e=>{""!=e&&Qo.call(this,{text:e},null)}).catch(e=>{}):this.isIE?document.execCommand("paste"):alert("paste not available..."))}function en(e,t){var o=this._cellStore[e-1][t-1];return"parsedValue"in o?o.parsedValue:null===o.value?"":o.value}function tn(e={}){kt({},e);for(var t="",o=0;o<this._rowList.length;o++){for(var i=0;i<this._colList.length;i++)t+=en.call(this,this._rowList[o],this._colList[i]),i<this._colList.length-1&&(t+=",");t+="\n"}on.call(this,t)}const on=function(e){var t=new Blob([e],{type:"text/csv",name:"DataGridXLData.csv"});if(this._isIE)navigator.msSaveBlob(t,"DataGridXLData.csv");else{var o=K("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(t),download:"DataGridXLData.csv"});o.textContent="Click here to download",this._domNodes.componentNode.appendChild(o),o.click(),this._domNodes.componentNode.removeChild(o)}};function sn(e={}){var t=kt({useColTitles:!1,whitespace:2,includeDataField:!1},e);if(t.includeDataField)var o=(i={data:[]}).data;else{var i;o=i=[]}if(t.useColTitles)for(var s=0;s<this._rowList.length;s++){o.push({});for(var l=0;l<this._colList.length;l++){var n=this.getColFromStore(this._colList[l]).title||"COL"+l;o[s][n]=en.call(this,this._rowList[s],this._colList[l])}}else for(s=0;s<this._rowList.length;s++){o.push([]);for(l=0;l<this._colList.length;l++)o[s].push(en.call(this,this._rowList[s],this._colList[l]))}var r=JSON.stringify(i,null,t.whitespace);ln.call(this,r)}const ln=function(e){var t=new Blob([e],{type:"application/json",name:"DataGridXLData.json"});if(this._isIE)navigator.msSaveBlob(t,"DataGridXLData.json");else{var o=K("a",{class:"dgxl-downloadLink",href:URL.createObjectURL(t),download:"DataGridXLData.json"});o.textContent="Click here to download",this._domNodes.componentNode.appendChild(o),o.click(),this._domNodes.componentNode.removeChild(o)}};function nn(e){if(null==e)return[[]];for(var t=Rt(e),o=[],i=0,s=t[0].y;s<=t[1].y;s++){o.push([]);for(var l=t[0].x;l<=t[1].x;l++){var n=this._cellStore[this._rowList[s]-1][this._colList[l]-1].value;o[i].push(n)}i++}return o}function rn(e){if(null==e)return"";for(var t="",o=Rt(e),i=o[0].y;i<=o[1].y;i++){for(var s=o[0].x;s<=o[1].x;s++)t+=this._cellStore[this._rowList[i]-1][this._colList[s]-1].value||"",s<o[1].x&&(t+="\t");i<o[1].y&&(t+="\n")}return""==t&&(t+="\n"),t}function hn(e=null){if(null!=e){var t=!1;if(Lo(e)&&(e=[{x:e.x,y:e.y},{x:e.x,y:e.y}],t=!0),Po(e))return t?en.call(this,this._rowList[e[0].y],this._colList[e[0].x]):this.getCellRangeData(e)}}function cn(e=null){if(null==e)var t=this._dataFormat;var o=[];if("objectCollection"==t)for(var i=0;i<this._rowList.length;i++){for(var s={},l=0;l<this._colList.length;l++){s[(n=this._colStore[this._colList[l]-1]).field]=this._cellStore[this._rowList[i]-1][n.id-1].value}o.push(s)}else if("arrayCollection"==t)for(i=0;i<this._rowList.length;i++){for(s=[],l=0;l<this._colList.length;l++){var n=this._colStore[this._colList[l]-1];s[l]=this._cellStore[this._rowList[i]-1][n.id-1].value}o.push(s)}return o}function dn(){this._rowList=[],this._colList=[],this._rowStore=[],delete this._rowStore._lastId,this._colStore=[],delete this._colStore._lastId,this._cellStore=[]}function an(e=null,t=null){if((null!=e||null!=t)&&(I(e)||M(e))){for(dn.call(this),this.undoManager.clear(),V.call(this,e,t),ze.call(this,this._viewportPosition.x),Ie.call(this,this._viewportPosition.y),Le.call(this),ks.call(this),Oe.call(this);this._domNodes.cellValuesNode.children.length>1;)this._domNodes.cellValuesNode.removeChild(this._domNodes.cellValuesNode.lastChild);null!=this.getCellSelection()&&(this._cellSelection=[{x:0,y:0},{x:0,y:0}],this._cellCursorPosition={x:0,y:0}),Ho.call(this)}}function un(){var e=["inline","opened"];if(this._isEditorOpen){this._isEditorOpen=!1,this._domNodes.valueEditorNode.value="",this._domNodes.valueEditorNode.style.display="none",this._domNodes.valueEditorNode.blur(),Lt.call(this)?Es.call(this):Vs.call(this),Go.call(this);for(var t=0;t<e.length;t++)this._domNodes.componentNode.classList.remove("dgxl-editMode-"+e[t])}}function _n(){if("_coords"in this._domNodes.valueEditorNode){var e=this._domNodes.valueEditorNode.value,t=JSON.parse(this._domNodes.valueEditorNode._coords);this.closeEditor(),this.setCellValues(t,e,!1,!1)}}function pn(e="opened"){if(null!=this.getCellSelection()){if(-1!=["inline","opened"].indexOf(e)&&null!=this.getCellCursorPosition()&&!this._isEditorOpen){"inline"==e&&Yi.call(this,"valueEditorNode","mousedown"),this._domNodes.valueEditorNode._coords=JSON.stringify(this._cellCursorPosition),this._domNodes.valueEditorNode._mode=e;var t=Yo.call(this,this._cellCursorPosition);this.moveViewportPosition(t),this._domNodes.valueEditorNode.style.borderColor=this.getThemeSetting(e+"EditorBorderColor");var o=$t.call(this,this._cellCursorPosition,"viewport");if(this._domNodes.valueEditorNode.style.left=o.x+"px",this._domNodes.valueEditorNode.style.top=o.y+"px",this._domNodes.valueEditorNode.style.height=this.rowHeight+1+"px","opened"==e&&(this._domNodes.valueEditorNode.value=this.getCellValues(this._cellCursorPosition)),No.call(this),this._domNodes.valueEditorNode.style.display="block",this._domNodes.valueEditorNode.focus(),"opened"==e&&(this._isIE||this._isIOS||this._isMacOS)){var i=this._domNodes.valueEditorNode.value;this._domNodes.valueEditorNode.value="",this._domNodes.valueEditorNode.value=i}Wo.call(this,"edit"+P(e)),this._isEditorOpen=!0}}}function mn(e){return e in this.locale&&null!==this.locale[e]?this.locale[e]:e in this._defaultLocale&&null!==this._defaultLocale[e]?this._defaultLocale[e]:e}function gn(){this._rowSelection=null,this._colSelection=null,this._cellSelection=null,this._cellCursorPosition=null,this._isEditorOpen&&this.closeEditorAndSave(),this.showColHeaders&&Bo.call(this),requestAnimationFrame(()=>{So.call(this)});var e=this.getCellCursorPosition(),t=this.getCellSelection();this._prevSelection&&Ko(this._prevSelection.cellRange,t)||this.events.dispatch("cellselectionchange",{cellSelection:t}),this._prevSelection&&Fo(this._prevSelection.cellCursorPosition,e)||this.events.dispatch("cellcursorpositionchange",{cellCursorPosition:e}),this._prevSelection=Do.call(this)}function fn(e){null==this.getNormalizedColSelection()?null==this.getNormalizedRowSelection()?null==this.getNormalizedCellSelection()||yn.call(this,e):xn.call(this,e):vn.call(this,e)}const vn=function(e){if("up"!=e&&"down"!=e){var t,o=this.getColSelection(),i=this.getNormalizedColSelection(),s=this.getCellCursorPosition();"right"==e?s.x==i[0]?o[1]>=o[0]?(Uo.call(this,[{x:o[0],y:0},{x:o[1]+1,y:this._rowList.length-1}],null,!1,"col"),t=1):(Uo.call(this,[{x:o[0]+1,y:0},{x:o[1],y:this._rowList.length-1}],null,!1,"col"),t=0):o[1]>=o[0]?(Uo.call(this,[{x:o[0]+1,y:0},{x:o[1],y:this._rowList.length-1}],null,!1,"col"),t=0):(Uo.call(this,[{x:o[0],y:0},{x:o[1]+1,y:this._rowList.length-1}],null,!1,"col"),t=1):"left"==e&&(s.x==i[1]?o[1]>=o[0]?(Uo.call(this,[{x:o[0]-1,y:0},{x:o[1],y:this._rowList.length-1}],null,!1,"col"),t=0):(Uo.call(this,[{x:o[0],y:0},{x:o[1]-1,y:this._rowList.length-1}],null,!1,"col"),t=1):o[1]>=o[0]?(Uo.call(this,[{x:o[0],y:0},{x:o[1]-1,y:this._rowList.length-1}],null,!1,"col"),t=1):(Uo.call(this,[{x:o[0]-1,y:0},{x:o[1],y:this._rowList.length-1}],null,!1,"col"),t=0)),this.moveViewportPosition(Yo.call(this,{x:this.getColSelection()[t],y:0},"x"))}},xn=function(e){if("left"!=e&&"right"!=e){var t,o=this.getRowSelection(),i=this.getNormalizedRowSelection(),s=this.getCellCursorPosition();"down"==e?s.y==i[0]?o[1]>=o[0]?(Uo.call(this,[{x:0,y:o[0]},{x:this._colList.length-1,y:o[1]+1}],null,!1,"row"),t=1):(Uo.call(this,[{x:0,y:o[0]+1},{x:this._colList.length-1,y:o[1]}],null,!1,"row"),t=0):o[1]>=o[0]?(Uo.call(this,[{x:0,y:o[0]+1},{x:this._colList.length-1,y:o[1]}],null,!1,"row"),t=0):(Uo.call(this,[{x:0,y:o[0]},{x:this._colList.length-1,y:o[1]+1}],null,!1,"row"),t=1):"up"==e&&(s.y==i[1]?o[1]>=o[0]?(Uo.call(this,[{x:0,y:o[0]-1},{x:this._colList.length-1,y:o[1]}],null,!1,"row"),t=0):(Uo.call(this,[{x:0,y:o[0]},{x:this._colList.length-1,y:o[1]-1}],null,!1,"row"),t=1):o[1]>=o[0]?(Uo.call(this,[{x:0,y:o[0]},{x:this._colList.length-1,y:o[1]-1}],null,!1,"row"),t=1):(Uo.call(this,[{x:0,y:o[0]-1},{x:this._colList.length-1,y:o[1]}],null,!1,"row"),t=0)),this.moveViewportPosition(Yo.call(this,{x:0,y:this.getRowSelection()[t]},"y"))}},yn=function(e){var t,o,i=this.getCellSelection(),s=this.getNormalizedCellSelection(),l=this.getCellCursorPosition();"right"==e?(t="x",l.x==s[0].x?i[1].x>=i[0].x?(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x+1,y:i[1].y}],null,!1),o=1):(Uo.call(this,[{x:i[0].x+1,y:i[0].y},{x:i[1].x,y:i[1].y}],null,!1),o=0):i[1].x>=i[0].x?(Uo.call(this,[{x:i[0].x+1,y:i[0].y},{x:i[1].x,y:i[1].y}],null,!1),o=0):(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x+1,y:i[1].y}],null,!1),o=1)):"left"==e?(t="x",l.x==s[1].x?i[1].x>=i[0].x?(Uo.call(this,[{x:i[0].x-1,y:i[0].y},{x:i[1].x,y:i[1].y}],null,!1),o=0):(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x-1,y:i[1].y}],null,!1),o=1):i[1].x>=i[0].x?(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x-1,y:i[1].y}],null,!1),o=1):(Uo.call(this,[{x:i[0].x-1,y:i[0].y},{x:i[1].x,y:i[1].y}],null,!1),o=0)):"down"==e?(t="y",l.y==s[0].y?i[1].y>=i[0].y?(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x,y:i[1].y+1}],null,!1),o=1):(Uo.call(this,[{x:i[0].x,y:i[0].y+1},{x:i[1].x,y:i[1].y}],null,!1),o=0):i[1].y>=i[0].y?(Uo.call(this,[{x:i[0].x,y:i[0].y+1},{x:i[1].x,y:i[1].y}],null,!1),o=0):(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x,y:i[1].y+1}],null,!1),o=1)):"up"==e&&(t="y",l.y==s[1].y?i[1].y>=i[0].y?(Uo.call(this,[{x:i[0].x,y:i[0].y-1},{x:i[1].x,y:i[1].y}],null,!1),o=0):(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x,y:i[1].y-1}],null,!1),o=1):i[1].y>=i[0].y?(Uo.call(this,[{x:i[0].x,y:i[0].y},{x:i[1].x,y:i[1].y-1}],null,!1),o=1):(Uo.call(this,[{x:i[0].x,y:i[0].y-1},{x:i[1].x,y:i[1].y}],null,!1),o=0)),this.moveViewportPosition(Yo.call(this,this.getCellSelection()[o],t))};function Nn(){return this._cellSelection}function wn(){return Rt(this._cellSelection)}function Cn(e=!0){if(e)var t={x:this._viewportPosition.x,y:this._viewportPosition.y};else t=null;Uo.call(this,[{x:0,y:0},{x:this._colList.length-1,y:this._rowList.length-1}],t),this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close()}function bn(e=null,t=!0,o=!0){if(null!=e){if(Po(e))var i=[ko.call(this,e[0],"document"),ko.call(this,e[1],"document")];else{if(!Lo(e))return;i=[ko.call(this,e,"document"),ko.call(this,e,"document")]}var s={x:i[0].x,y:i[0].y};!t&&jt(this._cellCursorPosition,i)&&(s=null),Uo.call(this,i,s,o)}}function Sn(){return this._colSelection}function Hn(){return Rt(this._colSelection)}function Tn(e=null,t=!0,o=!0){if(null!=e){if(R(e))var i=sl.call(this,e[0],"document"),s=sl.call(this,e[1],"document");else i=sl.call(this,e,"document"),s=sl.call(this,e,"document");var l=[{x:i,y:0},{x:s,y:this._rowList.length-1}],n={x:i,y:this._viewportPosition.y};!t&&jt(this._cellCursorPosition,l)&&(n=null),Uo.call(this,l,n,o,"col")}}function Ln(){return this._rowSelection}function Pn(){return Rt(this._rowSelection)}function kn(e=null,t=!0,o=!0){if(null!=e){if(R(e))var i=Rl.call(this,e[0],"document"),s=Rl.call(this,e[1],"document");else i=Rl.call(this,e,"document"),s=Rl.call(this,e,"document");var l=[{x:0,y:i},{x:this._colList.length-1,y:s}],n={x:this._viewportPosition.x,y:i};!t&&jt(this._cellCursorPosition,l)&&(n=null),Uo.call(this,l,n,o,"row")}}function Rn(e){return void 0===this._rowStore[e-1]?null:this._rowStore[e-1]}function Mn(e){return void 0===this._colStore[e-1]?null:this._colStore[e-1]}function An(e,t){return this._cellStore[e-1]&&this._cellStore[e-1][t-1]?this._cellStore[e-1][t-1]:null}function In(e){if(A(e)){this.theme=e,this._domNodes.componentNode.style.backgroundColor=this.getThemeSetting("documentColor"),this._domNodes.valueEditorNode.style.backgroundColor=this.getThemeSetting("documentColor"),this._domNodes.fillHandleNode.style.backgroundColor=this.getThemeSetting("documentColor"),this._domNodes.colHeaderBackgroundNode.style.backgroundColor=this.getThemeSetting("colHeaderBackgroundColor"),this._domNodes.colHeaderHighlightNode.style.backgroundColor=this.getThemeSetting("colHeaderHighlightBackgroundColor"),this._domNodes.colHeaderSelectedNode.style.backgroundColor=this.getThemeSetting("colHeaderSelectedBackgroundColor");for(var t=this.getNormalizedColSelection(),o=0;o<this._colStore.length;o++)this._colStore[o].node.lastChild.style.color=this.getThemeSetting("textColor");if(this.showColHeaders)for(o=0;o<this._colStore.length;o++)null!=t&&this._colList.indexOf(this._colStore[o].id)>=t[0]&&this._colList.indexOf(this._colStore[o].id)<=t[1]?this._colStore[o].node.firstChild.firstChild.style.color=this.getThemeSetting("colHeaderSelectedTextColor"):this._colStore[o].node.firstChild.firstChild.style.color=this.getThemeSetting("colHeaderTextColor");this._domNodes.rowHeaderBackgroundNode.style.backgroundColor=this.getThemeSetting("rowHeaderBackgroundColor"),this._domNodes.rowHeaderHighlightNode.style.backgroundColor=this.getThemeSetting("rowHeaderHighlightBackgroundColor"),this._domNodes.rowHeaderSelectedNode.style.backgroundColor=this.getThemeSetting("rowHeaderSelectedBackgroundColor"),this.showRowHeaders&&(this._domNodes.cellValuesNode.children[0].lastChild.style.color=this.getThemeSetting("rowHeaderTextColor"));var i=this._domNodes.componentNode.getElementsByClassName("dgxl-selectedRowRange");i.length&&(i[0].style.color=this.getThemeSetting("rowHeaderSelectedTextColor")),this._domNodes.valueEditorNode.style.color=this.getThemeSetting("textColor"),this._domNodes.blankSheetRightNode.style.backgroundColor=this.getThemeSetting("sheetColor"),this._domNodes.blankSheetBottomNode.style.backgroundColor=this.getThemeSetting("sheetColor"),this._domNodes.gridLinesNode.style.opacity=this.getThemeSetting("gridLineOpacity");for(o=0;o<this._colLines.length;o++)0==o&&(this._colLines[o].node.previousSibling.style.borderColor=this.getThemeSetting("gridLineHeaderColor")),this._colLines[o].node.style.borderColor=this.getThemeSetting("gridLineColor"),this._colLines[o].node.firstChild.style.borderColor=this.getThemeSetting("gridLineHeaderColor");var s=this._domNodes.componentNode.getElementsByClassName("dgxl-rowLine");for(o=0;o<s.length;o++)0==o?s[o].style.borderColor=this.getThemeSetting("gridLineHeaderColor"):(s[o].style.borderColor=this.getThemeSetting("gridLineColor"),s[o].firstChild.style.borderColor=this.getThemeSetting("gridLineHeaderColor"));if(this._domNodes.cellSelectionBorderNode.style.borderColor=this.getThemeSetting("cellSelectionBorderColor"),this._domNodes.cellSelectionNode.style.backgroundColor=this.getThemeSetting("cellSelectionBackgroundColor"),this._domNodes.cellCursorNode.style.borderColor=this.getThemeSetting("cellCursorColor"),this._domNodes.fillHandleInnerNode.style.backgroundColor=this.getThemeSetting("fillHandleColor"),this._domNodes.copyRangeNode.style.borderColor=this.getThemeSetting("copyRangeBorderColor"),this._domNodes.cutRangeNode.style.borderColor=this.getThemeSetting("cutRangeBorderColor"),this._domNodes.fillRangeNode.style.borderColor=this.getThemeSetting("fillRangeBorderColor"),this._domNodes.valueEditorNode._mode&&(this._domNodes.valueEditorNode.style.borderColor=this.getThemeSetting(this._domNodes.valueEditorNode._mode+"EditorBorderColor")),this.constructor.contextMenu.isOpen()){this.constructor.contextMenu._domNodes.containerNode.firstChild.style.backgroundColor=this.getThemeSetting("contextMenuBackgroundColor"),this.constructor.contextMenu._domNodes.containerNode.firstChild.style.color=this.getThemeSetting("contextMenuTextColor");this.constructor.contextMenu._domNodes.containerNode.getElementsByClassName("dgxl-contextMenuItem-highlight");highlightedItems.length&&(highlightedItems[0].style.backgroundColor=this.getThemeSetting("contextMenuItemHighLightBackgroundColor"))}this._domNodes.colMoveGuideNode.style.backgroundColor=this.getThemeSetting("colMoveGuideColor"),this._domNodes.rowMoveGuideNode.style.backgroundColor=this.getThemeSetting("rowMoveGuideColor"),this._domNodes.colMoveGhostNode.style.backgroundColor=this.getThemeSetting("colMoveGhostColor"),this._domNodes.rowMoveGhostNode.style.backgroundColor=this.getThemeSetting("rowMoveGhostColor"),this._domNodes.colResizeHintNode.style.backgroundColor=this.getThemeSetting("colResizeGuideHandleColor"),this._domNodes.colResizeGuideNode.style.borderColor=this.getThemeSetting("colResizeGuideLineColor"),this._domNodes.colResizeGuideNode.firstChild.style.backgroundColor=this.getThemeSetting("colResizeGuideHandleColor"),this._domNodes.horizontalScrollbarNode.style.backgroundColor=this.getThemeSetting("scrollbarBackgroundColor"),this._domNodes.verticalScrollbarNode.style.backgroundColor=this.getThemeSetting("scrollbarBackgroundColor")}}function zn(e){return this.theme[e]||this._defaultTheme[e]}function En(){this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close(),this.undoManager.hasUndo()&&this.undoManager.undo()}function Vn(){this.constructor.contextMenu.isOpen()&&this.constructor.contextMenu.close(),this.undoManager.hasRedo()&&this.undoManager.redo()}function On(){return G(this._viewportPosition)}function Dn(e){null!=this._viewportPosition&&(0==e.x&&0==e.y||this.setViewportPosition({x:this._viewportPosition.x+e.x,y:this._viewportPosition.y+e.y}))}function Fn(){this._isIOS||(this._domNodes.clipboardNode.focus(),this._domNodes.clipboardNode.setSelectionRange(0,1),this._domNodes.clipboardNode.removeAttribute("readonly"),F(this._domNodes.clipboardNode,{"user-select":"auto"}))}function Kn(){this._isIOS||F(this._domNodes.clipboardNode,{"user-select":"none"})}function Bn(e,t){for(var o=[],i=[],s=0;s<this._rowList.length;s++){for(var l=[],n=0;n<1;n++)l.push(this._cellStore[this._rowList[s]-1][e[n]-1].value);o.push({values:l,id:this._rowList[s]})}for(n=0;n<1;n++)i.push(t[n]);var r="";for(n=0;n<1;n++)"asc"==i[n]?(r+="if(a.values["+n+"] < b.values["+n+"]) return 1;\n",r+="if(a.values["+n+"] > b.values["+n+"]) return -1;\n"):"desc"==i[n]&&(r+="if(a.values["+n+"] < b.values["+n+"]) return -1;\n",r+="if(a.values["+n+"] > b.values["+n+"]) return 1;\n");r+="return 0;";var h=new Function("a,b",r);o.sort(h);var c=[];for(n=0;n<o.length;n++)c.push(o[n].id);this._rowList=c}function Wn(e,t,o=!0,i=null){var s,l=Do.call(this),n=this._rowList.slice();Bn.call(this,e,t),cl.call(this),null!=i&&i.call(this),s=Do.call(this),o&&this.undoManager.add({desc:"Sort Data",undo:function(){Bn.call(this,colId,n),cl.call(this),jo.call(this,l)},redo:function(){Bn.call(this,colId,t),cl.call(this),jo.call(this,s)}})}function Gn(e=null,t=null){var o=["asc","desc"];if(null!==e){var i=this._colList[e],s="asc";null===t?null!=this._sortState&&1==this._sortState.length&&this._sortState[0].colId==i&&(s=o[+!o.indexOf(this._sortState[0].direction)]):"asc"!=t.toLowerCase()&&!t||"desc"==t.toLowerCase()?"desc"==t.toLowerCase()&&(s=o[1]):s=o[0];var l=[i],n=[s];Wn.call(this,l,n,!0,(function(){}))}}class DataGridXL{constructor(i=null,s={}){this._isIE=u(),this._isMacOS=t(),this._isIOS=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,this._isTouchDevice=window.matchMedia("(pointer: coarse)").matches,this._isImageRenderingSupported=!u(),this._nativeScrollbarWidth,this._nativeScrollbarHeight,this._actualRowHeight,this._containerWidth,this._containerHeight,this._componentWidth,this._componentHeight,this._wholeDocumentWidth,this._wholeDocumentHeight,this._outerDocumentWidth,this._outerDocumentHeight,this._innerDocumentWidth,this._innerDocumentHeight,this._wholeViewportWidth,this._wholeViewportHeight,this._outerViewportWidth,this._outerViewportHeight,this._innerViewportWidth,this._innerViewportHeight,this._hoverArea,this._currentDragAction,this._copyRange=null,this._cutRange=null,this._fillRange=null,this._scrollLeft=0,this._scrollTop=0,this._viewportPosition={x:0,y:0},this._prevSelection,this._cellCursorPosition=null,this._cellSelection=null,this._colSelection=null,this._rowSelection=null,this._rowStore=[],this._colStore=[],this._cellStore=[],this._rowList=[],this._colList=[],this._sortState=null,this._rowView=[],this._colView=[],this._rowViewOverflow=0,this._colViewOverflow=0,this._domNodes={},this._contextMenuItemPresets=_,this._contextMenuTouchItemPresets=p,this._keyActionPresets=f,this._keyActionSets=v,this._headerLabelSeriesPresets=x,this._headerLabelSeries=y,this._defaultTheme=C,this._defaultLocale=b,this._editorFontFamily="sans-serif",this._editorFontSize=14,this._isActive=!1,this._isEditorOpen=!1,this._activeKeyActionSet=void 0,this.events=new e(this),this.keys=new o(this),this.undoManager=new c(this),this.allowCellEdit=!0,this.allowCellFill=!0,this.cellFillDirection="xy",this.allowCopy=!0,this.allowCut=!0,this.allowPaste=!0,this.delayedCut=!0,this.allowColDelete=!0,this.allowColInsert=!0,this.allowColMove=!0,this.allowColResize=!0,this.undoableColResize=!1,this.allowRowDelete=!0,this.allowRowInsert=!0,this.allowRowMove=!0,this.deactivateOnClickOutside=!0,this.instantActivate=!1,this.colHeaderHeight=38,this.colHeaderLabelFunction=N,this.colHeaderLabelPrefix="",this.colHeaderLabelSuffix="",this.colHeaderLabelType="letters",this.defaultColAlign="left",this.defaultColHeaderLabelAlign="left",this.defaultColWidth=112,this.showColHeaders=!0,this.rowHeaderLabelAlign="center",this.rowHeaderLabelFunction=w,this.rowHeaderLabelPrefix="",this.rowHeaderLabelSuffix="",this.rowHeaderLabelType="numbers",this.rowHeaderWidth=56,this.rowHeight=30,this.showRowHeaders=!0,this.contextMenuItems=m,this.contextMenuTouchItems=g,this.locale={},this.theme={},this.cellPadding=8,this.includeOuterBorder=!0,this.boldSelectedHeaders=!1,this.showRowZebraStripes=!1,Zs.call(this,i,s)}_clearCellColors(e){Js.call(this,e)}_setCellColors(e,t,o,i){el.call(this,e,t,o,i)}clearCellValues(e){tl.call(this,e)}setCellValues(e,t,o,i){Jo.call(this,e,t,o,i)}copy(){Jl.call(this)}cut(){Ql.call(this)}paste(){$l.call(this)}deleteCols(e){al.call(this,e)}insertCols(e,t){pl.call(this,e,t)}moveCols(e,t){fl.call(this,e,t)}resizeCols(e,t){Nl.call(this,e,t)}resizeColsToFit(e){wl.call(this,e)}deleteRows(e){Tl.call(this,e)}insertRows(e,t){kl.call(this,e,t)}moveRows(e,t){zl.call(this,e,t)}activate(){El.call(this)}deactivate(){Vl.call(this)}downloadDataAsCSV(e={}){tn.call(this,e)}downloadDataAsJSON(e={}){sn.call(this,e)}getCellRangeData(e){return nn.call(this,e)}getCellRangeText(e){return rn.call(this,e)}getCellValues(e){return hn.call(this,e)}getData(){return cn.call(this)}setData(e,t){an.call(this,e,t)}closeEditor(){un.call(this)}closeEditorAndSave(){_n.call(this)}openEditor(e){pn.call(this,e)}getLocaleSetting(e){return mn.call(this,e)}deselectAll(){gn.call(this)}modifySelection(e){fn.call(this,e)}getCellCursorPosition(){return Ol.call(this)}setCellCursorPosition(e,t,o){Dl.call(this,e,t,o)}moveCellCursor(e){Fl.call(this,e)}moveCellCursorInside(e){Kl.call(this,e)}moveCellCursorOneViewportDown(){Bl.call(this)}moveCellCursorOneViewportUp(){Wl.call(this)}moveCellCursorToColEnd(){Gl.call(this)}moveCellCursorToColStart(){Xl.call(this)}moveCellCursorToDocumentEnd(){Yl.call(this)}moveCellCursorToDocumentStart(){Ul.call(this)}moveCellCursorToRowEnd(){jl.call(this)}moveCellCursorToRowStart(){ql.call(this)}getCellSelection(){return Nn.call(this)}getNormalizedCellSelection(){return wn.call(this)}selectAll(e){Cn.call(this,e)}selectCells(e,t,o){bn.call(this,e,t,o)}getColSelection(){return Sn.call(this)}getNormalizedColSelection(){return Hn.call(this)}selectCols(e,t,o){Tn.call(this,e,t,o)}getNormalizedRowSelection(){return Pn.call(this)}getRowSelection(){return Ln.call(this)}selectRows(e,t,o){kn.call(this,e,t,o)}getCellFromStore(e,t){return An.call(this,e,t)}getColFromStore(e){return Mn.call(this,e)}getRowFromStore(e){return Rn.call(this,e)}getThemeSetting(e){return zn.call(this,e)}setTheme(e){In.call(this,e)}redo(){Vn.call(this)}undo(){En.call(this)}getViewportPosition(){return On.call(this)}setViewportPosition(e){Ai.call(this,e)}moveViewportPosition(e){Dn.call(this,e)}fillCells(e,t,o){ol.call(this,e,t,o)}enableClipboardInteraction(){Fn.call(this)}disableClipboardInteraction(){Kn.call(this)}_sort(e,t){Gn.call(this,e,t)}}DataGridXL.instances=[],DataGridXL._domNodes={},DataGridXL._clipboardObject=null,DataGridXL.createEmptyData=function(e,t){for(var o=[],i=0;i<e;i++){o.push([]);for(var s=0;s<t;s++)o[i].push(null)}return o},DataGridXL.createDummyData=function(e,t){for(var o=[],i=0;i<e;i++){o.push([]);for(var s=0;s<t;s++)o[i].push(i+1+";"+(s+1))}return o},DataGridXL.areCoordsEqual=Fo;export default DataGridXL;
